fileVersion: 1
id: "286"
isDisabled: true
metadata:
  defaultStorageLocation: STAGE
  error: null
  nodeMetadataSpec: |-
    capitalized: Copy of Copy of Functions
    short: V
    plural: Stages
    tagColor: '#2EB67D'

    joinTemplate: |
      {% for dep in sources[0].dependencies %}
        {%- if loop.first %} FROM 
        {%- else %} JOIN 
        {%- endif %}
        {{ ref_raw(dep.node.location.name,dep.node.name) }} "{{ dep.node.name }}"
        {%- if not loop.first %}
          {%- for pkey in parameters.pkeys if pkey.table == dep.node.name %}
            {% for k in pkey.pkey %}
              {%- if loop.first %} ON {%- else %} AND {%- endif %}
              {{ pkey.table }}.{{ k }} = 
              {%- for dep1 in sources[0].dependencies if dep1.node.name !=  pkey.table %}
                {%- for col in dep1.columns if col.name == k %}
                  {{ dep1.node.name }}.{{ col.name }}
                {%- endfor %}
              {%- endfor %}
            {% endfor %}
          {%- endfor %}
        {%- endif %}
      {% endfor %}

    config:
    - groupName: Options

      items:
      - type: materializationSelector
        default: view
        options:
        - view
        isRequired: true
        enableIf: "false"

      - type: toggleButton
        displayName: Edit Join Clause
        attributeName: toggleWhere 
        default: false
name: SQL Join
type: NodeType
