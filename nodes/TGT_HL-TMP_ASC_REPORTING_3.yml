steps:
  TMP_ASC_REPORTING_3-57f0b840-7404-4c91-945b-40c0032b5583:
    operation:
      config:
        insertStrategy: UNION
        selectDistinct: false
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: TGT_HL
      materializationType: view
      metadata:
        appliedNodeTests: []
        columns:
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 31a9235b-5250-4bd7-a0bd-1c88aa077bf4
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: CONTACT_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: b7a2a482-ac55-408f-9298-73bf9863f3cf
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: LOGIN_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: fb540629-37f5-40bb-a953-c45d3c9a27ec
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: FULL_NAME
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 44d88b39-43bc-4cfc-8792-ec318675a8ca
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: LINE_OF_BUSINESS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: fae6d05a-769a-4553-b05f-b04ce0386cbb
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: TITLE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 7a41ba1c-3f67-448d-a218-339c16601fdb
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: OFFICE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 3a4b40be-885f-4864-bc00-ca08a5f69686
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: INDUSTRY_UMBRELLA_REPORTING
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: f5bda845-336e-4bd2-b082-dc741f198087
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: CF_STAFF_INDUSTRY
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 00f44e71-f416-4a4a-a802-dd17a074b45b
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: OPPORTUNITY_NUMBER
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 8d6b761a-d465-437b-98fc-fc58d0316dac
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: OPP_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 49cbd5b5-bfbb-4578-a57e-a826cb5e053f
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: OPP_NAME
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: ce03bbbe-0145-4bc7-b141-42fe593bbc2d
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: OPP_LINE_OF_BUSINESS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: cd529e83-c4ef-4606-899d-af72d21e4593
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: OPP_CLIENT_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 004ad455-876b-4f7c-8be7-198517991bc8
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: OPP_CLIENT_NAME
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 1e86f95e-2c03-4f37-b830-a00f8c736330
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: OPP_SUBJECT_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 846db2f2-3f6b-4c2f-8f5f-1a4e4d6ad156
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: OPP_SUBJECT_NAME
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: aea4bbc2-4dcf-4232-820b-44a8561002fc
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: OPP_CF_JOB_TYPE2
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: b529f5d5-a7f5-43d8-8a4c-6705d67b27d6
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: OPP_JOB_TYPE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: a9c4f43d-e3ab-49ac-b602-d61e85717350
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: OPP_STATUS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 1edafd61-1129-4f5b-a329-b4c924154512
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: OPP_ENGAGEMENT_NUMBER
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: e79983b3-d4f2-4ea5-bad5-9b334eab763b
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: OPP_STAGE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 87ecb93a-eb9a-4b40-902f-626bd747d64d
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: TIMESTAMP_TZ(9)
            defaultValue: ""
            description: ""
            name: OPP_CREATE_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 6b985203-13bd-406b-9489-601f0bb28931
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: BOOLEAN
            defaultValue: ""
            description: ""
            name: OPP_NBC_APPROVED
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 16f5cd23-42a4-45a7-8a6a-fa9473896538
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: DATE
            defaultValue: ""
            description: ""
            name: OPP_NBC_DATE_SUBMITTED
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 1bba04cf-a1b4-4410-9761-8c1daf399c4e
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: DATE
            defaultValue: ""
            description: ""
            name: OPP_NBC_DATE_APPROVED
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: c3c42463-71ee-4c25-9585-41597b5d1b41
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: DATE
            defaultValue: ""
            description: ""
            name: OPP_PITCH_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 36fa639f-2737-4de6-848d-238e04dacda9
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: OPP_CURRENCY
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 5729fdee-f6b8-4342-bd34-9d68d9913581
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: FLOAT
            defaultValue: ""
            description: ""
            name: OPP_MAX_FEE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 3446dc4e-c869-41c6-bb4b-c5ae5c968ec4
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: FLOAT
            defaultValue: ""
            description: ""
            name: OPP_MIN_FEE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 3bede926-97c3-4fc0-aa2d-6854589141ec
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: FLOAT
            defaultValue: ""
            description: ""
            name: OPP_TOTAL_FEE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 2d74f21a-26c5-4d40-9da4-09043f13945a
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: DATE
            defaultValue: ""
            description: ""
            name: OPP_ESTIMATED_CLOSE_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: ea609879-c030-4bd7-bafe-d4bd85d42e38
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: OPP_STAFF_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 7522ebfe-0dfc-457a-8760-12f75080ae9d
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: OPP_STAFF_NAME
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: e5ff372e-6cef-4803-935e-99e0e0062837
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: OPP_STAFF_ROLE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 5d246ceb-8eb5-4d5c-9000-d446dd5f2c22
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: OPP_COVERAGE_OFFICER_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: acd73370-0114-415b-b1af-ddabef1061ff
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: OPP_COVERAGE_OFFICER_NAME
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 804e1339-99c2-43b8-819b-36f64c8299ab
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: OPP_COMPANY_TIER
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 4338263f-abc4-4953-9d72-a78cc3d6b789
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(19)
            defaultValue: ""
            description: ""
            name: OPP_FLAG
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 3bbc5217-4bd9-4806-949e-c523a6564708
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: OPP_CLIENT
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: ad971534-dbe4-4384-bd3a-c1480310f060
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(45)
            defaultValue: ""
            description: ""
            name: SF_URL
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 1fe6c074-7349-47c1-9472-d06e976bc0e1
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: DATE
            defaultValue: ""
            description: ""
            name: PROCESS_START_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 675413ae-09e0-4efb-ad5d-a9d6fe7679c4
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: DATE
            defaultValue: ""
            description: ""
            name: PROCESS_END_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: b7f64fe4-78ec-4d16-856d-d95dd88f6510
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: DND_STATUS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 56187e9b-4135-4a5a-86ba-c3b7b19077de
              stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
            config: {}
            dataType: VARCHAR(1)
            defaultValue: ""
            description: ""
            name: FIG_FLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - customSQL:
              customSQL: |-
                {{ stage('Override Create SQL') }}
                	CREATE OR REPLACE VIEW {{ ref('TGT_HL', 'TMP_ASC_REPORTING_3')}} AS (
                SELECT 
                    COVERAGE_DATASOURCE.CONTACT_ID
                    ,COVERAGE_DATASOURCE.LOGIN_ID
                    ,COVERAGE_DATASOURCE.FULL_NAME
                    ,COVERAGE_DATASOURCE.LINE_OF_BUSINESS
                    ,COVERAGE_DATASOURCE.TITLE
                    ,COVERAGE_DATASOURCE.OFFICE
                    ,COVERAGE_DATASOURCE.INDUSTRY_UMBRELLA_REPORTING
                    ,COVERAGE_DATASOURCE.CF_STAFF_INDUSTRY
                    ,OPPORTUNITY.Opportunity_NUMBER
                    ,OPPORTUNITY.OPP_ID
                    ,OPPORTUNITY.OPP_NAME
                    ,OPPORTUNITY.OPP_LINE_OF_BUSINESS
                    ,OPPORTUNITY.OPP_Client_ID
                    ,OPPORTUNITY.OPP_Client_Name
                    ,OPPORTUNITY.OPP_Subject_ID
                    ,OPPORTUNITY.OPP_Subject_Name
                    ,OPPORTUNITY.OPP_CF_Job_Type2
                    ,OPPORTUNITY.OPP_JOB_TYPE
                    ,OPPORTUNITY.OPP_STATUS
                    ,OPPORTUNITY.OPP_ENGAGEMENT_NUMBER
                    ,OPPORTUNITY.OPP_STAGE
                    ,OPPORTUNITY.OPP_Create_Date
                    ,COALESCE(OPPORTUNITY.OPP_NBC_Approved, NULL) AS OPP_NBC_Approved
                    ,OPPORTUNITY.OPP_NBC_Date_Submitted
                    ,OPPORTUNITY.OPP_NBC_Date_Approved
                    ,OPPORTUNITY.OPP_Pitch_Date
                    ,OPPORTUNITY.OPP_Currency
                    ,OPPORTUNITY.OPP_Max_Fee
                    ,OPPORTUNITY.OPP_Min_Fee
                    ,OPPORTUNITY.OPP_Total_Fee
                    ,OPPORTUNITY.OPP_Estimated_Close_Date
                    ,OPPORTUNITY.OPP_Staff_ID
                    ,OPPORTUNITY.OPP_Staff_Name
                    ,OPPORTUNITY.OPP_Staff_Role
                    ,OPPORTUNITY.OPP_Coverage_Officer_ID
                    ,OPPORTUNITY.OPP_Coverage_Officer_Name
                    ,OPPORTUNITY.OPP_Company_TIER
                    ,OPPORTUNITY.OPP_Flag
                    ,CASE 
                        WHEN OPP_Client_Name = OPP_Subject_Name
                            THEN OPP_Client_Name
                        ELSE CONCAT (
                                OPP_Client_Name
                                ,' ('
                                ,OPP_Subject_Name
                                ,' )'
                                )
                        END AS OPP_CLIENT
                        ,CASE   WHEN UPPER(current_account()) = UPPER('bb13604') THEN 'https://hl--dev.sandbox.lightning.force.com/' 
                                WHEN UPPER(current_account()) = UPPER('ef55528') THEN 'https://hl--test.sandbox.lightning.force.com/' 
                                WHEN UPPER(current_account()) = UPPER('gi01295') THEN 'https://hl.lightning.force.com/' 
                                ELSE 'https://hl.lightning.force.com/'
                        END AS SF_URL
                    ,CURRENT_DATE AS PROCESS_START_DATE
                    ,CURRENT_DATE AS PROCESS_END_DATE
                    ,DND_STATUS
                    ,CASE 
                        WHEN (
                                UPPER(COVERAGE_DATASOURCE.CF_STAFF_INDUSTRY) = 'FIG'
                                AND UPPER(COVERAGE_DATASOURCE.COMPANY_RECORDTYPE) IN (
                                    UPPER('Capital Provider')
                                    ,UPPER('Operating Company')
                                    )
                                )
                            OR (
                                UPPER(COVERAGE_DATASOURCE.CF_STAFF_INDUSTRY) <> 'FIG'
                                AND UPPER(COVERAGE_DATASOURCE.COMPANY_RECORDTYPE) = UPPER('Operating Company')
                                )
                            THEN 'Y'
                        ELSE 'N'
                        END FIG_FLAG
                    FROM (
                    SELECT DISTINCT CONTACT_ID
                        ,LOGIN_ID
                        ,FULL_NAME
                        ,LINE_OF_BUSINESS
                        ,TITLE
                        ,OFFICE
                        ,INDUSTRY_UMBRELLA_REPORTING
                        ,CF_STAFF_INDUSTRY
                        ,COMPANY_RECORDTYPE
                    FROM  {{ ref('TGT_HL', 'TMP_COVERAGE_DATASOURCE')}}
                    ) COVERAGE_DATASOURCE
                    INNER JOIN  {{ ref('TGT_HL', 'TMP_OPPORTUNITY')}} OPPORTUNITY ON COVERAGE_DATASOURCE.CONTACT_ID = OPPORTUNITY.OPP_Staff_ID -- Join by ID
                    AND UPPER(OPPORTUNITY.OPP_Company_TIER) = UPPER('Not Covered')
                    
                	)
            dependencies: []
            join:
              joinCondition: ""
            name: TMP_ASC_REPORTING_3
            noLinkRefs: []
      name: TMP_ASC_REPORTING_3
      overrideSQL: true
      schema: ""
      sqlType: "154"
      type: sql
    stepCounter: 57f0b840-7404-4c91-945b-40c0032b5583
