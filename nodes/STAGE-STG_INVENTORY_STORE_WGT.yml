steps:
  STG_INVENTORY_STORE_WGT-f9d479c5-bb55-48fc-a88d-79f914230095:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        selectDistinct: false
        testsEnabled: true
        truncateBefore: true
      database: ""
      dependencies: []
      deployEnabled: true
      description: ""
      isMultisource: true
      locationName: STAGE
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: d79a2a9f-2883-41bb-82fd-5cd0d0802a1d
              stepCounter: f9d479c5-bb55-48fc-a88d-79f914230095
            dataType: DATE
            description: ""
            name: DATA_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5e979b3e-987e-427f-ab26-1742555812da
                    stepCounter: b23c15b6-de95-401e-8f13-8840e97f6a23
                transform: ""
              - columnReferences:
                  - columnCounter: ac09af91-ed4c-4ca7-8c7d-15299ab4eeaa
                    stepCounter: c02462d8-5dde-4487-904e-fe7f163c7ad8
                transform: ""
          - columnReference:
              columnCounter: d5f1aaa8-22f4-4783-8e13-f1bb1346eba9
              stepCounter: f9d479c5-bb55-48fc-a88d-79f914230095
            dataType: VARCHAR(64)
            defaultValue: ""
            description: This is the product key
            isBusinessKey: true
            name: PRODKEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2c9dc352-c7d3-4385-b533-1ff8fc436690
                    stepCounter: b23c15b6-de95-401e-8f13-8840e97f6a23
                transform: ""
              - columnReferences:
                  - columnCounter: c8b84f45-0ab0-4a71-b207-246b085051e5
                    stepCounter: c02462d8-5dde-4487-904e-fe7f163c7ad8
                transform: ""
          - columnReference:
              columnCounter: 0115dd73-111d-4303-8635-65d295674b23
              stepCounter: f9d479c5-bb55-48fc-a88d-79f914230095
            dataType: VARCHAR(64)
            defaultValue: ""
            description: ""
            name: ZONE_GEOGRAPHY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 135eaa10-3b5e-45df-8476-0303b561bc33
                    stepCounter: b23c15b6-de95-401e-8f13-8840e97f6a23
                transform: ""
              - columnReferences:
                  - columnCounter: eb45f471-59e6-429c-9930-1a7306e38fc5
                    stepCounter: c02462d8-5dde-4487-904e-fe7f163c7ad8
                transform: ""
          - columnReference:
              columnCounter: 29e8b18f-6b6c-433a-ba26-78d078ae0d64
              stepCounter: f9d479c5-bb55-48fc-a88d-79f914230095
            dataType: VARCHAR(64)
            defaultValue: ""
            description: ""
            name: ZONE_DELIVERY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2556b716-76a0-494b-b1d9-4a0f4920da5f
                    stepCounter: b23c15b6-de95-401e-8f13-8840e97f6a23
                transform: ""
              - columnReferences:
                  - columnCounter: 811d8dee-1b8f-455e-82a0-15d020331256
                    stepCounter: c02462d8-5dde-4487-904e-fe7f163c7ad8
                transform: ""
          - columnReference:
              columnCounter: d0e9277a-a552-4a35-b7cd-a41663ce832a
              stepCounter: f9d479c5-bb55-48fc-a88d-79f914230095
            dataType: VARCHAR(64)
            defaultValue: ""
            description: ""
            isBusinessKey: true
            name: STORE_CODE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5e5439cc-3693-4522-8a6f-a406e76938e9
                    stepCounter: b23c15b6-de95-401e-8f13-8840e97f6a23
                transform: ""
              - columnReferences:
                  - columnCounter: e7e0b62f-f141-4ed1-b09f-32d8897ddd60
                    stepCounter: c02462d8-5dde-4487-904e-fe7f163c7ad8
                transform: ""
          - columnReference:
              columnCounter: 61ced4de-4ebb-409c-ad7f-72988355195c
              stepCounter: f9d479c5-bb55-48fc-a88d-79f914230095
            dataType: DECIMAL(12,4)
            description: ""
            name: STORE_WGT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: bc670ff3-286d-4d3f-8ff7-603e661a7dc5
                    stepCounter: 6c152345-7089-4a3e-a1fb-f86646dfb4df
                transform: ""
              - columnReferences:
                  - columnCounter: bc670ff3-286d-4d3f-8ff7-603e661a7dc5
                    stepCounter: 6c152345-7089-4a3e-a1fb-f86646dfb4df
                transform: ""
          - columnReference:
              columnCounter: 1892a251-44a2-4fdd-9764-2b101c3acf67
              stepCounter: f9d479c5-bb55-48fc-a88d-79f914230095
            dataType: NUMBER(13,2)
            description: ""
            name: INVENTORY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: dd09e647-a0bb-429c-863a-8c17bb5c0984
                    stepCounter: b23c15b6-de95-401e-8f13-8840e97f6a23
                transform: ""
              - columnReferences:
                  - columnCounter: 1cd2b9c3-586b-4334-83a6-11cebdf1ab1b
                    stepCounter: c02462d8-5dde-4487-904e-fe7f163c7ad8
                transform: ""
          - columnReference:
              columnCounter: 2f12f685-ea61-416a-a3e2-84703e0707c2
              stepCounter: f9d479c5-bb55-48fc-a88d-79f914230095
            dataType: INTEGER
            defaultValue: ""
            description: ""
            name: INVENTORY_FLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: dd09e647-a0bb-429c-863a-8c17bb5c0984
                    stepCounter: b23c15b6-de95-401e-8f13-8840e97f6a23
                transform: CASE WHEN INVENTORY > 0 THEN 1 ELSE 0 END
              - columnReferences:
                  - columnCounter: 4abc44e0-5260-42d1-b1e2-c38b93ffa544
                    stepCounter: c02462d8-5dde-4487-904e-fe7f163c7ad8
                transform: CASE WHEN INVENTORY > 0 THEN 1 ELSE 0 END
          - columnReference:
              columnCounter: 79da44b3-49b7-4724-b57a-0a941441cdc4
              stepCounter: f9d479c5-bb55-48fc-a88d-79f914230095
            dataType: DECIMAL(12,6)
            defaultValue: ""
            description: ""
            name: INVENTORY_WGT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: dd09e647-a0bb-429c-863a-8c17bb5c0984
                    stepCounter: b23c15b6-de95-401e-8f13-8840e97f6a23
                transform: CASE WHEN INVENTORY > 0 THEN 1 ELSE 0 END * "STG_STORE_WGT"."STORE_WGT"
              - columnReferences: []
                transform: CASE WHEN INVENTORY > 0 THEN 1 ELSE 0 END * "STG_STORE_WGT"."STORE_WGT"
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              STG_STORE_WGT: 6c152345-7089-4a3e-a1fb-f86646dfb4df
              VW_INVENTORY_STORE: b23c15b6-de95-401e-8f13-8840e97f6a23
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: STAGE
                nodeName: STG_STORE_WGT
              - locationName: STAGE
                nodeName: VW_INVENTORY_STORE
            join:
              joinCondition: |
                FROM {{ ref('STAGE', 'VW_INVENTORY_STORE') }} "VW_INVENTORY_STORE"
                INNER JOIN {{ ref('STAGE', 'STG_STORE_WGT') }} "STG_STORE_WGT"
                ON "VW_INVENTORY_STORE"."PRODKEY" = "STG_STORE_WGT"."PRODKEY"
                AND "VW_INVENTORY_STORE"."STORE_CODE" = "STG_STORE_WGT"."STORE_CODE"
                WHERE "VW_INVENTORY_STORE"."UPDATED_DATE" > 
                    (SELECT NVL(MAX(TRANSACTION_DATE),'2000-01-01') FROM {{ ref_no_link('DATASTORE','DS_INVENTORY_WGT')}})
            name: STORES
            noLinkRefs:
              - locationName: DATASTORE
                nodeName: DS_INVENTORY_WGT
          - aliases:
              STG_STORE_WGT: 6c152345-7089-4a3e-a1fb-f86646dfb4df
              VW_INVENTORY_DC: c02462d8-5dde-4487-904e-fe7f163c7ad8
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: STAGE
                nodeName: STG_STORE_WGT
              - locationName: STAGE
                nodeName: VW_INVENTORY_DC
            join:
              joinCondition: |
                FROM {{ ref('STAGE', 'VW_INVENTORY_DC') }} "VW_INVENTORY_DC"
                INNER JOIN {{ ref('STAGE', 'STG_STORE_WGT') }} "STG_STORE_WGT"
                ON "VW_INVENTORY_DC"."PRODKEY" = "STG_STORE_WGT"."PRODKEY"
                AND "VW_INVENTORY_DC"."STORE_CODE" = "STG_STORE_WGT"."STORE_CODE"
                WHERE "VW_INVENTORY_DC"."UPDATED_DATE" > 
                    (SELECT NVL(MAX(TRANSACTION_DATE),'2000-01-01') FROM {{ ref_no_link('DATASTORE','DS_INVENTORY_WGT')}})
            name: ONLINE
            noLinkRefs:
              - locationName: DATASTORE
                nodeName: DS_INVENTORY_WGT
      name: STG_INVENTORY_STORE_WGT
      overrideSQL: false
      sqlType: Stage
      type: sql
    stepCounter: f9d479c5-bb55-48fc-a88d-79f914230095
