fileVersion: 1
id: 07833d3e-cc2a-474e-8821-40934f0edc37
name: VW_FNR_FORECAST_SALES
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  database: ""
  deployEnabled: true
  description: UNITS_BASE updated on post sql of FCT_SALES_EVENT
  isMultisource: false
  locationName: STAGE
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b232c87f-bc58-4084-9fb1-a80f7665f5af
          stepCounter: 07833d3e-cc2a-474e-8821-40934f0edc37
        config: {}
        dataType: DATE
        description: ""
        hashDetails: null
        name: TRANSACTION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc9f787a-b624-475e-b36d-e03b47defe70
                stepCounter: 21eb4cfe-5225-4c5b-87cf-c43fba709101
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 729e6ce5-5050-43a4-84dc-f97915bd1584
          stepCounter: 07833d3e-cc2a-474e-8821-40934f0edc37
        config: {}
        dataType: VARCHAR(64)
        description: ""
        hashDetails: null
        name: ZONE_GEOGRAPHY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 939ad01b-91f8-4a74-b51c-8c72016a4bc5
                stepCounter: 21eb4cfe-5225-4c5b-87cf-c43fba709101
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81655b8a-b839-4c04-b3aa-63b8db50e59e
          stepCounter: 07833d3e-cc2a-474e-8821-40934f0edc37
        config: {}
        dataType: VARCHAR(50)
        description: This is the product key
        hashDetails: null
        name: PRODKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b02fffad-934a-49d0-bbfc-19632e79d08f
                stepCounter: 21eb4cfe-5225-4c5b-87cf-c43fba709101
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a9ceb5c9-f5bc-455e-a631-192f764428d1
          stepCounter: 07833d3e-cc2a-474e-8821-40934f0edc37
        config: {}
        dataType: NUMBER(20,10)
        description: ""
        name: FNR_FORECAST_UNITS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ddb7345-466e-4cc5-b28f-f061fe49a150
                stepCounter: 21eb4cfe-5225-4c5b-87cf-c43fba709101
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce3d319e-4078-4459-9e60-212f166805f0
          stepCounter: 07833d3e-cc2a-474e-8821-40934f0edc37
        config: {}
        dataType: NUMBER(20,10)
        description: ""
        name: FNR_FORECAST_SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ddb7345-466e-4cc5-b28f-f061fe49a150
                stepCounter: 21eb4cfe-5225-4c5b-87cf-c43fba709101
            transform: "\"FCT_FNR_FORECAST\".\"FNR_FORECAST_UNITS_LATEST\" * \"VW_PRICE_COST_REGION\".\"PRICE\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f328a5f2-2113-43e5-88fd-bb3d4233c851
          stepCounter: 07833d3e-cc2a-474e-8821-40934f0edc37
        config: {}
        dataType: NUMBER(20,10)
        description: ""
        name: FNR_FORECAST_MARGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ddb7345-466e-4cc5-b28f-f061fe49a150
                stepCounter: 21eb4cfe-5225-4c5b-87cf-c43fba709101
            transform: "(\"FCT_FNR_FORECAST\".\"FNR_FORECAST_UNITS_LATEST\" * \"VW_PRICE_COST_REGION\".\"MARGIN_PER_UNIT\") "
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 849ec680-1bdd-447c-8014-8d25a56d9c6c
          stepCounter: 07833d3e-cc2a-474e-8821-40934f0edc37
        config: {}
        dataType: NUMBER(20,10)
        description: ""
        name: FNR_FORECAST_APPROVED_UNITS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25a4256d-de55-4eb5-8430-6c658d559d49
                stepCounter: 21eb4cfe-5225-4c5b-87cf-c43fba709101
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0fc9a73e-867a-4203-8e75-642a74008942
          stepCounter: 07833d3e-cc2a-474e-8821-40934f0edc37
        config: {}
        dataType: NUMBER(20,10)
        description: ""
        name: FNR_FORECAST_APPROVED_SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25a4256d-de55-4eb5-8430-6c658d559d49
                stepCounter: 21eb4cfe-5225-4c5b-87cf-c43fba709101
            transform: "\"FCT_FNR_FORECAST\".\"FNR_FORECAST_APPROVED_UNITS_LATEST\" * \"VW_PRICE_COST_REGION\".\"PRICE\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86470e7a-86f2-40b2-8453-d6215efb4bad
          stepCounter: 07833d3e-cc2a-474e-8821-40934f0edc37
        config: {}
        dataType: NUMBER(20,10)
        description: ""
        name: FNR_FORECAST_APPROVED_MARGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25a4256d-de55-4eb5-8430-6c658d559d49
                stepCounter: 21eb4cfe-5225-4c5b-87cf-c43fba709101
            transform: "(\"FCT_FNR_FORECAST\".\"FNR_FORECAST_APPROVED_UNITS_LATEST\" * \"VW_PRICE_COST_REGION\".\"MARGIN_PER_UNIT\") "
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 305266ff-56c4-4d23-9f34-87a100e24d23
          stepCounter: 07833d3e-cc2a-474e-8821-40934f0edc37
        config: {}
        dataType: NUMBER(20,10)
        description: ""
        name: FNR_FORECAST_HIST_UNITS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c11d5cf-8731-4351-b867-016e43e67228
                stepCounter: 21eb4cfe-5225-4c5b-87cf-c43fba709101
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca40bf48-a75e-46c3-938b-43515e4dc7d9
          stepCounter: 07833d3e-cc2a-474e-8821-40934f0edc37
        config: {}
        dataType: NUMBER(20,10)
        description: ""
        name: FNR_FORECAST_HIST_SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c11d5cf-8731-4351-b867-016e43e67228
                stepCounter: 21eb4cfe-5225-4c5b-87cf-c43fba709101
            transform: "\"FCT_FNR_FORECAST\".\"FNR_FORECAST_UNITS_FIRST\" * \"VW_PRICE_COST_REGION\".\"PRICE\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9cac66e9-355a-41a3-a608-d15580809bc2
          stepCounter: 07833d3e-cc2a-474e-8821-40934f0edc37
        config: {}
        dataType: NUMBER(20,10)
        description: ""
        name: FNR_FORECAST_HIST_MARGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c11d5cf-8731-4351-b867-016e43e67228
                stepCounter: 21eb4cfe-5225-4c5b-87cf-c43fba709101
            transform: "(\"FCT_FNR_FORECAST\".\"FNR_FORECAST_UNITS_FIRST\" * \"VW_PRICE_COST_REGION\".\"MARGIN_PER_UNIT\") "
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbc23c47-0970-4cb5-a0e6-09cde2523224
          stepCounter: 07833d3e-cc2a-474e-8821-40934f0edc37
        config: {}
        dataType: NUMBER(20,10)
        description: ""
        name: FNR_FORECAST_APPROVED_HIST_UNITS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e406b1d9-b093-47fe-803c-ea150b1df954
                stepCounter: 21eb4cfe-5225-4c5b-87cf-c43fba709101
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 257e3612-aaf3-4606-80b4-77727f6c7896
          stepCounter: 07833d3e-cc2a-474e-8821-40934f0edc37
        config: {}
        dataType: NUMBER(20,10)
        description: ""
        name: FNR_FORECAST_APPROVED_HIST_SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e406b1d9-b093-47fe-803c-ea150b1df954
                stepCounter: 21eb4cfe-5225-4c5b-87cf-c43fba709101
            transform: "\"FCT_FNR_FORECAST\".\"FNR_FORECAST_APPROVED_UNITS_FIRST\" * \"VW_PRICE_COST_REGION\".\"PRICE\""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c9bd017-5d90-41a2-a007-7be9de7c4e58
          stepCounter: 07833d3e-cc2a-474e-8821-40934f0edc37
        config: {}
        dataType: NUMBER(20,10)
        description: ""
        name: FNR_FORECAST_APPROVED_HIST_MARGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e406b1d9-b093-47fe-803c-ea150b1df954
                stepCounter: 21eb4cfe-5225-4c5b-87cf-c43fba709101
            transform: "(\"FCT_FNR_FORECAST\".\"FNR_FORECAST_APPROVED_UNITS_FIRST\" * \"VW_PRICE_COST_REGION\".\"MARGIN_PER_UNIT\") "
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67172e2a-5281-44c0-ae3e-c84953cb10b7
          stepCounter: 07833d3e-cc2a-474e-8821-40934f0edc37
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: PC_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3348fb2a-e7fb-4b59-b7da-510338bd86c2
                stepCounter: 72a0e5a7-a669-4c2e-810c-418edf46939a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 460e0a79-ab09-4093-a7dd-1b689b9e6515
          stepCounter: 07833d3e-cc2a-474e-8821-40934f0edc37
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: ACP_PER_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0ea6f97-51f8-4c0b-80ed-c33288a54dc6
                stepCounter: 72a0e5a7-a669-4c2e-810c-418edf46939a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 623b026e-25a4-4e50-96db-357c99cb45a8
          stepCounter: 07833d3e-cc2a-474e-8821-40934f0edc37
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: UBC_PER_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ef71c90-394f-4bb4-b310-a3a21f948f82
                stepCounter: 72a0e5a7-a669-4c2e-810c-418edf46939a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c58b955d-a81e-4513-be2a-460189c8f96e
          stepCounter: 07833d3e-cc2a-474e-8821-40934f0edc37
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: SOA_PER_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3285f420-9566-435c-8760-6241d120dd80
                stepCounter: 72a0e5a7-a669-4c2e-810c-418edf46939a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d730acb-a309-450a-8257-f464f99f58cc
          stepCounter: 07833d3e-cc2a-474e-8821-40934f0edc37
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: MARGIN_PER_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52ee017b-4c40-4810-850a-c5103c4ea7af
                stepCounter: 72a0e5a7-a669-4c2e-810c-418edf46939a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93c1d37d-3d5b-4021-a8c1-f9bc8d37ecb2
          stepCounter: 07833d3e-cc2a-474e-8821-40934f0edc37
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: TAKE_IN_COST_PER_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea9c10cb-e1b9-4a1a-96a0-fcafd8020330
                stepCounter: 72a0e5a7-a669-4c2e-810c-418edf46939a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 947b8771-db1a-457f-9e92-0958b98306d2
          stepCounter: 07833d3e-cc2a-474e-8821-40934f0edc37
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: VAT_PERCENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 83a2bbaf-418a-4e77-ac8e-14488445aeff
                stepCounter: 72a0e5a7-a669-4c2e-810c-418edf46939a
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          FCT_FNR_FORECAST: 21eb4cfe-5225-4c5b-87cf-c43fba709101
          VW_PRICE_COST_REGION: 72a0e5a7-a669-4c2e-810c-418edf46939a
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATA
            nodeName: FCT_FNR_FORECAST
          - locationName: STAGE
            nodeName: VW_PRICE_COST_REGION
        join:
          joinCondition: |
            FROM {{ ref('DATA', 'FCT_FNR_FORECAST') }} "FCT_FNR_FORECAST"
            INNER JOIN {{ ref('STAGE','VW_PRICE_COST_REGION') }} "VW_PRICE_COST_REGION"
            ON "FCT_FNR_FORECAST"."ZONE_GEOGRAPHY" = "VW_PRICE_COST_REGION"."ZONE_GEOGRAPHY"
            AND "FCT_FNR_FORECAST"."PRODKEY" = "VW_PRICE_COST_REGION"."PRODKEY"
            AND "FCT_FNR_FORECAST"."FNR_DATE" BETWEEN "VW_PRICE_COST_REGION"."PC_DT" AND "VW_PRICE_COST_REGION"."PC_DT_END"
        name: VW_FNR_FORECAST_SALES
        noLinkRefs: []
  name: VW_FNR_FORECAST_SALES
  overrideSQL: false
  schema: ""
  sqlType: "16"
  type: sql
  version: 1
type: Node
