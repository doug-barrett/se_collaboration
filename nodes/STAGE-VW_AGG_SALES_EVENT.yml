fileVersion: 1
id: d51a74d6-3827-4601-b6c9-e4623741f668
name: VW_AGG_SALES_EVENT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa075a61-47da-459f-b543-e8569fda7c1f
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: INTEGER
        description: Generated artificial key
        name: DIM_EVENTS_REGION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0719bbc-cad9-42a6-897a-702e8baa5d25
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54cc3793-7deb-47a2-b9c5-a1de113cab63
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: INTEGER
        description: Generated artificial key
        name: DIM_BASE_EVENTS_REGION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4c7e764-0ee4-41e9-b6a6-6637962a5d35
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 842af0a6-f8b8-4aff-8e28-86b388e8caa2
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: VARCHAR(64)
        description: ""
        name: ZONE_GEOGRAPHY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ec3038bb-eba6-452c-b04d-8c101a03990a
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9b69b367-24f7-4170-8193-92a2d7b445f8
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: VARCHAR(50)
        description: This is the product key
        name: PRODKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77ea71ee-c2b2-4041-9fb6-2a07524fcfbb
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 61dd70ff-1181-415b-8827-d1f9ea0d4a2c
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: VARCHAR(64)
        description: ""
        name: EVENT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90bf615e-689f-4038-bd92-2e1c9c951a68
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 302e414b-0d3a-4c4b-bc87-62ce1886f532
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: STRING
        description: ""
        name: PROMO_OBSERVATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90bf615e-689f-4038-bd92-2e1c9c951a68
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: |-
              CASE 
                  WHEN DIM_EVENTS_REGION.EVENT_TYPE like 'BASE%' THEN 'Baseline'
                  WHEN RIGHT(TO_CHAR(DIM_EVENTS_REGION.NOW_PRICE),3) in ('470', '970') THEN 'Markdown'
                  WHEN NVL(UPLIFT_MARGIN,0) > 0  AND NVL(UPLIFT_UNITS,0) < 0 THEN 'Neg vol, inc margin'
                  WHEN NVL(UPLIFT_MARGIN,0) > 0  AND NVL(UPLIFT_UNITS,0) > 0 THEN 'Inc vol and margin'
                  WHEN NVL(UPLIFT_MARGIN,0) < 0  AND NVL(UPLIFT_UNITS,0) > 0 THEN 'Inc vol, neg margin'
                  WHEN NVL(UPLIFT_MARGIN,0) < 0  AND NVL(UPLIFT_UNITS,0) < 0 THEN 'Neg vol, neg margin'
                  WHEN NVL(UPLIFT_MARGIN,0) < 0  AND NVL(UPLIFT_UNITS,0) = 0 THEN 'Static vol, neg margin'
                  WHEN NVL(UPLIFT_MARGIN,0) > 0  AND NVL(UPLIFT_UNITS,0) = 0 THEN 'Static vol, inc margin'
                  WHEN NVL(UPLIFT_MARGIN,0) = 0  AND NVL(UPLIFT_UNITS,0) < 0 THEN 'Neg vol, static margin'
                  WHEN NVL(UPLIFT_MARGIN,0) = 0  AND NVL(UPLIFT_UNITS,0) > 0 THEN 'Inc vol, static margin'
              ELSE 'No Sales'
              END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1d117aa-833b-4fb0-95a7-41e06f003f59
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: STRING
        description: ""
        name: EVENT_TYPE_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90bf615e-689f-4038-bd92-2e1c9c951a68
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: |
              CASE 
                  WHEN DIM_EVENTS_REGION.EVENT_TYPE = 'BASE ALL' THEN 'EDVP'
                  WHEN DIM_EVENTS_REGION.EVENT_TYPE LIKE 'BASE%' THEN 'Baseline'
                  WHEN DIM_EVENTS_REGION.EVENT_TYPE NOT LIKE 'BASE%' AND "DIM_BASE_EVENTS_KEY" = 0 THEN 'Promo with no base'
                  WHEN FCT_SALES_EVENT.UNITS_SALES < 5 THEN 'Promo units < 5'
                  WHEN FCT_SALES_EVENT.BASE_UNITS < 5 THEN 'Base units < 5'
                  WHEN DIM_EVENTS_REGION.DISCOUNT_PERCENT <= 0 THEN 'Promo price >= base price'
              ELSE 'Promo'
              END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26f28531-c54f-4b9e-b67b-fbe159733469
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: STRING
        description: ""
        name: EVENT_DURATION_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90bf615e-689f-4038-bd92-2e1c9c951a68
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: |-
              CASE WHEN DIM_EVENTS_REGION.EVENT_TYPE LIKE 'BASE%' THEN 'Baseline'
                  WHEN DIM_EVENTS_REGION.DURATION >= 7 THEN '1 week or more'
              ELSE 'Less than a week'
              END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98089b8a-5746-4108-b2e8-9a29b14e9d8c
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: STRING
        description: ""
        name: BASE_DURATION_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90bf615e-689f-4038-bd92-2e1c9c951a68
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: |-
              CASE WHEN DIM_EVENTS_REGION.EVENT_TYPE LIKE 'BASE%' THEN 'Baseline'
                  WHEN FCT_SALES_EVENT.BASE_DURATION >= 7 THEN '1 week or more'
              ELSE 'Less than a week'
              END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5afc575-ac4f-496a-8f1a-0d4d07af6410
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: STRING
        description: ""
        name: MARGIN_UPLIFT_CATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 90bf615e-689f-4038-bd92-2e1c9c951a68
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: |-
              CASE 
                  WHEN DIM_EVENTS_REGION."EVENT_TYPE" LIKE 'BASE%' THEN 'Baseline' 
                  WHEN UNITS_SALES = 0 THEN 'No sales'
                  WHEN UPLIFT_MARGIN < -500 THEN 'Lost money'
                  WHEN UPLIFT_MARGIN BETWEEN -500 AND 500  THEN 'About even'
                  WHEN UPLIFT_MARGIN > 500  THEN 'Made money'
              ELSE 'Not sure'
              END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b00973d4-0133-43ed-b524-098b312e9155
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DATE
        description: ""
        name: EFFECTIVE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7e090a1e-9e1b-4bd9-815e-c65cabb37a28
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e95973e-ae6b-4ae8-bbd5-fb4b9b1a0090
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DATE
        description: ""
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 00972e30-8889-4dd2-8659-d79423fb4151
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39d51980-831e-4212-aeda-02696a2dae59
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: INT
        description: ""
        name: DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d401ef2-9a1c-469c-8837-c6f71cffb902
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fde6ecc2-e7b9-44b3-83b3-1eb454ab57f3
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: VARCHAR(64)
        description: ""
        name: WAS_NOW
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 86aee13f-4904-4351-ae18-15776bf64af4
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21c77bfa-9512-4072-898a-080a46ab3c01
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: NUMBER(9,2)
        description: ""
        name: WAS_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5c93352d-8419-42d5-880b-b2c00d1cf1c8
                stepCounter: b4585615-226c-470e-8e85-be95816a6df2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80845c3e-a4f7-466e-be75-1e1e986239c3
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: NUMBER(9,2)
        description: ""
        name: NOW_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9672042f-7aae-4b02-b43f-67f823a84cc3
                stepCounter: b4585615-226c-470e-8e85-be95816a6df2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9a8ca0f-5f55-4da7-85c7-6be1231ce06d
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: NUMBER(9,2)
        description: ""
        name: DISCOUNT_PERCENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ede40712-0896-48ea-879c-3cde27fe84d6
                stepCounter: b4585615-226c-470e-8e85-be95816a6df2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ccfcf02-248c-494b-bd6f-516c0b8daf6e
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: NUMBER
        description: ""
        name: DISCOUNT_BUCKET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd16bdab-a30a-4f29-a018-6bf4f27b6f6c
                stepCounter: b4585615-226c-470e-8e85-be95816a6df2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a80f9932-1d10-4fb3-9456-3a95e5a484aa
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: VARCHAR(64)
        description: ""
        name: HOLIDAY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e887d56-d37d-4e5f-a594-6a55cc229433
                stepCounter: 2d9f453e-f432-4a19-a605-81709e23d574
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3873616-9816-4666-bb7e-b97b7fcb8f96
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: VARCHAR(64)
        description: ""
        name: CAMPAIGN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6371abab-00a7-47fa-ae8f-c80e42eaed94
                stepCounter: 2d9f453e-f432-4a19-a605-81709e23d574
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: beac3829-85a4-408b-bc1a-b18aca33be64
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: VARCHAR(255)
        description: ""
        name: CAMPAIGN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c9a3543-ab00-4b3e-b2d9-193e5c567f73
                stepCounter: 2d9f453e-f432-4a19-a605-81709e23d574
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 06a8e1d9-6e37-4848-a1ac-0be66aed5c33
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: FINANCIAL_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4002d1c2-ff8a-4b5f-927c-1f5be4257a85
                stepCounter: 2d9f453e-f432-4a19-a605-81709e23d574
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d57ac62f-36f9-491b-bbd5-1b1000a4437a
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: FINANCIAL_WEEK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2246e010-ea5d-4b5b-975a-a51a8a65b11c
                stepCounter: 2d9f453e-f432-4a19-a605-81709e23d574
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52ea0a9e-e9ed-4ad2-9889-23b86be8b2cb
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DATE
        description: ""
        name: BASE_EFFECTIVE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c47ebe09-0f29-4f1c-ad2c-4ab03e604bf3
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db204253-4464-4613-864e-2ca0dfdd8634
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DATE
        description: ""
        name: BASE_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9956dfa4-bb9e-415a-9352-08cd506ae50f
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8573c16-18d7-4d9c-99f4-f90463ffffe0
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: INT
        description: ""
        name: BASE_DURATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c82055b-e962-4b21-ac78-3a18b7e8eecc
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f7f9235-ae43-4cd2-8e79-78bdcb9de0f3
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DECIMAL(12,6)
        description: ""
        name: EVENT_BASE_RATIO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b40db0fb-0596-4a67-af27-252a2a62476c
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21d1176e-662d-4d18-a00d-84bbe2566566
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: VARCHAR(64)
        description: ""
        name: BASE_EVENT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba61d0f0-c447-493f-9c2a-1fd83ac9ffc9
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff292ab2-a6e7-49eb-8ba5-f8b9c0639f67
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9c9680d-8108-47ff-9182-8fd61af57c99
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cfe18c9f-d356-4183-a2f0-8fbf6edfd985
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: BASE_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f799df1a-6864-4b9b-be30-51092e3d642d
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7fbec792-aed7-4d56-b8b0-552e5bed33ac
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: DISCOUNT_RATIO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ae14759-2add-484f-83d1-de446de1ab45
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a19f1c5-6716-4e3c-8711-c8d50acb25e9
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: NUMBER(9,2)
        description: ""
        name: BASE_UNITS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae247fee-5df4-4bf7-a523-245c04e1387e
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: NVL("FCT_SALES_EVENT"."BASE_UNITS",0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3dbbe311-ffe8-4c94-88b3-51cc22a8a612
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: NUMBER(9,2)
        description: ""
        name: UNITS_SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e21cb1c8-7de2-4875-a81e-047f57806dde
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: NVL("FCT_SALES_EVENT"."UNITS_SALES",0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90794df6-e339-4375-b211-3694c356d42b
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: NUMBER(9,2)
        description: ""
        name: UPLIFT_UNITS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5016cc4-a10b-4349-bccd-3a305c647162
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: NVL("FCT_SALES_EVENT"."UPLIFT_UNITS",0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b36950df-c523-4c79-a05a-7e2e09d8de1b
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DECIMAL(16,2)
        description: ""
        name: SALES_SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c845383d-1af7-4068-a7b2-83a3c749e765
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: NVL("FCT_SALES_EVENT"."SALES_SALES",0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87a29053-ec4f-42fb-8ceb-454ebd87b27d
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DECIMAL(16,2)
        description: ""
        name: BASE_SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4019854d-8f14-4420-923c-921bb2c20b4a
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: NVL("FCT_SALES_EVENT"."BASE_SALES",0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16c5ee13-5c24-4930-85dd-6bd900e5e0c6
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DECIMAL(16,2)
        description: ""
        name: UPLIFT_SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9fc0e49f-f568-41a3-bbd5-4005eb628d72
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: NVL("FCT_SALES_EVENT"."UPLIFT_SALES",0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c0c01d1-7c3b-434c-8a98-2f86cb95c878
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DECIMAL(16,2)
        description: ""
        name: MARGIN_TOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9d3af86-b826-4353-8ebb-19aeccb7ccd7
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: NVL("FCT_SALES_EVENT"."MARGIN_SALES",0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34061428-ae05-4c4e-ace3-8099fbe316d4
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DECIMAL(16,2)
        description: ""
        name: BASE_MARGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ebe78b9b-b584-4049-9cc8-8bafbb1d7460
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: NVL("FCT_SALES_EVENT"."BASE_MARGIN",0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2518928d-2220-40e4-9a88-1b38f1ea7b12
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DECIMAL(16,2)
        description: ""
        name: UPLIFT_MARGIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 98416ead-21a6-4fce-8fc5-21729350341d
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: NVL("FCT_SALES_EVENT"."UPLIFT_MARGIN",0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a3d1def-2d40-42fc-bf66-c0b1e56c111a
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: ACP_PER_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19319ffd-22e2-4bfb-b760-b6a5bde7fb90
                stepCounter: 98a79ee0-39e1-4d29-9b40-12a08dc9fd23
            transform: NVL("DIM_PRICE_COST_2"."ACP_PER_UNIT",0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f7f71d6-6cf8-42cc-a31a-25d2ce67f7a3
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: UBC_PER_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0fa365f9-b094-4b7d-8ecd-fc56a05485bb
                stepCounter: 98a79ee0-39e1-4d29-9b40-12a08dc9fd23
            transform: NVL("DIM_PRICE_COST_2"."UBC_PER_UNIT",0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 571e7653-28d8-4515-a667-dfa4344d1bc7
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: SOA_PER_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8422efb7-9468-41cc-9c2e-85d121290ba0
                stepCounter: 98a79ee0-39e1-4d29-9b40-12a08dc9fd23
            transform: NVL("DIM_PRICE_COST_2"."SOA_PER_UNIT",0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13d8c110-400e-4a18-8cf5-33721ae0c4dd
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: COST_PER_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e56b131-2f38-46da-92f0-288f3c5d9783
                stepCounter: 98a79ee0-39e1-4d29-9b40-12a08dc9fd23
            transform: NVL("DIM_PRICE_COST_2"."COST_PER_UNIT",0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c9530bd-5a7b-47d4-9917-5ab940219b94
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: NUMBER(9,2)
        description: ""
        name: APPLIED_TA_PER_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e62936c-b5c3-4d52-9910-617f59a2cb41
                stepCounter: 98a79ee0-39e1-4d29-9b40-12a08dc9fd23
            transform: NVL("DIM_PRICE_COST_2"."APPLIED_TA_PER_UNIT",0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: be487090-7591-4bfc-a8ce-96041d4d01dd
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: NUMBER(9,2)
        description: ""
        name: MARGIN_PER_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e62936c-b5c3-4d52-9910-617f59a2cb41
                stepCounter: 98a79ee0-39e1-4d29-9b40-12a08dc9fd23
            transform: NVL("DIM_PRICE_COST_2"."APPLIED_TA_PER_UNIT",0)
      - acceptedValues:
          strictMatch: false
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 77823660-79a0-4353-94c7-e2f65c042ffc
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: NUMBER(9,2)
        description: ""
        name: MARGIN_PERCENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 31f31512-c8e8-4d79-9c05-61a06f74d524
                stepCounter: 98a79ee0-39e1-4d29-9b40-12a08dc9fd23
            transform: NVL("DIM_PRICE_COST_2"."MARGIN_PERCENT",0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82416cbf-5c70-41d7-a53f-91d91eb095ee
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: SOA_TOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8422efb7-9468-41cc-9c2e-85d121290ba0
                stepCounter: 98a79ee0-39e1-4d29-9b40-12a08dc9fd23
            transform: SOA_PER_UNIT * UNITS_SALES
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 946081d2-4362-4c69-a472-5e2368515826
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: RETAILER_SOA_TOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8422efb7-9468-41cc-9c2e-85d121290ba0
                stepCounter: 98a79ee0-39e1-4d29-9b40-12a08dc9fd23
            transform: |-
              CASE WHEN DIM_EVENTS_REGION.DISCOUNT_PERCENT = 0 THEN 0 
              ELSE  ((ACP_PER_UNIT + UBC_PER_UNIT) * (DIM_EVENTS_REGION.DISCOUNT_PERCENT/100)) - SOA_PER_UNIT
              END * FCT_SALES_EVENT.UNITS_SALES
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54ce8d19-5827-445f-962c-a87da1233285
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: MAINTAIN_MARGIN_TOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8422efb7-9468-41cc-9c2e-85d121290ba0
                stepCounter: 98a79ee0-39e1-4d29-9b40-12a08dc9fd23
            transform: |
              (((ACP_PER_UNIT + UBC_PER_UNIT)
                * ("DIM_EVENTS_REGION"."DISCOUNT_PERCENT" / 100)))
                * NVL(UNITS_SALES, 0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 997ec3e5-541c-448c-b9f3-0566639bb8a5
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: VARCHAR(3)
        description: ""
        name: CURRENCY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: faaae3eb-a9d4-43b6-b44e-a28794a654f0
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d146ac4f-73ba-4f6e-93f0-a4870ccb2c67
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: NUMBER(13,2)
        description: ""
        name: INVENTORY_MIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99aeff39-2eab-45a6-b0f7-802446b51803
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b46b3d37-c291-4919-8713-9a691273de72
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DECIMAL(12,6)
        description: ""
        name: INVENTORY_WGT_MIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 243a291c-ffc5-483b-81a4-0449c5e20755
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 54f41274-ebf9-416c-9330-02f06ea8fa65
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: NUMBER(13,2)
        description: ""
        name: INVENTORY_AVG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20d5a169-1057-4764-81f5-ba8f88e0de0b
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 33d517ac-ef1f-4b18-bf28-e8deef1ef9df
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DECIMAL(12,6)
        description: ""
        name: INVENTORY_WGT_AVG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a527a5b1-9170-480e-94cf-69fcb8fd7084
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fab429ad-52ac-4cc0-b757-1c5292eaa64b
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: CPI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d7ab958-8bdc-44a3-85fc-74a1d6bf7b39
                stepCounter: fefb74e9-0edf-4b30-9f9c-b336c99bf5b5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 76d88b9a-4847-4a9a-993e-3e4f58102251
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: PRIOR_CPI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67e88399-95e0-4b55-867b-e75f6a88ce09
                stepCounter: fefb74e9-0edf-4b30-9f9c-b336c99bf5b5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d88d089-946c-4e6a-b0d0-a8fac8efe337
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: STRING
        description: ""
        name: CPI_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bddb2194-85b0-43cd-9c15-8192be5dbdab
                stepCounter: fefb74e9-0edf-4b30-9f9c-b336c99bf5b5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a652301-e35a-4ba1-8909-19d17251fabe
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: STRING
        description: ""
        name: PRICE_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14162742-a488-4300-9fc0-312abdf5309d
                stepCounter: fefb74e9-0edf-4b30-9f9c-b336c99bf5b5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 376e04f5-8ed5-4a9a-aad3-a3cf0a2139a9
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: CHAR(1)
        description: ""
        name: CURRY_CHEAPEST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a0fb724-1d80-43ea-8310-f642483a34d7
                stepCounter: fefb74e9-0edf-4b30-9f9c-b336c99bf5b5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8fe41a9-77ab-4dbe-8739-68a789f254c2
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: CHAR(1)
        description: ""
        name: CURRY_CHEAPEST1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ee56818-2a11-4294-a407-2c424191111a
                stepCounter: fefb74e9-0edf-4b30-9f9c-b336c99bf5b5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 117d4fad-84ef-4c5d-9bbe-172cf722d80c
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: CHAR(1)
        description: ""
        name: CURRY_CHEAPEST2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0422e717-e0b7-4600-aa97-a8f74216e812
                stepCounter: fefb74e9-0edf-4b30-9f9c-b336c99bf5b5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0f7b622-0aed-4f7a-a5f1-8c6e80758b49
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: CHAR(1)
        description: ""
        name: CURRY_CHEAPEST3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5edc231a-165c-4b21-b4c4-de6c74dce73f
                stepCounter: fefb74e9-0edf-4b30-9f9c-b336c99bf5b5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c4e61b6-13be-4640-920a-db02628d4f80
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: CHAR(1)
        description: ""
        name: CURRY_CHEAPEST4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1310af4-52de-4aa5-92ca-9415f43fe7c7
                stepCounter: fefb74e9-0edf-4b30-9f9c-b336c99bf5b5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 45f5ee0a-19cd-4f2e-9a35-3e6a5e40c772
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: CHAR(1)
        description: ""
        name: CURRY_CHEAPEST5
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 318063b9-1a52-4658-af7f-d1faeb85f878
                stepCounter: fefb74e9-0edf-4b30-9f9c-b336c99bf5b5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e545a391-fd23-4ab4-b2c6-b9e2b3d3638a
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: CHAR(1)
        description: ""
        name: CURRY_CHEAPEST6
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dac6b225-146e-4eda-9cf3-8ded83ccaa33
                stepCounter: fefb74e9-0edf-4b30-9f9c-b336c99bf5b5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b90f60f-2dce-42d7-90d2-d4b6ab19cddf
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: CHAR(1)
        description: ""
        name: CURRY_CHEAPEST7
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: daf07b97-74d6-4d07-8401-c3ebb72e5ef0
                stepCounter: fefb74e9-0edf-4b30-9f9c-b336c99bf5b5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3cec7e9b-76ae-4431-a2e6-324b3843a31d
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: AVG_CPI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 08d773c6-fbf5-4bdd-add7-07ff2e463dd8
                stepCounter: e75d57a8-07fa-4815-87fe-e40868c3b5c4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1198bb83-2f62-4a9a-aee9-3758de481cdc
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: MIN_CPI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 169ad348-92eb-44c1-a1eb-0a9c183ba1bc
                stepCounter: e75d57a8-07fa-4815-87fe-e40868c3b5c4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25480ec0-6ce1-4b68-9e0f-1b0c6955d27c
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: MAX_CPI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5b296c4-ee04-425b-8c31-1e8f86f98aae
                stepCounter: e75d57a8-07fa-4815-87fe-e40868c3b5c4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a4010195-4c0f-482e-8311-16402247cbc6
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: NUMBER
        description: ""
        name: CURRY_CHEAPEST_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc50777a-9688-4461-8035-93051dd8e96d
                stepCounter: e75d57a8-07fa-4815-87fe-e40868c3b5c4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3d8624a-a829-489c-a40b-51ba67162b3b
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: NUMBER
        description: ""
        name: CURRY_NOT_CHEAPEST_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 112b73c9-8682-40f4-bd61-eae02c713f4d
                stepCounter: e75d57a8-07fa-4815-87fe-e40868c3b5c4
            transform: ""
      - acceptedValues:
          strictMatch: false
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: faedaaa0-4654-4364-8ba7-f9c3f80e21a3
          stepCounter: d51a74d6-3827-4601-b6c9-e4623741f668
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: UNITS_NET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84abc9a6-3f32-49e1-9afe-ca4bd18b5160
                stepCounter: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_DATE: 2d9f453e-f432-4a19-a605-81709e23d574
          DIM_EVENTS_REGION: b4585615-226c-470e-8e85-be95816a6df2
          DIM_PRICE_COST_2: 98a79ee0-39e1-4d29-9b40-12a08dc9fd23
          FCT_SALES_EVENT: f40cbd4e-9b40-4fa8-b8f7-8127a9770fde
          VW_BRAND_VIEW_DAY_HISTORY: fefb74e9-0edf-4b30-9f9c-b336c99bf5b5
          VW_EVENT_CPI: e75d57a8-07fa-4815-87fe-e40868c3b5c4
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATA
            nodeName: DIM_DATE
          - locationName: DATA
            nodeName: DIM_EVENTS_REGION
          - locationName: DATA
            nodeName: DIM_PRICE_COST_2
          - locationName: DATA
            nodeName: FCT_SALES_EVENT
          - locationName: STAGE
            nodeName: VW_BRAND_VIEW_DAY_HISTORY
          - locationName: STAGE
            nodeName: VW_EVENT_CPI
        join:
          joinCondition: |-
            FROM {{ ref('DATA', 'FCT_SALES_EVENT') }} "FCT_SALES_EVENT"
            JOIN {{ ref('DATA', 'DIM_EVENTS_REGION') }} "DIM_EVENTS_REGION"
            ON "FCT_SALES_EVENT"."DIM_EVENTS_REGION_KEY" = "DIM_EVENTS_REGION"."DIM_EVENTS_REGION_KEY"
            JOIN {{ ref('DATA', 'DIM_DATE') }} "DIM_DATE"
            ON "FCT_SALES_EVENT"."EFFECTIVE_DATE" = "DIM_DATE"."CALENDAR_DATE"
            JOIN {{ ref('DATA', 'DIM_PRICE_COST_2') }} "DIM_PRICE_COST_2"
            ON "FCT_SALES_EVENT"."DIM_PRICE_COST_KEY" = "DIM_PRICE_COST_2"."DIM_PRICE_COST_KEY"
            LEFT JOIN {{ ref('STAGE', 'VW_BRAND_VIEW_DAY_HISTORY') }} "VW_BRAND_VIEW_DAY_HISTORY"
            ON "FCT_SALES_EVENT"."ZONE_GEOGRAPHY" = "VW_BRAND_VIEW_DAY_HISTORY"."ZONE_GEOGRAPHY"
            AND "FCT_SALES_EVENT"."PRODKEY" = "VW_BRAND_VIEW_DAY_HISTORY"."PRODKEY"
            AND "FCT_SALES_EVENT"."EFFECTIVE_DATE" = "VW_BRAND_VIEW_DAY_HISTORY"."SCRAPE_DATE"
            LEFT JOIN {{ ref('STAGE', 'VW_EVENT_CPI') }} "VW_EVENT_CPI"
            ON "FCT_SALES_EVENT".DIM_EVENTS_REGION_KEY = VW_EVENT_CPI.DIM_EVENTS_REGION_KEY
        name: VW_AGG_SALES_EVENT
        noLinkRefs: []
  name: VW_AGG_SALES_EVENT
  overrideSQL: false
  schema: ""
  sqlType: "16"
  type: sql
  version: 1
type: Node
