fileVersion: 1
id: 7bd391eb-96e4-49e3-a40a-0a4df8014761
name: VWA_KPI
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  database: ""
  deployEnabled: true
  description: "Just a bit of tidy up "
  isMultisource: false
  locationName: VIEWS
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97a0839f-4194-4007-aab7-51f3c6e111b5
          stepCounter: 7bd391eb-96e4-49e3-a40a-0a4df8014761
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        hashDetails: null
        name: ZONE_GEOGRAPHY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82f062c1-c2c9-48e5-aaa5-737cf4097951
                stepCounter: 9419c4f7-0958-4473-9558-c7ec251064bf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f9692177-87d7-40b2-b8d6-2047c6f36f43
          stepCounter: 7bd391eb-96e4-49e3-a40a-0a4df8014761
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL3_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d51521a9-8a90-4dce-ac03-335f02066694
                stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79634189-fe3e-4fbe-a4e9-88b268987d9b
          stepCounter: 7bd391eb-96e4-49e3-a40a-0a4df8014761
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: TIME_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6949eb2e-a9f7-4826-9196-78835783eb52
                stepCounter: 9419c4f7-0958-4473-9558-c7ec251064bf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 441253ca-ed6a-431a-acce-e299d36c9ddd
          stepCounter: 7bd391eb-96e4-49e3-a40a-0a4df8014761
        config: {}
        dataType: NUMBER
        description: ""
        name: FORECAST_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09196ed8-eefb-4366-afcd-cddb19ee28bc
                stepCounter: 9419c4f7-0958-4473-9558-c7ec251064bf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a1be044-3ca5-424d-aa08-7e5090367309
          stepCounter: 7bd391eb-96e4-49e3-a40a-0a4df8014761
        config: {}
        dataType: NUMBER
        description: ""
        name: EVENT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 488abd73-4f3a-46f7-8cfe-406bd4dcbc33
                stepCounter: 9419c4f7-0958-4473-9558-c7ec251064bf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 69e82021-e96f-4b1a-9654-a72e4f5ea83c
          stepCounter: 7bd391eb-96e4-49e3-a40a-0a4df8014761
        config: {}
        dataType: NUMBER
        description: ""
        name: BELOW_MARKET_CPI_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2d0ce4a-baa1-4c10-a435-5de56b986bb7
                stepCounter: 9419c4f7-0958-4473-9558-c7ec251064bf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c044743-269b-4ae6-b4df-87c06b0dbcbf
          stepCounter: 7bd391eb-96e4-49e3-a40a-0a4df8014761
        config: {}
        dataType: NUMBER
        description: ""
        name: AT_MARKET_CPI_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99b5a2fd-d42e-4099-8185-6d14759f9c84
                stepCounter: 9419c4f7-0958-4473-9558-c7ec251064bf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 794b701f-2c2c-4d05-ba71-24a7afbbc4a8
          stepCounter: 7bd391eb-96e4-49e3-a40a-0a4df8014761
        config: {}
        dataType: NUMBER
        description: ""
        name: ABOVE_MARKET_CPI_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e52e39a7-0bad-43ce-998e-2f664363c085
                stepCounter: 9419c4f7-0958-4473-9558-c7ec251064bf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 762e28a7-a83e-4096-946c-27632a113538
          stepCounter: 7bd391eb-96e4-49e3-a40a-0a4df8014761
        config: {}
        dataType: NUMBER
        description: ""
        name: LOW_WEIGHTED_INVENTORY_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 325a6f66-2651-47ec-a086-300408d75c80
                stepCounter: 9419c4f7-0958-4473-9558-c7ec251064bf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ef3b57d-ee90-4d16-b4f7-96a1ffbb63e0
          stepCounter: 7bd391eb-96e4-49e3-a40a-0a4df8014761
        config: {}
        dataType: NUMBER
        description: ""
        name: LOW_MARGIN_UPLIFT_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e440eb4-9294-4754-81aa-94d5ad8b23f5
                stepCounter: 9419c4f7-0958-4473-9558-c7ec251064bf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce61468e-9557-4b3d-8bfa-661d425b9780
          stepCounter: 7bd391eb-96e4-49e3-a40a-0a4df8014761
        config: {}
        dataType: NUMBER
        description: ""
        name: FORECAST_POSITIVE_UPLIFT_MARGIN_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f500fc2-5011-47b6-8631-403870a7181d
                stepCounter: 9419c4f7-0958-4473-9558-c7ec251064bf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c8e7b38-5d4d-4d6d-ba24-9b7c0adb2f12
          stepCounter: 7bd391eb-96e4-49e3-a40a-0a4df8014761
        config: {}
        dataType: NUMBER
        description: ""
        name: FORECAST_NEGATIVE_UPLIFT_MARGIN_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d7779bef-818c-4aa9-9762-1e3928cd2740
                stepCounter: 9419c4f7-0958-4473-9558-c7ec251064bf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bec398e6-1cb4-453d-8c87-b8361afcb429
          stepCounter: 7bd391eb-96e4-49e3-a40a-0a4df8014761
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: AVG_FORECAST_DISCOUNT_PERCENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc0f5f89-8ba3-4dd7-8f68-25b74d02cfc9
                stepCounter: 9419c4f7-0958-4473-9558-c7ec251064bf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 926867ae-0acf-4307-9e32-594096049bf8
          stepCounter: 7bd391eb-96e4-49e3-a40a-0a4df8014761
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: AVG_FORECAST_MARGIN_PERCENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 89d5a8fd-cf7c-4367-ad12-e9a533725d33
                stepCounter: 9419c4f7-0958-4473-9558-c7ec251064bf
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_KPI: 9419c4f7-0958-4473-9558-c7ec251064bf
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: STG_KPI
          - locationName: VIEWS
            nodeName: VWA_PRODUCT
        join:
          joinCondition: |-
            FROM {{ ref('STAGE', 'STG_KPI') }} "STG_KPI"
            JOIN (SELECT DISTINCT LEVEL3_DESC FROM {{ ref('VIEWS', 'VWA_PRODUCT') }}) "VWA_PRODUCT"
            ON "VWA_PRODUCT"."LEVEL3_DESC" = "STG_KPI"."LEVEL3_DESC"
        name: VWA_KPI
        noLinkRefs: []
  name: VWA_KPI
  overrideSQL: false
  schema: ""
  sqlType: "17"
  type: sql
  version: 1
type: Node
