fileVersion: 1
id: 0b64a4d7-00e3-4196-9d28-064d3c464876
name: VW_PRICE_ELASTICITY_LATEST
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  database: ""
  deployEnabled: true
  description: Get the latest Price Elasticity for each Zone, Product, Holiday, Discount
  isMultisource: false
  locationName: STAGE
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 862ec2f3-edb1-4b3c-99e7-1a24af69e611
          stepCounter: 0b64a4d7-00e3-4196-9d28-064d3c464876
        config: {}
        dataType: VARCHAR(64)
        description: ""
        hashDetails: null
        name: ZONE_GEOGRAPHY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e023ac1-2724-455e-845f-8d8c942257b4
                stepCounter: 72c3c90c-3dfa-4735-b9d6-3383a4d823f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a9e5e88-d579-43d6-937b-736d0070a839
          stepCounter: 0b64a4d7-00e3-4196-9d28-064d3c464876
        config: {}
        dataType: VARCHAR(50)
        description: This is the product key
        hashDetails: null
        name: PRODKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5b214b7-46ab-41d0-9d22-de950a417c1d
                stepCounter: 72c3c90c-3dfa-4735-b9d6-3383a4d823f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 707a7fc9-a58b-42e9-afad-7b20bcf98cd3
          stepCounter: 0b64a4d7-00e3-4196-9d28-064d3c464876
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        hashDetails: null
        name: PRICE_DISCOUNT_BUCKET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c45e8baf-07c4-40e2-ae08-0aee804fbc35
                stepCounter: 72c3c90c-3dfa-4735-b9d6-3383a4d823f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18af34e8-c35a-486c-b4dd-dceeb9e102e2
          stepCounter: 0b64a4d7-00e3-4196-9d28-064d3c464876
        config: {}
        dataType: VARCHAR(64)
        description: ""
        hashDetails: null
        name: HOLIDAY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: daab0905-1e49-4817-8f6a-100f24b2c972
                stepCounter: 72c3c90c-3dfa-4735-b9d6-3383a4d823f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8d900b2-61d8-48d2-b4c9-5b7befb06eec
          stepCounter: 0b64a4d7-00e3-4196-9d28-064d3c464876
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL1_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 960d8ff7-eebe-41a6-8516-984af9272f6c
                stepCounter: 72c3c90c-3dfa-4735-b9d6-3383a4d823f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d06e174-be3c-413b-903f-b563a38d4dd4
          stepCounter: 0b64a4d7-00e3-4196-9d28-064d3c464876
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL2_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 280c5969-645b-4501-a9fe-7f0991af05eb
                stepCounter: 72c3c90c-3dfa-4735-b9d6-3383a4d823f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0f07bc1-3421-4445-a823-4baad1975d50
          stepCounter: 0b64a4d7-00e3-4196-9d28-064d3c464876
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL3_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce928c61-6503-4c04-a21a-d497ca68d60c
                stepCounter: 72c3c90c-3dfa-4735-b9d6-3383a4d823f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b712c77e-40a9-4937-9901-5caf143093e1
          stepCounter: 0b64a4d7-00e3-4196-9d28-064d3c464876
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL4_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39677bd9-6e6f-4608-8287-69dcf228a0d1
                stepCounter: 72c3c90c-3dfa-4735-b9d6-3383a4d823f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1811af9f-b15a-434a-9b83-e441abdb42b7
          stepCounter: 0b64a4d7-00e3-4196-9d28-064d3c464876
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL5_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: daf0bbc6-a308-43e9-b778-9ee0b78b100b
                stepCounter: 72c3c90c-3dfa-4735-b9d6-3383a4d823f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ba21833-77a7-4aa5-ac13-e296602255d5
          stepCounter: 0b64a4d7-00e3-4196-9d28-064d3c464876
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: BRAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53a3538f-a11b-4fe9-9b0d-7971352d7c39
                stepCounter: 72c3c90c-3dfa-4735-b9d6-3383a4d823f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d26d5c66-3737-40c2-a83e-0a1f5cb5fdb8
          stepCounter: 0b64a4d7-00e3-4196-9d28-064d3c464876
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: PRODUCT_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 87777341-a194-4170-87e4-d5a6e85f2fd8
                stepCounter: 72c3c90c-3dfa-4735-b9d6-3383a4d823f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 686d799c-3043-4995-a84b-e8610b486f58
          stepCounter: 0b64a4d7-00e3-4196-9d28-064d3c464876
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: PRODUCT_GROUP_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e421f21e-6e5e-4d92-abfe-21a2ad70533a
                stepCounter: 72c3c90c-3dfa-4735-b9d6-3383a4d823f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1fb31527-f65d-46ac-ad55-1abc94ba893e
          stepCounter: 0b64a4d7-00e3-4196-9d28-064d3c464876
        config: {}
        dataType: DATE
        description: ""
        hashDetails: null
        name: START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c707d365-1c49-40d3-89b6-2512b98e98f6
                stepCounter: 72c3c90c-3dfa-4735-b9d6-3383a4d823f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6546c07-b2ec-4a12-be50-343e96478773
          stepCounter: 0b64a4d7-00e3-4196-9d28-064d3c464876
        config: {}
        dataType: DATE
        description: ""
        hashDetails: null
        name: END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43a12ff4-87cc-441d-8268-d2bb488801ab
                stepCounter: 72c3c90c-3dfa-4735-b9d6-3383a4d823f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bd46cef8-2a81-4707-9266-776ca5e96ac6
          stepCounter: 0b64a4d7-00e3-4196-9d28-064d3c464876
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        hashDetails: null
        name: PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 252bbbc8-6a4d-4e76-bdf8-21a02f474fa0
                stepCounter: 72c3c90c-3dfa-4735-b9d6-3383a4d823f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 705f2000-ee14-4874-ad62-4579683b8300
          stepCounter: 0b64a4d7-00e3-4196-9d28-064d3c464876
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        hashDetails: null
        name: PRIOR_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b00a5bb4-f352-453d-8fb4-c3ded3697b62
                stepCounter: 72c3c90c-3dfa-4735-b9d6-3383a4d823f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6a61ba1-88ed-42ea-a0ed-635804309984
          stepCounter: 0b64a4d7-00e3-4196-9d28-064d3c464876
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        hashDetails: null
        name: PRICE_DISCOUNT_PERCENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e8aa41a-bc19-40a1-b8e3-2a67b5cf12b2
                stepCounter: 72c3c90c-3dfa-4735-b9d6-3383a4d823f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 160565a0-4e42-4974-ba71-ec36a5259031
          stepCounter: 0b64a4d7-00e3-4196-9d28-064d3c464876
        config: {}
        dataType: CHAR(1)
        description: ""
        hashDetails: null
        name: PRICE_DROP_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27b7da57-f093-4e76-bf60-c490e861d12c
                stepCounter: 72c3c90c-3dfa-4735-b9d6-3383a4d823f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 015fc3cd-50bd-4f85-bb61-dc4eb978295f
          stepCounter: 0b64a4d7-00e3-4196-9d28-064d3c464876
        config: {}
        dataType: NUMBER(9,2)
        description: ""
        hashDetails: null
        name: UNITS_PER_DAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53b56933-460f-45df-82cb-8012f69cc441
                stepCounter: 72c3c90c-3dfa-4735-b9d6-3383a4d823f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ab3d0a3-0731-4131-9e7e-a50f18bda829
          stepCounter: 0b64a4d7-00e3-4196-9d28-064d3c464876
        config: {}
        dataType: NUMBER(9,2)
        description: ""
        hashDetails: null
        name: PRIOR_UNITS_PER_DAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5282578-3614-4dfc-be51-fb7e6e2b704e
                stepCounter: 72c3c90c-3dfa-4735-b9d6-3383a4d823f3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74ac5b37-3b9a-48ac-bc18-483bdb51ae71
          stepCounter: 0b64a4d7-00e3-4196-9d28-064d3c464876
        config: {}
        dataType: NUMBER(6,4)
        description: ""
        hashDetails: null
        name: PRICE_ELASTICITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d53c8a5d-197d-45da-b3ad-4887c6a18ed6
                stepCounter: 72c3c90c-3dfa-4735-b9d6-3383a4d823f3
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VWA_PRICE_ELASTICITY_RAW: 72c3c90c-3dfa-4735-b9d6-3383a4d823f3
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: VIEWS
            nodeName: VWA_PRICE_ELASTICITY_RAW
        join:
          joinCondition: |-
            FROM {{ ref('VIEWS', 'VWA_PRICE_ELASTICITY_RAW') }} "VWA_PRICE_ELASTICITY_RAW"
            WHERE "PRICE_DROP_FLAG" = 'Y'
            QUALIFY 1 = ROW_NUMBER() OVER (
                        PARTITION BY "ZONE_GEOGRAPHY", PRODKEY, "HOLIDAY_NAME", "PRICE_DISCOUNT_BUCKET" 
                        ORDER BY "START_DATE" DESC)
        name: VW_PRICE_ELASTICITY_LATEST
        noLinkRefs: []
  name: VW_PRICE_ELASTICITY_LATEST
  overrideSQL: false
  schema: ""
  sqlType: "16"
  type: sql
  version: 1
type: Node
