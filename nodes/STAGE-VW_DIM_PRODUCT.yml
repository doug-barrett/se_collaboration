fileVersion: 1
id: 950b8666-650d-4f58-802d-375d20ae3fb7
name: VW_DIM_PRODUCT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2d1428f-0e9f-4a31-a60c-1b46340088e2
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: VARCHAR(50)
        description: This is the product key
        hashDetails: null
        name: PRODKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c62193d7-1c87-454b-a44a-ea7ee87d83ed
                stepCounter: 3c49b8ad-a39f-4dc6-975c-0dd2c4ce0f25
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 477fdc2f-6de4-4d77-a47f-c9b004dcef23
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: ITEM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a38442d-bfc0-4862-accc-e1b9c8fa02dc
                stepCounter: 3c49b8ad-a39f-4dc6-975c-0dd2c4ce0f25
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 404eef2e-1d38-4780-bd02-4133a8c7aef5
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: VARCHAR(100)
        description: ""
        hashDetails: null
        name: DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06474b64-123c-4571-9c63-a11bf1d3ef96
                stepCounter: 3c49b8ad-a39f-4dc6-975c-0dd2c4ce0f25
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce1720d7-6aa9-4693-b0b8-29428a81b9a1
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: BRAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 326c7d19-1495-4aa1-94b8-81bc67fb6305
                stepCounter: 3c49b8ad-a39f-4dc6-975c-0dd2c4ce0f25
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 68bf8c85-2ee5-453d-aa77-ed7ecf2edcac
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: MANUFACTURER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07cf956c-d7ce-4c36-a98d-4559fb3725a0
                stepCounter: 3c49b8ad-a39f-4dc6-975c-0dd2c4ce0f25
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28a92c1e-365f-483e-bb9f-3c3b337e7b96
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: MODEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: de29d7d8-773c-46f6-a0d8-2ef4dd28a301
                stepCounter: 3c49b8ad-a39f-4dc6-975c-0dd2c4ce0f25
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67d09aa1-13c1-45f8-855e-5603692ca489
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 807225eb-417a-4c09-8f67-71f2ca88f971
                stepCounter: 3c49b8ad-a39f-4dc6-975c-0dd2c4ce0f25
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aec68670-a490-4b7f-b932-313b5dad14c6
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: VARCHAR(10)
        description: ""
        hashDetails: null
        name: UOM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e612b16d-06b5-4614-b0b7-c23d77503462
                stepCounter: 3c49b8ad-a39f-4dc6-975c-0dd2c4ce0f25
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ea49bcf7-4d69-4dbd-8039-4283e003f0a7
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL1_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e35ea55a-74ca-4fbe-a1dd-0b9f90df6c8f
                stepCounter: 3c49b8ad-a39f-4dc6-975c-0dd2c4ce0f25
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2e738c6-fde6-4353-8c09-7aab0e9c5955
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL1_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff35c635-9f08-4753-85a9-99fcf41f0590
                stepCounter: 0d9082ec-a0f0-4877-b260-231fa26ce355
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8d16b092-f904-4f7c-8514-085893745b74
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL2_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92a9aa51-bdc0-45ae-bfec-3837598ade78
                stepCounter: 3c49b8ad-a39f-4dc6-975c-0dd2c4ce0f25
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4059138c-9f29-44ed-8bcd-033b21ca10bb
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL2_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62c5618e-0c6d-4a8e-b3d2-3a60227aab1f
                stepCounter: 0d9082ec-a0f0-4877-b260-231fa26ce355
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39df191b-e9b5-4da9-adb4-bbb9ca68304d
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL3_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72718f0f-8169-4927-ad37-f1f5a19cd00e
                stepCounter: 3c49b8ad-a39f-4dc6-975c-0dd2c4ce0f25
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: baef6bb5-87ed-4526-ba01-8a42fdce6ac9
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL3_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19e34e20-bda7-4c3a-8ccf-f2e2c7199846
                stepCounter: 0d9082ec-a0f0-4877-b260-231fa26ce355
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf49d820-8525-4976-bacf-e7b525678c94
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL4_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d95b4f4-42a2-4be0-acd7-35f23cfe1b3a
                stepCounter: 3c49b8ad-a39f-4dc6-975c-0dd2c4ce0f25
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18a7bc58-ef19-46a2-b12d-86deaefd34e4
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL4_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa445921-8c05-4666-945b-053d44072c97
                stepCounter: 0d9082ec-a0f0-4877-b260-231fa26ce355
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b53b3fb-67f3-40c8-b8f3-8652d1d2c3b7
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL5_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b36b8d3f-d8a3-4599-ad60-38598bd24b4c
                stepCounter: 3c49b8ad-a39f-4dc6-975c-0dd2c4ce0f25
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 93da3958-57fe-4f1b-ab5d-b6427423b9c0
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL5_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e248b94c-a9e3-407f-bd3d-8d7685405e2e
                stepCounter: 0d9082ec-a0f0-4877-b260-231fa26ce355
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e373a4c9-d75e-4297-8814-2c36699246c1
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: DECIMAL(38)
        description: ""
        hashDetails: null
        name: ITEM_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 989b2e18-7f5b-46e2-9f5d-053ab402c1de
                stepCounter: 3c49b8ad-a39f-4dc6-975c-0dd2c4ce0f25
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4707b83c-9e54-41e6-8a13-f6992cb5ccb6
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: PRODUCT_GROUP_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc51217f-c410-4d05-b646-56c87fe9b110
                stepCounter: c74b1ff3-7a83-4492-8c26-b85dc7e1f50a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 754bcedd-6ad5-459b-ab7a-e032a4f652bb
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: PRODUCT_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc51217f-c410-4d05-b646-56c87fe9b110
                stepCounter: c74b1ff3-7a83-4492-8c26-b85dc7e1f50a
            transform: |-
              CASE 
                  WHEN UPPER(DS_PRODUCT_GROUP.GROUP_NAME) LIKE 'CURRENT%' THEN 'Current/Future'
                  WHEN UPPER(DS_PRODUCT_GROUP.GROUP_NAME) LIKE 'FUTURE%' THEN 'Current/Future'
                  WHEN UPPER(DS_PRODUCT_GROUP.GROUP_NAME) LIKE 'EXTENDED%' THEN 'Extended Range'
              ELSE 'Markdown/Other'
              END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd23a2f3-30e2-4af2-b308-a300adc4af33
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LIKE_ITEM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37367617-4b8a-463c-aa88-1bb638462690
                stepCounter: 3c49b8ad-a39f-4dc6-975c-0dd2c4ce0f25
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9671a472-a035-45e2-9e12-0eba98d7c0db
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: DECIMAL(38)
        description: ""
        hashDetails: null
        name: IS_BUNDLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0749d0a-6fc0-49f1-b0e2-54131d2ae341
                stepCounter: 3c49b8ad-a39f-4dc6-975c-0dd2c4ce0f25
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ab7f7ace-03f3-4f60-a90f-6d4cc9c5ece1
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: DECIMAL(38)
        description: ""
        hashDetails: null
        name: PRODUCT_CONDITION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21851fbc-e534-4fd1-a7b1-2f5ed47f73e6
                stepCounter: 3c49b8ad-a39f-4dc6-975c-0dd2c4ce0f25
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 27653a27-6012-4d23-a58c-16cb1feffbda
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: DECIMAL(38)
        description: ""
        hashDetails: null
        name: IS_SHIP_FROM_STORE_ELIGIBLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9a3a9f14-eb97-4e40-820c-efb517a2a9d4
                stepCounter: 3c49b8ad-a39f-4dc6-975c-0dd2c4ce0f25
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4af8b9b-69c6-46c0-977f-1aa3dc501f60
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: VARCHAR(1000)
        description: ""
        hashDetails: null
        name: PRODUCT_URL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99fd80b4-ab24-417e-a469-27ff2cb90d27
                stepCounter: 3c49b8ad-a39f-4dc6-975c-0dd2c4ce0f25
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dab3af7e-61cb-4e2c-a013-720e5fdb19a7
          stepCounter: 950b8666-650d-4f58-802d-375d20ae3fb7
        config: {}
        dataType: VARCHAR(1000)
        description: ""
        hashDetails: null
        name: IMAGE_URL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ba2296b0-39ef-41e7-95c1-b7a0ca4c82f1
                stepCounter: 3c49b8ad-a39f-4dc6-975c-0dd2c4ce0f25
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_PRODUCT: 3c49b8ad-a39f-4dc6-975c-0dd2c4ce0f25
          DS_PRODUCT_CATEGORY: 0d9082ec-a0f0-4877-b260-231fa26ce355
          DS_PRODUCT_GROUP: c74b1ff3-7a83-4492-8c26-b85dc7e1f50a
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATASTORE
            nodeName: DS_PRODUCT
          - locationName: DATASTORE
            nodeName: DS_PRODUCT_CATEGORY
          - locationName: DATASTORE
            nodeName: DS_PRODUCT_GROUP
        join:
          joinCondition: |
            FROM {{ ref('DATASTORE', 'DS_PRODUCT') }} "DS_PRODUCT"
            LEFT JOIN {{ ref('DATASTORE', 'DS_PRODUCT_CATEGORY') }} "DS_PRODUCT_CATEGORY"
            ON "DS_PRODUCT"."LEVEL1_CODE" = "DS_PRODUCT_CATEGORY"."LEVEL1_CODE"
            AND "DS_PRODUCT"."LEVEL2_CODE" = "DS_PRODUCT_CATEGORY"."LEVEL2_CODE"
            AND "DS_PRODUCT"."LEVEL3_CODE" = "DS_PRODUCT_CATEGORY"."LEVEL3_CODE"
            AND "DS_PRODUCT"."LEVEL4_CODE" = "DS_PRODUCT_CATEGORY"."LEVEL4_CODE"
            AND "DS_PRODUCT"."LEVEL5_CODE" = "DS_PRODUCT_CATEGORY"."LEVEL5_CODE"
            LEFT JOIN {{ ref('DATASTORE', 'DS_PRODUCT_GROUP') }} "DS_PRODUCT_GROUP"
            ON "DS_PRODUCT"."PRODKEY" = "DS_PRODUCT_GROUP"."PRODKEY"
        name: VW_DIM_PRODUCT
        noLinkRefs: []
  name: VW_DIM_PRODUCT
  overrideSQL: false
  schema: ""
  sqlType: "16"
  type: sql
  version: 1
type: Node
