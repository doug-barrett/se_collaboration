fileVersion: 1
id: c8626908-14c1-4ed5-96ba-80b6b15c458e
name: VW_STG_FCT_SALES
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  database: ""
  deployEnabled: true
  description: Filters data set to new Transactions
  isMultisource: false
  locationName: STAGE
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6efa9a0b-1ecc-4e4e-9c1d-1b232d112ed4
          stepCounter: c8626908-14c1-4ed5-96ba-80b6b15c458e
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: TRANSACTION_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91ad445f-207b-421f-9a78-58dc951a04c9
                stepCounter: 8ea642ef-4606-44d0-8121-571a15ba33fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0023a3d1-a143-4ae9-ae5c-3442da028504
          stepCounter: c8626908-14c1-4ed5-96ba-80b6b15c458e
        config: {}
        dataType: DATE
        description: ""
        hashDetails: null
        name: TRANSACTION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12a36f2e-cfdc-4e2a-ac26-f688ace90519
                stepCounter: 8ea642ef-4606-44d0-8121-571a15ba33fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e64baa9-236a-4556-a2fd-7f6b908fd4b0
          stepCounter: c8626908-14c1-4ed5-96ba-80b6b15c458e
        config: {}
        dataType: VARCHAR(50)
        description: This is the product key
        hashDetails: null
        name: PRODKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d34baf39-f35c-4a72-8266-897d360ae000
                stepCounter: 8ea642ef-4606-44d0-8121-571a15ba33fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c89fe81b-7867-46cf-91d8-a71f5093603d
          stepCounter: c8626908-14c1-4ed5-96ba-80b6b15c458e
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: STORE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0c56ae92-2c32-48f6-9794-dbcb8da69ada
                stepCounter: 8ea642ef-4606-44d0-8121-571a15ba33fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d3d9dd03-1bee-40d2-9c03-31f1495186f5
          stepCounter: c8626908-14c1-4ed5-96ba-80b6b15c458e
        config: {}
        dataType: INT
        description: ""
        hashDetails: null
        name: ZONE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bff87bc4-2e76-48e6-bfdd-40a10e02327c
                stepCounter: 8ea642ef-4606-44d0-8121-571a15ba33fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f4cd9dc-2f60-4299-998b-82c7b74809ae
          stepCounter: c8626908-14c1-4ed5-96ba-80b6b15c458e
        config: {}
        dataType: VARCHAR(64)
        description: ""
        hashDetails: null
        name: ZONE_GEOGRAPHY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ef34ca2-716d-4f2f-8be9-524cd0a96acd
                stepCounter: 8ea642ef-4606-44d0-8121-571a15ba33fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b667bf4-c3de-434c-bdeb-98c7b658d6ef
          stepCounter: c8626908-14c1-4ed5-96ba-80b6b15c458e
        config: {}
        dataType: VARCHAR(4)
        description: ""
        hashDetails: null
        name: SALES_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0655aaad-a61b-4396-b516-3023e2c319a8
                stepCounter: 8ea642ef-4606-44d0-8121-571a15ba33fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20f72d37-5a2f-41e1-bd74-e3e7386e8230
          stepCounter: c8626908-14c1-4ed5-96ba-80b6b15c458e
        config: {}
        dataType: VARCHAR(1)
        description: ""
        hashDetails: null
        name: PROMO_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 780cc3bb-4eaa-4c4d-ade3-ca01aec3686c
                stepCounter: 8ea642ef-4606-44d0-8121-571a15ba33fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f910fe1b-eb9f-4680-9a03-ca9d9947dcc6
          stepCounter: c8626908-14c1-4ed5-96ba-80b6b15c458e
        config: {}
        dataType: VARCHAR(3)
        description: ""
        hashDetails: null
        name: CURRENCY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40065bd4-ae45-47ab-80cf-912801264d86
                stepCounter: 8ea642ef-4606-44d0-8121-571a15ba33fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7cc83d4-62cc-459c-a2f2-d13320c682d5
          stepCounter: c8626908-14c1-4ed5-96ba-80b6b15c458e
        config: {}
        dataType: DECIMAL(15,6)
        description: ""
        hashDetails: null
        name: UNITS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1440df35-c07f-4376-8fdc-2b53cc851ca4
                stepCounter: 8ea642ef-4606-44d0-8121-571a15ba33fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d3d6475-215d-4eb3-b44f-7884604d737c
          stepCounter: c8626908-14c1-4ed5-96ba-80b6b15c458e
        config: {}
        dataType: DECIMAL(15,2)
        description: ""
        hashDetails: null
        name: COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 985d496c-d3c2-4af1-8b63-f631e3442e8c
                stepCounter: 8ea642ef-4606-44d0-8121-571a15ba33fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a66aac8-a1ae-41d7-b70a-4a7799459690
          stepCounter: c8626908-14c1-4ed5-96ba-80b6b15c458e
        config: {}
        dataType: DECIMAL(15,2)
        description: ""
        hashDetails: null
        name: REGULAR_REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59e82c9a-1338-4ebc-8c83-df1376c9fc66
                stepCounter: 8ea642ef-4606-44d0-8121-571a15ba33fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ee77888-1256-4ae5-b6fc-162143abcd61
          stepCounter: c8626908-14c1-4ed5-96ba-80b6b15c458e
        config: {}
        dataType: DECIMAL(15,2)
        description: ""
        hashDetails: null
        name: SALES_INC_VAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03f5c161-5656-4326-a67b-d37c8c4855f2
                stepCounter: 8ea642ef-4606-44d0-8121-571a15ba33fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a08610ff-849e-4a8f-a5d6-7530b2bef8ef
          stepCounter: c8626908-14c1-4ed5-96ba-80b6b15c458e
        config: {}
        dataType: DECIMAL(15,2)
        description: ""
        hashDetails: null
        name: VAT_REVENUE_AMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79a4f16d-1b1f-4d6f-a069-f1c9cd8cbe56
                stepCounter: 8ea642ef-4606-44d0-8121-571a15ba33fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38e83b1b-caf2-4357-8853-9c1b6ccc7cfc
          stepCounter: c8626908-14c1-4ed5-96ba-80b6b15c458e
        config: {}
        dataType: DECIMAL(15,2)
        description: ""
        hashDetails: null
        name: VAT_TOTAL_COST_AMOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 91e7014c-acb7-4efb-8c05-9ebe66236537
                stepCounter: 8ea642ef-4606-44d0-8121-571a15ba33fa
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bda2b9e0-e24c-4263-a737-a85c77956887
          stepCounter: c8626908-14c1-4ed5-96ba-80b6b15c458e
        config: {}
        dataType: VARCHAR(2)
        description: PAYMENT_METHOD_CODE
        hashDetails: null
        name: PAYMENT_METHOD_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77778ca5-65f6-4f65-98a2-7b353e1e940b
                stepCounter: 8ea642ef-4606-44d0-8121-571a15ba33fa
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VW_TLOG_ZONE: 8ea642ef-4606-44d0-8121-571a15ba33fa
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: VW_TLOG_ZONE
        join:
          joinCondition: |
            FROM {{ ref('STAGE', 'VW_TLOG_ZONE') }} "VW_TLOG_ZONE"
            LEFT JOIN (SELECT "TRANSACTION_ID", "PRODKEY" FROM {{ref_no_link('DATA','FCT_SALES') }} ) "FCT_SALES"
            ON "VW_TLOG_ZONE"."TRANSACTION_ID" = "FCT_SALES"."TRANSACTION_ID"
            AND "VW_TLOG_ZONE"."PRODKEY" = "FCT_SALES"."PRODKEY"
            WHERE "FCT_SALES"."TRANSACTION_ID" IS NULL
        name: VW_STG_FCT_SALES
        noLinkRefs:
          - locationName: DATA
            nodeName: FCT_SALES
  name: VW_STG_FCT_SALES
  overrideSQL: false
  schema: ""
  sqlType: "16"
  type: sql
  version: 1
type: Node
