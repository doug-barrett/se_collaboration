steps:
  TMP_COVERAGE_DATASOURCE-75c78459-e11a-4c3c-8b7f-0ef5ce7da176:
    operation:
      config:
        insertStrategy: UNION
        selectDistinct: false
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: TGT_HL
      materializationType: view
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: f29e0b27-ec15-489d-b08b-cae627c9aa51
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: CONTACT_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 6e6ce21a-6176-421b-a580-a139f41126fa
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: LOGIN_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 3db8745f-51c2-4de8-be3e-3a939bcb096d
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: FULL_NAME
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 921e798b-ce12-4265-bc02-6aa76a7a8541
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COVERAGETEAM_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2c9507e6-2545-48ff-9830-17f864393127
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: LINE_OF_BUSINESS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: d96478f5-ba55-4702-b377-e9b4b03d295a
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: TITLE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 4bad5830-3bab-4e6f-b178-d3d40493066a
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: OFFICE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 3b5624ba-5115-4965-80cb-01ea67c9474b
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: INDUSTRY_UMBRELLA_REPORTING
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: d442f8c8-348e-479b-8f1b-ae9ee42027d4
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: CF_STAFF_INDUSTRY
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: d1084af3-aa72-4df2-b717-e04de0e8c8df
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COVERAGE_LEVEL
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 400d23fc-714b-4b80-be0d-b606a26b1c80
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COMPANY_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: f1a5216c-e18d-4adc-ab9e-6e53d3bec1a9
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: WEBSITE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 4148fe8d-6706-4ccd-920c-c3b4ac41da9a
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COCOVERAGEOFFICER
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 8e63f0ac-107d-4b2b-a117-5b43322f28f8
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: PRIMARY_COVERAGE_OFFICER
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: f339f741-bc2b-43f4-8243-c5d2e594244f
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: OTHER_COVERAGE_OFFICER
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: d3cad8ff-d792-46a2-bdd9-4017fa19ebc8
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COMPANY_RECORDTYPE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: a3ca0155-a100-4ba1-9a92-7adbaa54bf77
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COMPANY_COVERAGE_STATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: a830b3a1-f5b6-44ca-8d59-7ab5caea0ef5
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COVERAGE_TEAM_STATUS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 98dd8177-547c-4bf9-8653-8ad877bc7134
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COMPANY_NAME
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 4a4b30eb-1ba2-48be-a78c-6e4c244265ed
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COMPANY_DESCRIPTION
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: d580ae1d-1084-4584-813a-673cf86d25de
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COMPANY_CITY
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 1de5b607-7862-4b19-95f9-a2db6b09cd0f
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COMPANY_COUNTRY
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: e72bc23d-f9ec-4af3-b929-439b96728d63
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: LOCATION
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 9347264e-7b89-40bf-a709-fe471602c625
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: REGION
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 5083fd2f-34b4-4917-819b-6989987e38ca
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: PARENT_SPONSOR_COMPANY_COMBINED
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 4035d035-cca6-454a-96d7-88371214e0d9
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: FS_COVERAGE_OFFICER
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 350d2748-ce89-492b-9ad8-0774a9620037
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: FS_COVERAGE_OFFICER_COMBINED
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 58cbf757-dd6d-4159-a4df-41a23dfaa325
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SPONSOR_INVESTMENT_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 6414fe80-77b6-40c0-9174-d9e21c7b82b6
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COMPANY_INDUSTRY
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 3a3f5033-2185-4e13-9896-3237c9cdb8ee
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COMPANY_PRIMARY_SECTOR
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 05da72f1-d3eb-4274-8acd-ae3fdc77d7cc
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COMPANY_SECONDARY_SECTOR
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 0a982177-a827-41b9-8232-3cb25ed5c6db
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COMPANY_SECTOR
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 983b9324-9d99-4fce-ac85-b9edb64d3755
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COMPANY_NOTES
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: dc677fa0-999c-4b00-81a6-877a9089fc76
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COMPANY_OWNERSHIP
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 00a015b4-238a-42fa-a9f6-2035608b3f23
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: OWNERSHIP
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: fa2bf3b2-e0af-4370-9d0c-b1b1ff79786e
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COMPANY_REVENUE_MM
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 57f60b38-ca85-4745-b9a5-fe9dbfd06e80
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COMPANY_RECENT_REVENUE_MM
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: f17082bb-1110-447f-ab3b-31870755b61c
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COMPANY_EBITDA_MM
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 266ebbda-750d-46db-b766-3b730ad9a7b3
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COMPANY_RECENT_EBITDA_MM
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 8a103b1a-f973-41be-9a4d-9e8538db6a29
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COMPANY_CURRENCYCODE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 8b5afe06-aaa9-465c-8aca-4cc75c5c0420
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COMPANY_TIER
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 80ae53ac-90d6-4390-bb5e-2f4616338893
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COMPANY_PRIORITY
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 618728d3-e3ef-424d-ac94-f4ac4f72f2f9
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COMPANY_EV_MM
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: ccc138b1-c73d-409e-96c6-a18e25960a38
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COMPANY_RECENT_EV_MM
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: dd143f12-cecf-4b7c-8669-13a53e608d04
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: ARRANGED_BY_R_D__C
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: babb9458-0595-4495-9b90-cc1fd2a86c4c
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: INTRO_CONVERSATION_OCCURRED_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 4e670e8a-ee24-4eb3-a105-5e15bbc3f116
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: INTRO_CALL_BOOKED_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: b50d89e2-f8c3-48bc-913d-7a0cfcf0948f
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(24)
            description: ""
            hashColumns: []
            hashDetails: null
            name: CALLS_BOOKED_VIA_ACE_DEV_TEAM
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 81c2775f-e5cd-44bc-98c4-a2290881fc6d
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: NO_OF_INTROS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 9243f50d-8126-4075-99e9-f398e6430bb5
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: COMPANY_TARGET_TRANSACTION_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 4245f1b3-aed9-43aa-9792-171911e792f0
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: COMPANY_TARGET_ENGAGEMENT_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 1bc59c7f-4bdb-4cec-b351-864b25a09f94
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: NUMBER(18,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: ACTIVITY_WITHIN_7DAYS
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2a98051d-780e-4d4f-94e1-5adc62ea9117
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: NUMBER(18,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: ACTIVITY_WITHIN_30DAYS
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 7a435e95-b138-4b80-a45b-1b0f26a8aa32
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: NUMBER(18,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: ACTIVITY_WITHIN_90DAYS
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: f1f5543a-953f-4ae8-a476-06a6c3a0cb4c
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: NUMBER(18,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: ACTIVITY_WITHIN_180DAYS
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: f17742c8-9708-4f23-9659-8d29fa8dcdda
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: NUMBER(18,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: ACTIVITY_WITHIN_365DAYS
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 1f63b142-d834-4bec-91dc-6223553b5297
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: NUMBER(18,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: FUTURE_ACTIVITY
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: e96fe7c1-61d6-4f4e-b9ff-a6c3c788662f
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: LAST_ACTIVITY
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 58a90603-6f83-4c69-97aa-4b914bd99112
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: LAST_ACTIVITY_SYNOPSIS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 6a0f2d51-72ce-4909-8ff4-0182e3d3f42e
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: LAST_ACTIVITY_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 61359b47-847e-4a0b-8f35-1a1782062a7d
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: CURRENCY_SYMBOL
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 7b37c5d8-805b-43aa-9cff-bc53594f6bd1
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SPONSOR_RANKING
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: df818cd0-9a4f-4737-8097-b31bab2777f2
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: INVESTMENT_CONTACTS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 247db19e-34ed-4b2d-8727-6dd460d006f0
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: CLIENT_CONTACTS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 880ba610-6a10-4326-8cf8-a879f8c3b5eb
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: NEXT_STEPS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: bf773d6f-cc17-4456-82e5-ebc4aa5f0072
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: WINNING_MANDATE_DESC
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 118f870f-c7b8-4e3b-bdf0-1f0b399772da
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: NUMBER(6,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: WINNING_MANDATE_POINTS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 7cdb266a-e3cb-464a-bd40-b8342c3f4e6e
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: NUMBER(1,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: PE_ATTENDED_PLATINUM_EVENT
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 99d37958-5f17-46c4-a2ec-7771157cca9e
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: NUMBER(1,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: MET_WITH_SPONSOR_DEAL_TEAM
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: d8448a75-01a4-4150-937e-a58dc4bf5bd6
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: NUMBER(1,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: MET_MANAGEMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: a620a036-3fc0-4013-86ab-ba611869a650
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: NUMBER(1,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: PRESENTED_AT_CONFERENCE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: bd0fb60d-a7ac-442d-920f-e1dacc0950ea
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: NUMBER(1,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: MARKET_MAPS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 0b214979-a60a-4c1e-bd55-7b9aac6c25fd
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: NUMBER(1,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: DISCUSSED_CAPITAL_MARKETS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: f425c6a9-8f91-4c3d-ac40-ae798c753e5e
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: EV_MM_USD
            nullable: false
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 1e6e0ed8-f942-4790-9dac-0ceed278775e
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: EXPECTED_PRODUCTS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 34696c14-48fe-42eb-82af-845d7a3a9348
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: PRIMARY_SECTOR
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 8f23aefd-7905-4caa-9dfc-a0e1c4ac5e8d
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SECONDARY_SECTOR
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: c696973e-fec1-4f04-b29a-d945920c5474
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: TERTIARY_SECTOR
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 3bdfb5b1-0a47-4153-b9d1-a13d40e072c0
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: NUMBER(38,4)
            description: ""
            hashColumns: []
            hashDetails: null
            name: PROJECTED_FEE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 2d5a6dd7-f77f-4510-9feb-c73fd35a7b1d
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: TIER_ACTIVITY_GOAL_SF
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 46b2636e-acd7-4448-8583-58447f2d8b30
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: OWNERSHIP_SPONSOR
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 4f9ab301-d06e-488f-ae52-2f2730b5c889
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: CAL_PE_OWNERSHIP
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 1516701e-9dc3-47ff-a8f8-df4af5a51c1e
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: EXPECTED_TRANSACTION_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 1bd7bc48-7c32-4462-934e-8bcc7316a378
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_ENG_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 39db656c-368a-4fe7-96ae-73470e1a50bd
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_ENG_NAME
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 28b8a1e8-984b-4138-bdd6-b97b0cd8cdcf
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_ENG_LOB
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 74b43b8d-5e29-424b-a3bc-1440c770fad7
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_ENG_CLIENT
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: ef4aacf0-5edd-413c-93ad-9f39584a1b8f
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_ENG_CLIENT_OWNERSHIP
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 550fe7d7-ac04-4ff8-a0bc-1fb8773cf941
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_ENG_SUBJECT
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: cc210d36-f6ea-44df-b0db-96d6befa65fd
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_ENG_DATE_ENGAGED
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: dacfa13f-d5d1-4f94-b493-3397a46b598d
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_ENG_CLOSE_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 31fc2188-3ee5-4405-900e-e0a0dfc65906
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_ENG_LATEST_STAGE_CHANGE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 36e3ff92-bc94-4c49-b1cd-b39117126d50
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_ENG_ESTIMATED_CLOSE_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 9c3b363d-c41b-47e7-96bc-a6a60dfa6811
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_ENG_STATUS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 3c8ee134-9778-487a-adb0-d4f5fa1a90bd
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_ENG_STAGE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 42b0a01a-6acc-4c03-8d6f-6a1defc99d22
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_ENG_EST_TRANSACTION_SIZE_MM
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 888ed860-e544-4af6-9aeb-033bac88ba33
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: NUMBER(38,6)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_ENG_TOTAL_FEE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 829bac49-37f6-4cbc-9a0f-3970c9ef72eb
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_ENG_JOB_TYPE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 58b76c92-d852-40f6-ab2b-5a4691206797
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: FLOAT
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_ENG_BACKLOG_LOCAL
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: a858a3b5-f710-4e2c-8845-50fa7847ac7a
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_OPP_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: a69b35ec-4b83-4b53-ae01-e2a27df2c5a4
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_OPP_NAME
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: f58cd735-565a-4c62-8d08-9e0bf55244ab
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_OPP_LOB
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: d5721abb-ad3c-4046-b3cc-67975e42bbbc
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_OPP_CLIENT
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 6dfcd56c-c60e-4f9b-9e01-0c740e276d49
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_OPP_CLIENT_OWNERSHIP
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 0959930c-da2a-438c-99e5-d808653dbdd8
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_OPP_SUBJECT
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 37a687b0-6068-48bb-9341-2435b887ee5e
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: TIMESTAMP_TZ(9)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_OPP_CREATE_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: b0b597a6-21af-456c-9d89-32747f1e8a3e
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_OPP_LATEST_STAGE_CHANGE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: a516c1a4-8c1c-4d99-b28d-a7d948c901e8
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_OPP_PITCH_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 65072589-8b0a-4ee1-961e-4ead0b60dd4b
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_OPP_STATUS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 25b0af57-87b2-4f24-ba1f-b8ab9d169410
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_OPP_STAGE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 132b282b-07b3-4b5c-a3b8-8380549d008c
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: BOOLEAN
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_OPP_NBC_APPROVED
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 6101ecf6-b824-4fdd-a073-0178a2dbf3d4
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_OPP_NBC_APPROVED_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 171d9e6e-a65d-473d-8a50-11c554f0aaa6
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: FLOAT
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_OPP_TOTAL_FEE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: eb5e2170-5f60-4a08-95a0-d369fed0e338
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_OPP_MAX_FEE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 46c49f9d-e961-4179-82f0-839061d10a1f
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_OPP_MIN_FEE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 4185fde8-a197-4927-9d7e-dcd0638e843d
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_OPP_JOB_TYPE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 1815bcc2-a099-42f7-a4cd-c79b51539c95
              stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
            dataType: VARCHAR(19)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COV_ENG_FLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases: {}
            customSQL:
              customSQL: |-
                {{ stage('Override Create SQL') }}
                	CREATE OR REPLACE VIEW {{ ref('TGT_HL', 'TMP_COVERAGE_DATASOURCE')}} AS (
                    SELECT DISTINCT 
                        Coverage.CONTACT_ID
                       ,Coverage.LOGIN_ID
                       ,Coverage.FULL_NAME
                       ,Coverage.CoverageTeam_ID
                       ,Coverage.LINE_OF_BUSINESS
                       ,Coverage.TITLE
                       ,Coverage.OFFICE
                       ,Coverage.INDUSTRY_UMBRELLA_REPORTING
                       ,Coverage.CF_STAFF_INDUSTRY
                       ,Coverage.COVERAGE_LEVEL
                       ,Coverage.Company_ID
                       ,Coverage.WEBSITE
                       ,Coverage.CoCoverageOfficer
                       ,Coverage.PRIMARY_COVERAGE_OFFICER
                       ,Coverage.OTHER_COVERAGE_OFFICER
                       ,Coverage.Company_RecordType
                       ,Coverage.COMPANY_COVERAGE_STATUS
                       ,Coverage.COVERAGE_TEAM_STATUS
                       ,Coverage.Company_Name
                       ,Coverage.Company_Description
                       ,Coverage.Company_City
                       ,Coverage.Company_Country
                       ,Coverage.LOCATION
                       ,Coverage.REGION
                       ,Coverage.PARENT_SPONSOR_COMPANY_Combined
                       ,Coverage.FS_Coverage_Officer
                       ,Coverage.FS_Coverage_Officer_Combined
                       ,Coverage.Sponsor_Investment_Date
                       ,Coverage.Company_INDUSTRY
                       ,Coverage.Company_PRIMARY_SECTOR
                       ,Coverage.COMPANY_SECONDARY_SECTOR
                       ,Coverage.Company_SECTOR
                       ,Coverage.Company_Notes
                       ,Coverage.Company_Ownership
                       ,Coverage.OWNERSHIP
                       ,Coverage.Company_Revenue_MM
                       ,Coverage.Company_RECENT_REVENUE_MM
                       ,Coverage.Company_EBITDA_MM
                       ,Coverage.Company_RECENT_EBITDA_MM
                       ,Coverage.Company_CurrencyCode
                       ,Coverage.Company_TIER
                       ,Coverage.Company_PRIORITY
                       ,Coverage.Company_EV_MM
                       ,Coverage.Company_RECENT_EV_MM
                       ,Coverage.ARRANGED_BY_R_D__C
                       ,Coverage.INTRO_CONVERSATION_OCCURRED_DATE
                       ,Coverage.INTRO_CALL_BOOKED_DATE
                       ,Coverage.CALLS_BOOKED_VIA_ACE_DEV_TEAM
                       ,Coverage.NO_OF_INTROS
                       ,Coverage.Company_Target_Transaction_Date
                       ,Coverage.Company_Target_Engagement_Date
                       ,Coverage.ACTIVITY_WITHIN_7DAYS
                       ,Coverage.ACTIVITY_WITHIN_30DAYS
                       ,Coverage.ACTIVITY_WITHIN_90DAYS
                       ,Coverage.ACTIVITY_WITHIN_180DAYS
                       ,Coverage.ACTIVITY_WITHIN_365DAYS
                       ,Coverage.Future_Activity
                       ,Coverage.Last_Activity
                       ,Coverage.Last_Activity_Synopsis
                       ,Coverage.Last_Activity_ID
                       ,Coverage.CURRENCY_SYMBOL
                       ,Coverage.SPONSOR_RANKING
                       ,Coverage.INVESTMENT_CONTACTS
                       ,Coverage.CLIENT_CONTACTS
                       ,Coverage.NEXT_STEPS
                       ,Coverage.WINNING_MANDATE_DESC
                       ,Coverage.WINNING_MANDATE_POINTS
                       ,Coverage.PE_ATTENDED_PLATINUM_EVENT
                       ,Coverage.MET_WITH_SPONSOR_DEAL_TEAM
                       ,Coverage.MET_MANAGEMENT
                       ,Coverage.PRESENTED_AT_CONFERENCE
                       ,Coverage.MARKET_MAPS
                       ,Coverage.DISCUSSED_CAPITAL_MARKETS
                       ,Coverage.EV_MM_USD
                       ,Coverage.EXPECTED_PRODUCTS
                       ,Coverage.PRIMARY_SECTOR
                       ,Coverage.SECONDARY_SECTOR
                       ,Coverage.TERTIARY_SECTOR 
                    ,CASE 
                        WHEN Coverage.EV_MM_USD < 500
                            THEN Coverage.EV_MM_USD * 0.0125
                        WHEN Coverage.EV_MM_USD > 500
                            THEN Coverage.EV_MM_USD * 0.0100
                        ELSE 10
                        END AS PROJECTED_FEE
                    ,CASE 
                        WHEN UPPER(Coverage.Company_TIER) = 'A'
                            AND UPPER(Coverage.COVERAGE_TEAM_STATUS) = UPPER('Active')
                            THEN CASE 
                                    WHEN (
                                            Coverage.ACTIVITY_WITHIN_90DAYS >= 1
                                            OR Coverage.Future_Activity > 0
                                            )
                                        THEN 'Y'
                                    ELSE 'N'
                                    END
                        WHEN Coverage.Company_TIER = 'B'
                            AND UPPER(Coverage.COVERAGE_TEAM_STATUS) = UPPER('Active')
                            THEN CASE 
                                    WHEN (
                                            Coverage.ACTIVITY_WITHIN_180DAYS >= 1
                                            OR Coverage.Future_Activity > 0
                                            )
                                        THEN 'Y'
                                    ELSE 'N'
                                    END
                        ELSE CASE 
                                WHEN UPPER(Coverage.Company_TIER) = 'C'
                                    AND UPPER(COVERAGE_TEAM_STATUS) = UPPER('Active')
                                    THEN CASE 
                                            WHEN (
                                                    ACTIVITY_WITHIN_365DAYS >= 1
                                                    OR Future_Activity > 0
                                                    )
                                                THEN 'Y'
                                            ELSE 'N'
                                            END
                                ELSE 'N'
                                END
                        END AS TIER_ACTIVITY_GOAL_SF
                    ,CASE 
                        WHEN 
                            TRIM(PARENT_SPONSOR_COMPANY_Combined) IS NOT NULL
                            AND TRIM(PARENT_SPONSOR_COMPANY_Combined) <> ''
                            THEN PARENT_SPONSOR_COMPANY_Combined
                        ELSE Ownership
                        END AS OWNERSHIP_SPONSOR
                    ,CASE 
                        WHEN (
                                UPPER(Company_Ownership) LIKE '%PE%'
                                OR FS_Coverage_Officer_Combined <> ''
                                ) 
                            THEN 'PE-owned'
                        WHEN UPPER(Company_Ownership) = UPPER('Public')
                            THEN Company_Ownership
                        WHEN UPPER(Company_Ownership) = UPPER('Private')
                            THEN Company_Ownership
                        ELSE '(Blank)'
                        END AS CAL_PE_OWNERSHIP
                    ,CASE 
                        WHEN Company_Target_Transaction_Date IS NULL
                            THEN DATEADD(YEAR, 5, CASE 
                                        WHEN Sponsor_Investment_Date <> '' 
                                            THEN CAST(REPLACE(Sponsor_Investment_Date, '/', '/01/') AS DATE)
                                        END)
                        ELSE Company_Target_Transaction_Date
                        END AS EXPECTED_TRANSACTION_DATE
                    ,Engagement.FULL_ENGAGEMENT_ID_C AS COV_Eng_ID
                    ,Engagement.NAME AS COV_Eng_NAME
                    ,Engagement.LINE_OF_BUSINESS_C AS COV_Eng_LOB
                    ,Engagement.CLIENT_C AS COV_Eng_Client
                    ,Engagement.CLIENT_OWNERSHIP_C AS COV_Eng_CLIENT_OWNERSHIP
                    ,Engagement.SUBJECT_C AS COV_Eng_Subject
                    ,Engagement.DATE_ENGAGED_C AS COV_Eng_DATE_ENGAGED
                    ,Engagement.CLOSE_DATE_C AS COV_Eng_CLOSE_DATE
                    ,Engagement.LATEST_STAGE_CHANGE_C AS COV_Eng_LATEST_STAGE_CHANGE
                    ,Engagement.ESTIMATED_CLOSE_DATE_C AS COV_Eng_ESTIMATED_CLOSE_DATE
                    ,Engagement.STATUS_C AS COV_Eng_Status
                    ,Engagement.STAGE_C AS COV_Eng_Stage
                    ,Engagement.EST_TRANSACTION_SIZE_MM_C AS COV_Eng_EST_TRANSACTION_SIZE_MM
                    ,Engagement.TOTAL_FEE_C AS COV_Eng_TOTAL_FEE
                    ,CASE 
                        WHEN UPPER(Engagement.JOB_TYPE_C) LIKE UPPER('%advisory%')
                            THEN 'Advisory'
                        WHEN UPPER(Engagement.JOB_TYPE_C) LIKE UPPER('%capital market%')
                            THEN 'CM'
                        WHEN UPPER(Engagement.JOB_TYPE_C) LIKE UPPER('%Synd%Fin%')
                            THEN 'Syn.Fin'
                        WHEN UPPER(Engagement.JOB_TYPE_C) LIKE UPPER('%Creditor Advisors%')
                            THEN 'Creditor Adv.'
                        ELSE Engagement.JOB_TYPE_C
                        END AS COV_Eng_JOB_TYPE
                    ,Engagement.BACKLOG_LOCAL_C AS COV_ENG_BACKLOG_LOCAL
                    ,Opportunity.FULL_OPPORTUNITY_ID_C AS COV_Opp_ID
                    ,Opportunity.NAME AS COV_OPP_NAME
                    ,Opportunity.LINE_OF_BUSINESS_C AS COV_Opp_LOB
                    ,Opportunity.CLIENT_C AS COV_Opp_Client
                    ,Opportunity.CLIENT_OWNERSHIP_C AS COV_Opp_CLIENT_OWNERSHIP
                    ,Opportunity.SUBJECT_C AS COV_Opp_Subject
                    ,Opportunity.CREATED_DATE AS COV_Opp_Create_date
                    ,Opportunity.LATEST_STAGE_CHANGE_C AS COV_Opp_LATEST_STAGE_CHANGE
                    ,Opportunity.PITCH_DATE_C AS COV_Opp_Pitch_Date
                    ,Opportunity.STATUS_C AS COV_Opp_Status
                    ,Opportunity.STAGE_C AS COV_Opp_Stage
                    ,Opportunity.NBC_APPROVED__C AS COV_Opp_NBC_Approved
                    ,Opportunity.NBC_Approved_Date AS COV_Opp_NBC_Approved_Date
                    ,Opportunity.TOTAL_FEE AS COV_Opp_TOTAL_FEE
                    ,Opportunity.MAX_FEE_M AS COV_Opp_Max_Fee
                    ,Opportunity.MIN_FEE_M AS COV_Opp_Min_Fee
                    ,CASE 
                        WHEN UPPER(Opportunity.JOB_TYPE_C) LIKE UPPER('%advisory%')
                            THEN 'Advisory'
                        WHEN UPPER(Opportunity.JOB_TYPE_C) LIKE UPPER('%capital market%')
                            THEN 'CM'
                        WHEN UPPER(Opportunity.JOB_TYPE_C) LIKE UPPER('%Synd%Fin%')
                            THEN 'Syn.Fin'
                        WHEN UPPER(Opportunity.JOB_TYPE_C) LIKE UPPER('%Creditor Advisors%')
                            THEN 'Creditor Adv.'
                        ELSE Opportunity.JOB_TYPE_C
                        END AS COV_Opp_JOB_TYPE
                    ,CASE 
                        WHEN EIT.ENGAGEMENT_NUMBER_C IS NOT NULL
                            THEN 'Staffed on Deal'
                        ELSE 'Not Staffed on Deal'
                        END AS COV_ENG_FLAG 
                    FROM {{ref('TGT_HL','TMP_COVERAGE_TEMP')}} AS Coverage 
                    LEFT JOIN (
                        SELECT SUBJECT_C
                            ,ENGAGEMENT_NUMBER_C
                            ,FULL_ENGAGEMENT_ID_C
                            ,NAME
                            ,LINE_OF_BUSINESS_C
                            ,CLIENT_C
                            ,CLIENT_OWNERSHIP_C
                            ,DATE_ENGAGED_C
                            ,CLOSE_DATE_C
                            ,LATEST_STAGE_CHANGE_C
                            ,ESTIMATED_CLOSE_DATE_C
                            ,STATUS_C
                            ,STAGE_C
                            ,EST_TRANSACTION_SIZE_MM_C
                            ,TOTAL_FEE_C / 1000000 AS TOTAL_FEE_C
                            ,JOB_TYPE_C
                            ,BACKLOG_LOCAL_C
                        FROM {{ref('TGT_HL','VW_ENGAGEMENT_C')}} ENGAGEMENT__C 
                        WHERE UPPER(ENGAGEMENT__C.LINE_OF_BUSINESS_C) IN ('CF','FR')
                        AND UPPER(ifnull(ENGAGEMENT__C.DND_STATUS_C, '')) <> UPPER('Approved')
                    ) Engagement ON (
                        Coverage.Company_ID = Engagement.CLIENT_C
                        OR Coverage.Company_ID = Engagement.SUBJECT_C
                        ) 
                    LEFT JOIN {{ref('TGT_HL','VW_ENGAGEMENT_INTERNAL_TEAM_C')}} AS EIT ON Engagement.ENGAGEMENT_NUMBER_C = EIT.ENGAGEMENT_NUMBER_C
                    AND Coverage.CONTACT_ID = EIT.CONTACT_C 
                    LEFT JOIN (
                        SELECT FULL_OPPORTUNITY_ID_C
                            ,OPPORTUNITY__C.NAME
                            ,LINE_OF_BUSINESS_C
                            ,CLIENT_C
                            ,OPPORTUNITY__C.CLIENT_OWNERSHIP_C
                            ,SUBJECT_C
                            ,OPPORTUNITY__C.CREATED_DATE
                            ,LATEST_STAGE_CHANGE_C
                            ,OPPORTUNITY__C.PITCH_DATE_C
                            ,OPPORTUNITY__C.STATUS_C
                            ,STAGE_C
                            ,OPPORTUNITY_APPROVAL__C.APPROVED_C AS NBC_APPROVED__C
                            ,OPPORTUNITY_APPROVAL__C.DATE_GRADED_C AS NBC_Approved_Date
                            ,(TOTAL_ESTIMATED_FEE_C * EXCHANGE_RATE.RATE_TO_USD_C) / 1000000 AS TOTAL_FEE
                            ,MAX_FEE_M_C AS MAX_FEE_M
                            ,MIN_FEE_M_C AS MIN_FEE_M
                            ,OPPORTUNITY__C.JOB_TYPE_C
                        FROM {{ref('TGT_HL','VW_OPPORTUNITY_C')}} AS OPPORTUNITY__C 
                        LEFT JOIN {{ref('TGT_HL','VW_OPPORTUNITY_APPROVAL_C')}} AS OPPORTUNITY_APPROVAL__C 
                            ON OPPORTUNITY__C.OPPORTUNITY_NUMBER_C = OPPORTUNITY_APPROVAL__C.OPPORTUNITY_NUMBER_C
                        INNER JOIN (SELECT '' ID, '' DEVELOPER_NAME) RECORDTYPE ON OPPORTUNITY__C.RECORD_TYPE_ID = RECORDTYPE.ID
                            AND UPPER(RECORDTYPE.DEVELOPER_NAME) IN (
                                'CF'
                                ,'FR'
                                ,'FAS'
                                )
                        INNER JOIN {{ref('TGT_HL','VW_EXCHANGE_RATE_C')}} AS EXCHANGE_RATE  
                            ON OPPORTUNITY__C.CURRENCY_ISO_CODE = EXCHANGE_RATE.CURRENCY_ISO_CODE
                        WHERE DATEDIFF(YEAR, OPPORTUNITY__C.CREATED_DATE, GETDATE()) <= 5 
                            AND UPPER(OPPORTUNITY__C.LINE_OF_BUSINESS_C) IN (
                                'CF'
                                ,'FR'
                                )
                    ) Opportunity ON (
                        Coverage.Company_ID = Opportunity.CLIENT_C
                        OR Coverage.Company_ID = Opportunity.SUBJECT_C
                        )
                    )
            dependencies:
              - locationName: TGT_HL
                nodeName: TMP_COVERAGE_TEMP
              - locationName: TGT_HL
                nodeName: VW_ENGAGEMENT_C
              - locationName: TGT_HL
                nodeName: VW_ENGAGEMENT_INTERNAL_TEAM_C
              - locationName: TGT_HL
                nodeName: VW_EXCHANGE_RATE_C
              - locationName: TGT_HL
                nodeName: VW_OPPORTUNITY_APPROVAL_C
              - locationName: TGT_HL
                nodeName: VW_OPPORTUNITY_C
            join:
              joinCondition: |2-
                    SELECT DISTINCT 
                        Coverage.CONTACT_ID
                       ,Coverage.LOGIN_ID
                       ,Coverage.FULL_NAME
                       ,Coverage.CoverageTeam_ID
                       ,Coverage.LINE_OF_BUSINESS
                       ,Coverage.TITLE
                       ,Coverage.OFFICE
                       ,Coverage.INDUSTRY_UMBRELLA_REPORTING
                       ,Coverage.CF_STAFF_INDUSTRY
                       ,Coverage.COVERAGE_LEVEL
                       ,Coverage.Company_ID
                       ,Coverage.WEBSITE
                       ,Coverage.CoCoverageOfficer
                       ,Coverage.PRIMARY_COVERAGE_OFFICER
                       ,Coverage.OTHER_COVERAGE_OFFICER
                       ,Coverage.Company_RecordType
                       ,Coverage.COMPANY_COVERAGE_STATUS
                       ,Coverage.COVERAGE_TEAM_STATUS
                       ,Coverage.Company_Name
                       ,Coverage.Company_Description
                       ,Coverage.Company_City
                       ,Coverage.Company_Country
                       ,Coverage.LOCATION
                       ,Coverage.REGION
                       ,Coverage.PARENT_SPONSOR_COMPANY_Combined
                       ,Coverage.FS_Coverage_Officer
                       ,Coverage.FS_Coverage_Officer_Combined
                       ,Coverage.Sponsor_Investment_Date
                       ,Coverage.Company_INDUSTRY
                       ,Coverage.Company_PRIMARY_SECTOR
                       ,Coverage.COMPANY_SECONDARY_SECTOR
                       ,Coverage.Company_SECTOR
                       ,Coverage.Company_Notes
                       ,Coverage.Company_Ownership
                       ,Coverage.OWNERSHIP
                       ,Coverage.Company_Revenue_MM
                       ,Coverage.Company_RECENT_REVENUE_MM
                       ,Coverage.Company_EBITDA_MM
                       ,Coverage.Company_RECENT_EBITDA_MM
                       ,Coverage.Company_CurrencyCode
                       ,Coverage.Company_TIER
                       ,Coverage.Company_PRIORITY
                       ,Coverage.Company_EV_MM
                       ,Coverage.Company_RECENT_EV_MM
                       ,Coverage.ARRANGED_BY_R_D__C
                       ,Coverage.INTRO_CONVERSATION_OCCURRED_DATE
                       ,Coverage.INTRO_CALL_BOOKED_DATE
                       ,Coverage.CALLS_BOOKED_VIA_ACE_DEV_TEAM
                       ,Coverage.NO_OF_INTROS
                       ,Coverage.Company_Target_Transaction_Date
                       ,Coverage.Company_Target_Engagement_Date
                       ,Coverage.ACTIVITY_WITHIN_7DAYS
                       ,Coverage.ACTIVITY_WITHIN_30DAYS
                       ,Coverage.ACTIVITY_WITHIN_90DAYS
                       ,Coverage.ACTIVITY_WITHIN_180DAYS
                       ,Coverage.ACTIVITY_WITHIN_365DAYS
                       ,Coverage.Future_Activity
                       ,Coverage.Last_Activity
                       ,Coverage.Last_Activity_Synopsis
                       ,Coverage.Last_Activity_ID
                       ,Coverage.CURRENCY_SYMBOL
                       ,Coverage.SPONSOR_RANKING
                       ,Coverage.INVESTMENT_CONTACTS
                       ,Coverage.CLIENT_CONTACTS
                       ,Coverage.NEXT_STEPS
                       ,Coverage.WINNING_MANDATE_DESC
                       ,Coverage.WINNING_MANDATE_POINTS
                       ,Coverage.PE_ATTENDED_PLATINUM_EVENT
                       ,Coverage.MET_WITH_SPONSOR_DEAL_TEAM
                       ,Coverage.MET_MANAGEMENT
                       ,Coverage.PRESENTED_AT_CONFERENCE
                       ,Coverage.MARKET_MAPS
                       ,Coverage.DISCUSSED_CAPITAL_MARKETS
                       ,Coverage.EV_MM_USD
                       ,Coverage.EXPECTED_PRODUCTS
                       ,Coverage.PRIMARY_SECTOR
                       ,Coverage.SECONDARY_SECTOR
                       ,Coverage.TERTIARY_SECTOR 
                    ,CASE 
                        WHEN Coverage.EV_MM_USD < 500
                            THEN Coverage.EV_MM_USD * 0.0125
                        WHEN Coverage.EV_MM_USD > 500
                            THEN Coverage.EV_MM_USD * 0.0100
                        ELSE 10
                        END AS PROJECTED_FEE
                    ,CASE 
                        WHEN UPPER(Coverage.Company_TIER) = 'A'
                            AND UPPER(Coverage.COVERAGE_TEAM_STATUS) = UPPER('Active')
                            THEN CASE 
                                    WHEN (
                                            Coverage.ACTIVITY_WITHIN_90DAYS >= 1
                                            OR Coverage.Future_Activity > 0
                                            )
                                        THEN 'Y'
                                    ELSE 'N'
                                    END
                        WHEN Coverage.Company_TIER = 'B'
                            AND UPPER(Coverage.COVERAGE_TEAM_STATUS) = UPPER('Active')
                            THEN CASE 
                                    WHEN (
                                            Coverage.ACTIVITY_WITHIN_180DAYS >= 1
                                            OR Coverage.Future_Activity > 0
                                            )
                                        THEN 'Y'
                                    ELSE 'N'
                                    END
                        ELSE CASE 
                                WHEN UPPER(Coverage.Company_TIER) = 'C'
                                    AND UPPER(COVERAGE_TEAM_STATUS) = UPPER('Active')
                                    THEN CASE 
                                            WHEN (
                                                    ACTIVITY_WITHIN_365DAYS >= 1
                                                    OR Future_Activity > 0
                                                    )
                                                THEN 'Y'
                                            ELSE 'N'
                                            END
                                ELSE 'N'
                                END
                        END AS TIER_ACTIVITY_GOAL_SF
                    ,CASE 
                        WHEN 
                            TRIM(PARENT_SPONSOR_COMPANY_Combined) IS NOT NULL
                            AND TRIM(PARENT_SPONSOR_COMPANY_Combined) <> ''
                            THEN PARENT_SPONSOR_COMPANY_Combined
                        ELSE Ownership
                        END AS OWNERSHIP_SPONSOR
                    ,CASE 
                        WHEN (
                                UPPER(Company_Ownership) LIKE '%PE%'
                                OR FS_Coverage_Officer_Combined <> ''
                                ) 
                            THEN 'PE-owned'
                        WHEN UPPER(Company_Ownership) = UPPER('Public')
                            THEN Company_Ownership
                        WHEN UPPER(Company_Ownership) = UPPER('Private')
                            THEN Company_Ownership
                        ELSE '(Blank)'
                        END AS CAL_PE_OWNERSHIP
                    ,CASE 
                        WHEN Company_Target_Transaction_Date IS NULL
                            THEN DATEADD(YEAR, 5, CASE 
                                        WHEN Sponsor_Investment_Date <> '' 
                                            THEN CAST(REPLACE(Sponsor_Investment_Date, '/', '/01/') AS DATE)
                                        END)
                        ELSE Company_Target_Transaction_Date
                        END AS EXPECTED_TRANSACTION_DATE
                    ,Engagement.FULL_ENGAGEMENT_ID_C AS COV_Eng_ID
                    ,Engagement.NAME AS COV_Eng_NAME
                    ,Engagement.LINE_OF_BUSINESS_C AS COV_Eng_LOB
                    ,Engagement.CLIENT_C AS COV_Eng_Client
                    ,Engagement.CLIENT_OWNERSHIP_C AS COV_Eng_CLIENT_OWNERSHIP
                    ,Engagement.SUBJECT_C AS COV_Eng_Subject
                    ,Engagement.DATE_ENGAGED_C AS COV_Eng_DATE_ENGAGED
                    ,Engagement.CLOSE_DATE_C AS COV_Eng_CLOSE_DATE
                    ,Engagement.LATEST_STAGE_CHANGE_C AS COV_Eng_LATEST_STAGE_CHANGE
                    ,Engagement.ESTIMATED_CLOSE_DATE_C AS COV_Eng_ESTIMATED_CLOSE_DATE
                    ,Engagement.STATUS_C AS COV_Eng_Status
                    ,Engagement.STAGE_C AS COV_Eng_Stage
                    ,Engagement.EST_TRANSACTION_SIZE_MM_C AS COV_Eng_EST_TRANSACTION_SIZE_MM
                    ,Engagement.TOTAL_FEE_C AS COV_Eng_TOTAL_FEE
                    ,CASE 
                        WHEN UPPER(Engagement.JOB_TYPE_C) LIKE UPPER('%advisory%')
                            THEN 'Advisory'
                        WHEN UPPER(Engagement.JOB_TYPE_C) LIKE UPPER('%capital market%')
                            THEN 'CM'
                        WHEN UPPER(Engagement.JOB_TYPE_C) LIKE UPPER('%Synd%Fin%')
                            THEN 'Syn.Fin'
                        WHEN UPPER(Engagement.JOB_TYPE_C) LIKE UPPER('%Creditor Advisors%')
                            THEN 'Creditor Adv.'
                        ELSE Engagement.JOB_TYPE_C
                        END AS COV_Eng_JOB_TYPE
                    ,Engagement.BACKLOG_LOCAL_C AS COV_ENG_BACKLOG_LOCAL
                    ,Opportunity.FULL_OPPORTUNITY_ID_C AS COV_Opp_ID
                    ,Opportunity.NAME AS COV_OPP_NAME
                    ,Opportunity.LINE_OF_BUSINESS_C AS COV_Opp_LOB
                    ,Opportunity.CLIENT_C AS COV_Opp_Client
                    ,Opportunity.CLIENT_OWNERSHIP_C AS COV_Opp_CLIENT_OWNERSHIP
                    ,Opportunity.SUBJECT_C AS COV_Opp_Subject
                    ,Opportunity.CREATED_DATE AS COV_Opp_Create_date
                    ,Opportunity.LATEST_STAGE_CHANGE_C AS COV_Opp_LATEST_STAGE_CHANGE
                    ,Opportunity.PITCH_DATE_C AS COV_Opp_Pitch_Date
                    ,Opportunity.STATUS_C AS COV_Opp_Status
                    ,Opportunity.STAGE_C AS COV_Opp_Stage
                    ,Opportunity.NBC_APPROVED__C AS COV_Opp_NBC_Approved
                    ,Opportunity.NBC_Approved_Date AS COV_Opp_NBC_Approved_Date
                    ,Opportunity.TOTAL_FEE AS COV_Opp_TOTAL_FEE
                    ,Opportunity.MAX_FEE_M AS COV_Opp_Max_Fee
                    ,Opportunity.MIN_FEE_M AS COV_Opp_Min_Fee
                    ,CASE 
                        WHEN UPPER(Opportunity.JOB_TYPE_C) LIKE UPPER('%advisory%')
                            THEN 'Advisory'
                        WHEN UPPER(Opportunity.JOB_TYPE_C) LIKE UPPER('%capital market%')
                            THEN 'CM'
                        WHEN UPPER(Opportunity.JOB_TYPE_C) LIKE UPPER('%Synd%Fin%')
                            THEN 'Syn.Fin'
                        WHEN UPPER(Opportunity.JOB_TYPE_C) LIKE UPPER('%Creditor Advisors%')
                            THEN 'Creditor Adv.'
                        ELSE Opportunity.JOB_TYPE_C
                        END AS COV_Opp_JOB_TYPE
                    ,CASE 
                        WHEN EIT.ENGAGEMENT_NUMBER_C IS NOT NULL
                            THEN 'Staffed on Deal'
                        ELSE 'Not Staffed on Deal'
                        END AS COV_ENG_FLAG 
                    FROM {{ref('TGT_HL','TMP_COVERAGE_TEMP')}} AS Coverage 
                    LEFT JOIN (
                        SELECT SUBJECT_C
                            ,ENGAGEMENT_NUMBER_C
                            ,FULL_ENGAGEMENT_ID_C
                            ,NAME
                            ,LINE_OF_BUSINESS_C
                            ,CLIENT_C
                            ,CLIENT_OWNERSHIP_C
                            ,DATE_ENGAGED_C
                            ,CLOSE_DATE_C
                            ,LATEST_STAGE_CHANGE_C
                            ,ESTIMATED_CLOSE_DATE_C
                            ,STATUS_C
                            ,STAGE_C
                            ,EST_TRANSACTION_SIZE_MM_C
                            ,TOTAL_FEE_C / 1000000 AS TOTAL_FEE_C
                            ,JOB_TYPE_C
                            ,BACKLOG_LOCAL_C
                        FROM {{ref('TGT_HL','VW_ENGAGEMENT_C')}} ENGAGEMENT__C 
                        WHERE UPPER(ENGAGEMENT__C.LINE_OF_BUSINESS_C) IN ('CF','FR')
                        AND UPPER(ifnull(ENGAGEMENT__C.DND_STATUS_C, '')) <> UPPER('Approved')
                    ) Engagement ON (
                        Coverage.Company_ID = Engagement.CLIENT_C
                        OR Coverage.Company_ID = Engagement.SUBJECT_C
                        ) 
                    LEFT JOIN {{ref('TGT_HL','VW_ENGAGEMENT_INTERNAL_TEAM_C')}} AS EIT ON Engagement.ENGAGEMENT_NUMBER_C = EIT.ENGAGEMENT_NUMBER_C
                    AND Coverage.CONTACT_ID = EIT.CONTACT_C 
                    LEFT JOIN (
                        SELECT FULL_OPPORTUNITY_ID_C
                            ,OPPORTUNITY__C.NAME
                            ,LINE_OF_BUSINESS_C
                            ,CLIENT_C
                            ,OPPORTUNITY__C.CLIENT_OWNERSHIP_C
                            ,SUBJECT_C
                            ,OPPORTUNITY__C.CREATED_DATE
                            ,LATEST_STAGE_CHANGE_C
                            ,OPPORTUNITY__C.PITCH_DATE_C
                            ,OPPORTUNITY__C.STATUS_C
                            ,STAGE_C
                            ,OPPORTUNITY_APPROVAL__C.APPROVED_C AS NBC_APPROVED__C
                            ,OPPORTUNITY_APPROVAL__C.DATE_GRADED_C AS NBC_Approved_Date
                            ,(TOTAL_ESTIMATED_FEE_C * EXCHANGE_RATE.RATE_TO_USD_C) / 1000000 AS TOTAL_FEE
                            ,MAX_FEE_M_C AS MAX_FEE_M
                            ,MIN_FEE_M_C AS MIN_FEE_M
                            ,OPPORTUNITY__C.JOB_TYPE_C
                        FROM {{ref('TGT_HL','VW_OPPORTUNITY_C')}} AS OPPORTUNITY__C 
                        LEFT JOIN {{ref('TGT_HL','VW_OPPORTUNITY_APPROVAL_C')}} AS OPPORTUNITY_APPROVAL__C 
                            ON OPPORTUNITY__C.OPPORTUNITY_NUMBER_C = OPPORTUNITY_APPROVAL__C.OPPORTUNITY_NUMBER_C
                        INNER JOIN (SELECT '' ID, '' DEVELOPER_NAME) RECORDTYPE ON OPPORTUNITY__C.RECORD_TYPE_ID = RECORDTYPE.ID
                            AND UPPER(RECORDTYPE.DEVELOPER_NAME) IN (
                                'CF'
                                ,'FR'
                                ,'FAS'
                                )
                        INNER JOIN {{ref('TGT_HL','VW_EXCHANGE_RATE_C')}} AS EXCHANGE_RATE  
                            ON OPPORTUNITY__C.CURRENCY_ISO_CODE = EXCHANGE_RATE.CURRENCY_ISO_CODE
                        WHERE DATEDIFF(YEAR, OPPORTUNITY__C.CREATED_DATE, GETDATE()) <= 5 
                            AND UPPER(OPPORTUNITY__C.LINE_OF_BUSINESS_C) IN (
                                'CF'
                                ,'FR'
                                )
                    ) Opportunity ON (
                        Coverage.Company_ID = Opportunity.CLIENT_C
                        OR Coverage.Company_ID = Opportunity.SUBJECT_C
                        )
                    
            name: TMP_COVERAGE_DATASOURCE
            noLinkRefs: []
      name: TMP_COVERAGE_DATASOURCE
      overrideSQL: true
      schema: ""
      sqlType: "154"
      type: sql
    stepCounter: 75c78459-e11a-4c3c-8b7f-0ef5ce7da176
