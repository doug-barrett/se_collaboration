steps:
  TMP_ASC_REPORTING_2-f6e3e123-6e6e-4551-a020-914e129774fc:
    operation:
      config:
        insertStrategy: UNION
        selectDistinct: false
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: TGT_HL
      materializationType: view
      metadata:
        appliedNodeTests: []
        columns:
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: b7c8516d-1e93-4c1c-8076-162933eb9501
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: CONTACT_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: cdd0c961-9ff5-46d2-8ccb-259c16275676
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: LOGIN_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: ca758d52-f15e-4f79-b79b-0753cd349a49
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: FULL_NAME
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 99212010-d849-41d9-8b6c-a5d0fa3bb4cd
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: LINE_OF_BUSINESS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 426a4b74-4ee5-475e-bf26-9eec66803bb0
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: TITLE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: c97f73a2-14a9-4d41-942f-0288640bdc08
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: OFFICE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 875d0fad-b882-4b36-857e-3a10e047ec9f
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: INDUSTRY_UMBRELLA_REPORTING
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 85402344-889b-4485-b937-3d2a059824eb
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: CF_STAFF_INDUSTRY
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 22b7b503-e2f4-4761-8567-54d203cf7120
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: ENGAGEMENT_NUMBER
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: fb9cd5d8-16a4-4109-b9d9-38129ad4eaf4
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: ENGAGEMENT_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: bb92b4ab-8953-4f39-b373-78b0699ada7e
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: ENG_NAME
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 370b9c33-fdb1-45f1-819a-1f3128035c43
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: ENG_LINE_OF_BUSINESS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 827eaac0-58f4-4d65-b5a4-9b2295f701be
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: ENG_CLIENT_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 79001004-4731-4340-a039-1ddfeb49fc22
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: ENG_CLIENT_NAME
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: a3533342-52a8-4899-861b-d9b036d8da49
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: ENG_SUBJECT_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 62a6c0f3-c452-4b54-92ad-494d50db2e49
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: ENG_SUBJECT_NAME
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: e56047b8-68b1-4ecd-97cc-73ec3f6cfb8c
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: DATE
            defaultValue: ""
            description: ""
            name: ENG_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 6349d1de-9eb3-41c0-828d-7692e1dd41da
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: ENG_CF_JOB_TYPE2
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 838ff2c4-95ec-4e66-8036-3aa8baf0adaf
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: ENG_STATUS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: f3763170-8373-45c5-8dcd-7db65b39a1ee
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: ENG_STAGE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 4943aaf2-7720-4e80-9e14-e8e212cf4890
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: DATE
            defaultValue: ""
            description: ""
            name: ENG_CLOSE_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: b658fe1e-d215-4548-ab1e-2d1259005a87
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: ENG_CURRENCY
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 15178ee0-705f-4f9f-8375-da2f589c1f99
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: NUMBER(38,0)
            defaultValue: ""
            description: ""
            name: ENG_TRANSACTION_SIZE_MM_USD
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: ffaa2d11-86d5-4be0-a0c0-6f8a7ec4821e
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: FLOAT
            defaultValue: ""
            description: ""
            name: ENG_TOTAL_FEE_MUSD
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 7b2263b1-0f4d-4909-84c8-76744623acb5
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: DATE
            defaultValue: ""
            description: ""
            name: ENG_ESTIMATED_CLOSE_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: f6bb4b42-848e-42fb-9007-cb98da6c07d8
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: ENG_STAFF_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 8c2f1744-72b5-4730-85e8-7aaa60f1703b
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: ENG_FS_COVERAGE_OFFICER_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 83459964-7e19-4037-8c2b-803f4c732a95
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: ENG_FS_COVERAGE_OFFICER_NAME
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: a07f7992-5ef8-4d32-a339-d3db412e1699
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: ENG_COMPANY_TIER
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 39ac18ef-9b4c-41bf-9f29-07ab5ba65951
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(19)
            defaultValue: ""
            description: ""
            name: ENG_FLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 650f50d8-feaf-43ed-9f92-c2cd230a120f
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: DATE
            defaultValue: ""
            description: ""
            name: CAL_ENG_CLOSE_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 316b12d4-beed-4b2d-b69b-3b65d72b3231
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: ENG_CLIENT
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: fe1f126a-06eb-4294-ab38-e807470d20f5
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(45)
            defaultValue: ""
            description: ""
            name: SF_URL
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 2ffe6c72-bcc1-4fc0-afc5-b9d7cfdab296
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: DATE
            defaultValue: ""
            description: ""
            name: PROCESS_START_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: aa7cb0c0-f0ca-486a-9d10-327a623c659c
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: DATE
            defaultValue: ""
            description: ""
            name: PROCESS_END_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 77ccb3b3-8bde-4f49-be70-7d29ed0c1ee3
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(16777216)
            defaultValue: ""
            description: ""
            name: DND_STATUS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: ff201fea-34e3-4d50-80eb-286a0f61ae34
              stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
            config: {}
            dataType: VARCHAR(1)
            defaultValue: ""
            description: ""
            name: FIG_FLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
            transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases: {}
            customSQL:
              customSQL: |-
                {{ stage('Override Create SQL') }}
                	CREATE OR REPLACE VIEW {{ ref('TGT_HL', 'TMP_ASC_REPORTING_2')}} AS (
                   SELECT 
                    COVERAGE_DATASOURCE.CONTACT_ID
                    ,COVERAGE_DATASOURCE.LOGIN_ID
                    ,COVERAGE_DATASOURCE.FULL_NAME
                    ,COVERAGE_DATASOURCE.LINE_OF_BUSINESS
                    ,COVERAGE_DATASOURCE.TITLE
                    ,COVERAGE_DATASOURCE.OFFICE
                    ,COVERAGE_DATASOURCE.INDUSTRY_UMBRELLA_REPORTING
                    ,COVERAGE_DATASOURCE.CF_STAFF_INDUSTRY
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN CONCAT (
                                    OPPORTUNITY.Opportunity_NUMBER
                                    ,'(VE)'
                                    )
                        ELSE ENGAGEMENT.ENGAGEMENT_NUMBER
                        END AS ENGAGEMENT_NUMBER
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_ID
                        ELSE ENGAGEMENT.ENGAGEMENT_ID
                        END AS ENGAGEMENT_ID
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_NAME
                        ELSE ENGAGEMENT.ENG_NAME
                        END AS ENG_NAME
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_LINE_OF_BUSINESS
                        ELSE ENGAGEMENT.ENG_LINE_OF_BUSINESS
                        END AS ENG_LINE_OF_BUSINESS
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_Client_ID
                        ELSE ENGAGEMENT.ENG_Client_ID
                        END AS ENG_Client_ID
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_Client_Name
                        ELSE ENGAGEMENT.ENG_Client_Name
                        END AS ENG_Client_Name
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_Subject_ID
                        ELSE ENGAGEMENT.ENG_Subject_ID
                        END AS ENG_Subject_ID
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_Subject_Name
                        ELSE ENGAGEMENT.ENG_Subject_Name
                        END AS ENG_Subject_Name
                    ,ENGAGEMENT.ENG_Date
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_CF_Job_Type2
                        ELSE ENGAGEMENT.ENG_CF_Job_Type2
                        END AS ENG_CF_Job_Type2
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_STATUS
                        ELSE ENGAGEMENT.ENG_STATUS
                        END AS ENG_STATUS
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_STAGE
                        ELSE ENGAGEMENT.ENG_STAGE
                        END AS ENG_STAGE
                    ,ENGAGEMENT.ENG_Close_Date
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_Currency
                        ELSE ENGAGEMENT.ENG_Currency
                        END AS ENG_Currency
                    ,ENGAGEMENT.ENG_Transaction_Size_MM_USD
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_Total_Fee
                        ELSE ENGAGEMENT.ENG_Total_Fee_MUSD
                        END AS ENG_Total_Fee_MUSD
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_Estimated_Close_Date
                        ELSE ENGAGEMENT.ENG_Estimated_Close_Date
                        END AS ENG_Estimated_Close_Date
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_Staff_ID
                        ELSE ENGAGEMENT.ENG_Staff_ID
                        END AS ENG_Staff_ID
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_Coverage_Officer_ID
                        ELSE NULL
                        END AS ENG_FS_Coverage_Officer_id
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_Coverage_Officer_Name
                        ELSE ENGAGEMENT.ENG_FS_Coverage_Officer_Name
                        END AS ENG_FS_Coverage_Officer_Name
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_Company_TIER
                        ELSE ENGAGEMENT.ENG_Company_TIER
                        END AS ENG_Company_TIER
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_Flag
                        ELSE ENGAGEMENT.ENG_Flag
                        END AS ENG_Flag
                    ,CASE 
                        WHEN UPPER(ENG_STATUS) = UPPER('Active')
                            THEN
                                ENG_Estimated_Close_Date
                        WHEN UPPER(ENG_STATUS) = UPPER('closed')
                            THEN
                                ENG_Close_Date
                        ELSE NULL
                        END AS CAL_ENG_CLOSE_DATE
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_Client_Name
                        WHEN ENG_Client_Name = ENG_Subject_Name
                            THEN ENG_Client_Name
                        ELSE CONCAT (
                                ENG_Client_Name
                                ,' ('
                                ,ENG_Subject_Name
                                ,' )'
                                )
                        END AS ENG_CLIENT
                        ,CASE   WHEN UPPER(current_account()) = UPPER('bb13604') THEN 'https://hl--dev.sandbox.lightning.force.com/' 
                                WHEN UPPER(current_account()) = UPPER('ef55528') THEN 'https://hl--test.sandbox.lightning.force.com/' 
                                WHEN UPPER(current_account()) = UPPER('gi01295') THEN 'https://hl.lightning.force.com/' 
                                ELSE 'https://hl.lightning.force.com/'
                        END AS SF_URL
                    ,CURRENT_DATE AS PROCESS_START_DATE
                    ,CURRENT_DATE AS PROCESS_END_DATE
                    ,ENGAGEMENT.DND_STATUS
                    ,CASE 
                        WHEN (
                                UPPER(COVERAGE_DATASOURCE.CF_STAFF_INDUSTRY) = 'FIG'
                                AND UPPER(COVERAGE_DATASOURCE.COMPANY_RECORDTYPE) IN (
                                    UPPER('Capital Provider')
                                    ,UPPER('Operating Company')
                                    )
                                )
                            OR (
                                UPPER(COVERAGE_DATASOURCE.CF_STAFF_INDUSTRY) <> 'FIG'
                                AND UPPER(COVERAGE_DATASOURCE.COMPANY_RECORDTYPE) = UPPER('Operating Company')
                                )
                            THEN 'Y'
                        ELSE 'N'
                        END FIG_FLAG
                    FROM (
                    SELECT DISTINCT CONTACT_ID
                        ,LOGIN_ID
                        ,FULL_NAME
                        ,LINE_OF_BUSINESS
                        ,TITLE
                        ,OFFICE
                        ,INDUSTRY_UMBRELLA_REPORTING
                        ,CF_STAFF_INDUSTRY
                        ,COMPANY_RECORDTYPE
                    FROM {{ref('TGT_HL','TMP_COVERAGE_DATASOURCE')}}
                    ) COVERAGE_DATASOURCE
                    INNER JOIN {{ref('TGT_HL','TMP_ENGAGEMENT')}} ENGAGEMENT ON COVERAGE_DATASOURCE.CONTACT_ID = ENGAGEMENT.ENG_Staff_ID 
                    AND ENGAGEMENT.ENG_Company_TIER = 'Not Covered'
                    LEFT JOIN {{ref('TGT_HL','TMP_OPPORTUNITY')}} OPPORTUNITY ON OPPORTUNITY.OPP_ENGAGEMENT_NUMBER = ENGAGEMENT.ENGAGEMENT_NUMBER
                 
                	)
            dependencies:
              - locationName: TGT_HL
                nodeName: TMP_COVERAGE_DATASOURCE
              - locationName: TGT_HL
                nodeName: TMP_ENGAGEMENT
              - locationName: TGT_HL
                nodeName: TMP_OPPORTUNITY
            join:
              joinCondition: |2
                   SELECT 
                    COVERAGE_DATASOURCE.CONTACT_ID
                    ,COVERAGE_DATASOURCE.LOGIN_ID
                    ,COVERAGE_DATASOURCE.FULL_NAME
                    ,COVERAGE_DATASOURCE.LINE_OF_BUSINESS
                    ,COVERAGE_DATASOURCE.TITLE
                    ,COVERAGE_DATASOURCE.OFFICE
                    ,COVERAGE_DATASOURCE.INDUSTRY_UMBRELLA_REPORTING
                    ,COVERAGE_DATASOURCE.CF_STAFF_INDUSTRY
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN CONCAT (
                                    OPPORTUNITY.Opportunity_NUMBER
                                    ,'(VE)'
                                    )
                        ELSE ENGAGEMENT.ENGAGEMENT_NUMBER
                        END AS ENGAGEMENT_NUMBER
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_ID
                        ELSE ENGAGEMENT.ENGAGEMENT_ID
                        END AS ENGAGEMENT_ID
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_NAME
                        ELSE ENGAGEMENT.ENG_NAME
                        END AS ENG_NAME
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_LINE_OF_BUSINESS
                        ELSE ENGAGEMENT.ENG_LINE_OF_BUSINESS
                        END AS ENG_LINE_OF_BUSINESS
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_Client_ID
                        ELSE ENGAGEMENT.ENG_Client_ID
                        END AS ENG_Client_ID
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_Client_Name
                        ELSE ENGAGEMENT.ENG_Client_Name
                        END AS ENG_Client_Name
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_Subject_ID
                        ELSE ENGAGEMENT.ENG_Subject_ID
                        END AS ENG_Subject_ID
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_Subject_Name
                        ELSE ENGAGEMENT.ENG_Subject_Name
                        END AS ENG_Subject_Name
                    ,ENGAGEMENT.ENG_Date
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_CF_Job_Type2
                        ELSE ENGAGEMENT.ENG_CF_Job_Type2
                        END AS ENG_CF_Job_Type2
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_STATUS
                        ELSE ENGAGEMENT.ENG_STATUS
                        END AS ENG_STATUS
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_STAGE
                        ELSE ENGAGEMENT.ENG_STAGE
                        END AS ENG_STAGE
                    ,ENGAGEMENT.ENG_Close_Date
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_Currency
                        ELSE ENGAGEMENT.ENG_Currency
                        END AS ENG_Currency
                    ,ENGAGEMENT.ENG_Transaction_Size_MM_USD
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_Total_Fee
                        ELSE ENGAGEMENT.ENG_Total_Fee_MUSD
                        END AS ENG_Total_Fee_MUSD
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_Estimated_Close_Date
                        ELSE ENGAGEMENT.ENG_Estimated_Close_Date
                        END AS ENG_Estimated_Close_Date
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_Staff_ID
                        ELSE ENGAGEMENT.ENG_Staff_ID
                        END AS ENG_Staff_ID
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_Coverage_Officer_ID
                        ELSE NULL
                        END AS ENG_FS_Coverage_Officer_id
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_Coverage_Officer_Name
                        ELSE ENGAGEMENT.ENG_FS_Coverage_Officer_Name
                        END AS ENG_FS_Coverage_Officer_Name
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_Company_TIER
                        ELSE ENGAGEMENT.ENG_Company_TIER
                        END AS ENG_Company_TIER
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_Flag
                        ELSE ENGAGEMENT.ENG_Flag
                        END AS ENG_Flag
                    ,CASE 
                        WHEN UPPER(ENG_STATUS) = UPPER('Active')
                            THEN
                                ENG_Estimated_Close_Date
                        WHEN UPPER(ENG_STATUS) = UPPER('closed')
                            THEN
                                ENG_Close_Date
                        ELSE NULL
                        END AS CAL_ENG_CLOSE_DATE
                    ,CASE 
                        WHEN UPPER(OPPORTUNITY.OPP_STAGE) = UPPER('Verbally Engaged')
                            AND UPPER(LEGAL_ENTITY) <> UPPER('HL Capital, Inc.')
                            THEN OPPORTUNITY.OPP_Client_Name
                        WHEN ENG_Client_Name = ENG_Subject_Name
                            THEN ENG_Client_Name
                        ELSE CONCAT (
                                ENG_Client_Name
                                ,' ('
                                ,ENG_Subject_Name
                                ,' )'
                                )
                        END AS ENG_CLIENT
                        ,CASE   WHEN UPPER(current_account()) = UPPER('bb13604') THEN 'https://hl--dev.sandbox.lightning.force.com/' 
                                WHEN UPPER(current_account()) = UPPER('ef55528') THEN 'https://hl--test.sandbox.lightning.force.com/' 
                                WHEN UPPER(current_account()) = UPPER('gi01295') THEN 'https://hl.lightning.force.com/' 
                                ELSE 'https://hl.lightning.force.com/'
                        END AS SF_URL
                    ,CURRENT_DATE AS PROCESS_START_DATE
                    ,CURRENT_DATE AS PROCESS_END_DATE
                    ,ENGAGEMENT.DND_STATUS
                    ,CASE 
                        WHEN (
                                UPPER(COVERAGE_DATASOURCE.CF_STAFF_INDUSTRY) = 'FIG'
                                AND UPPER(COVERAGE_DATASOURCE.COMPANY_RECORDTYPE) IN (
                                    UPPER('Capital Provider')
                                    ,UPPER('Operating Company')
                                    )
                                )
                            OR (
                                UPPER(COVERAGE_DATASOURCE.CF_STAFF_INDUSTRY) <> 'FIG'
                                AND UPPER(COVERAGE_DATASOURCE.COMPANY_RECORDTYPE) = UPPER('Operating Company')
                                )
                            THEN 'Y'
                        ELSE 'N'
                        END FIG_FLAG
                    FROM (
                    SELECT DISTINCT CONTACT_ID
                        ,LOGIN_ID
                        ,FULL_NAME
                        ,LINE_OF_BUSINESS
                        ,TITLE
                        ,OFFICE
                        ,INDUSTRY_UMBRELLA_REPORTING
                        ,CF_STAFF_INDUSTRY
                        ,COMPANY_RECORDTYPE
                    FROM {{ref('TGT_HL','TMP_COVERAGE_DATASOURCE')}}
                    ) COVERAGE_DATASOURCE
                    INNER JOIN {{ref('TGT_HL','TMP_ENGAGEMENT')}} ENGAGEMENT ON COVERAGE_DATASOURCE.CONTACT_ID = ENGAGEMENT.ENG_Staff_ID 
                    AND ENGAGEMENT.ENG_Company_TIER = 'Not Covered'
                    LEFT JOIN {{ref('TGT_HL','TMP_OPPORTUNITY')}} OPPORTUNITY ON OPPORTUNITY.OPP_ENGAGEMENT_NUMBER = ENGAGEMENT.ENGAGEMENT_NUMBER
                 
            name: TMP_ASC_REPORTING_2
            noLinkRefs: []
      name: TMP_ASC_REPORTING_2
      overrideSQL: true
      schema: ""
      sqlType: "154"
      type: sql
    stepCounter: f6e3e123-6e6e-4551-a020-914e129774fc
