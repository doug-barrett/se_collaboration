fileVersion: 1
id: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
name: VWA_PRODUCT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  database: ""
  deployEnabled: true
  description: Type 1 Product Dimension - no surrogate key required
  isMultisource: false
  locationName: VIEWS
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24f7659e-3273-41ee-a209-176d216916c5
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: LOGIN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d72a0810-826b-4eaa-a0f1-7834adf3af9c
                stepCounter: 9aa63d83-0291-4ab3-8f12-03918a991bbf
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84d74bbc-6104-4a14-bad1-fe8ab0b3ce50
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: VARCHAR(50)
        description: This is the product key
        hashDetails: null
        name: PRODKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9921cb06-6ba1-403b-b62c-b07f610c59c2
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 653807f1-c5b0-4641-aed9-500a0a9fc8ce
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: ITEM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6c895de6-3b4f-4d0a-a426-229dd2733479
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d81a47d-111e-4220-ba8c-8001784f1dfd
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: VARCHAR(100)
        description: ""
        hashDetails: null
        name: DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c71e9593-49ce-446c-aa31-362de8a012bb
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44ec9c8f-f896-42cb-9436-1c15d0e43c48
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: BRAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4ad576f-9893-4276-bd90-5230454ade05
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9fd59ca-560a-4d5d-8c48-da1fe1a75f88
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: MANUFACTURER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43f543b0-6b79-4a20-a245-3c3f15952edb
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25a198e8-f90c-49a8-9e8c-9b4995be0b8c
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: MODEL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dcc60921-7c27-4bde-8686-75b352e62541
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95c21b5d-7f44-4f0b-b622-da1eb2cfd81f
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: SIZE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 03221aa2-49cb-459a-9514-9eff53bc422c
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f14e9c93-ab15-40ea-b307-78cbc9119694
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: VARCHAR(10)
        description: ""
        hashDetails: null
        name: UOM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8472f99f-5800-4c94-92b1-748b0536ee72
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a1398163-be9e-4e15-9b93-be490bffa8b3
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL1_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ffc18879-428f-4a04-b4d5-f5b43fa59378
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9267fd6e-e1a5-46c9-b5d0-9ba356c370b9
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL1_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48a82910-6386-46e0-b072-3c89965cb3c1
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad8873f8-d9c8-4e08-8f4a-89dc96c58dfe
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL2_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a150f5c6-2c62-4aa0-b131-833dc2dae34a
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0067af8f-65e3-40b3-94f6-ba83ff100402
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL2_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 850983c0-90a9-4640-84e8-e8ae587b9e5a
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9bf44872-e467-48e6-aa48-3d51867534e7
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL3_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9e9a74c0-7566-4bc4-83b1-295613b6dfcb
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d51521a9-8a90-4dce-ac03-335f02066694
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL3_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76b80dd0-990c-439c-9b2a-f320fd772670
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a92943b1-d1d2-483e-bfa9-7805f2b4326a
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL4_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0dc3d751-e3a7-426e-a3cc-8794e285192b
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f7020e6-6fe3-441c-8476-cce6609cdc5d
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL4_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81d483bb-5578-4211-bed7-6f59f0e33c08
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a09489b-0006-40c2-9158-b39631973a2a
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL5_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 418e8057-0579-4b61-96fb-5e4fd69f5111
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d98d3125-e0ee-48d6-9390-7a135d41688e
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL5_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66c9a231-f431-4a57-94fd-11de9bccdfda
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3b863f0-c55d-482e-95bf-84d4f28cffe0
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: DECIMAL(38)
        description: ""
        hashDetails: null
        name: ITEM_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 701c7fcc-35f8-484c-94d9-8bf2c4fa64c7
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25fb8aed-aa37-4c23-9015-28d05ccb99d0
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: PRODUCT_GROUP_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2255acc6-603f-4dd3-b199-fbce2b3d674b
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc6461e9-2b68-4c0d-bf9f-11f3e1b62ee1
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: PRODUCT_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: df03dcde-b0fc-4365-86a9-f33826dae2b4
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eddd7585-9af1-438b-87dc-8257e62bd75d
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LIKE_ITEM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b69bfdc5-9e1a-4237-94e1-afd183ee4c97
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19b45d84-2d98-46b0-9fa4-7eb086f9bec2
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: DECIMAL(38)
        description: ""
        hashDetails: null
        name: IS_BUNDLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a670e414-0304-43fe-af1b-9f2d5261242b
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b07cbd2-b661-4d73-a417-2c2d35f586a5
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: DECIMAL(38)
        description: ""
        hashDetails: null
        name: PRODUCT_CONDITION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e01ea4b7-4bbf-43a5-8cfd-48be224dae26
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 944ff8ba-0893-404d-a1c1-db2a259d7a0f
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: DECIMAL(38)
        description: ""
        hashDetails: null
        name: IS_SHIP_FROM_STORE_ELIGIBLE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 92dfc1fe-815f-4d7c-b55f-4435ffe693c0
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dcc7fdd4-d666-4681-8c5c-fe7a0956b2aa
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: VARCHAR(1000)
        description: ""
        hashDetails: null
        name: PRODUCT_URL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2030693-7fdd-4965-b52d-48fdc20bf588
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3669449c-d4aa-4a3c-8656-d854c341fb05
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: VARCHAR(1000)
        description: ""
        hashDetails: null
        name: IMAGE_URL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c4a35f50-9b27-4b26-9542-dc6c63082919
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77c12fcf-d25f-4e8f-9c95-4b2c366e33be
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: DATE
        description: ""
        name: LAST_SOLD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e59a2726-2f47-4449-8cb9-856491846d5a
                stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f17b06b-ff4f-48f2-897f-8165505b21f1
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: CURRENT_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c158f9b5-1f93-40cc-8d64-3d3e80f709ad
                stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a0fc810-baa5-4de8-8c95-7c9ee0fe42ff
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: YEAR_MODE_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b0287ec1-4ec4-4bf5-82a3-4b99c754b78c
                stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1034ef47-a1ec-44a5-a72d-2befab67c1b5
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: NUMBER(9,2)
        description: ""
        name: YEAR_MAX_UNITS_SALES_PER_DAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20df9c70-109d-44ce-be35-13681cf3cfa0
                stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66b1a889-0e9d-4993-ab17-86509d836ec4
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: NUMBER(9,2)
        description: ""
        name: YEAR_UNITS_SALES_TOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac508e91-02f4-4a02-b190-ce15b08fd348
                stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c19998ea-f6bb-48e4-bf94-9f8bfa2fd2df
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: STRING
        description: ""
        name: PRICE_CATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d81e08fc-da9a-40c8-9db4-33afc2e502cc
                stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
            transform: |-
              CASE "STG_MEASURES_CURRENT"."PRICE_NTILE3"
              WHEN 1 THEN 'HIGH PRICE'
              WHEN 2 THEN 'MEDIUM PRICE'
              WHEN 3 THEN 'LOW PRICE'
              ELSE 'UNKNOWN'
              END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5df15876-ed2d-4330-83f5-183fe7a7abb8
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: STRING
        description: ""
        name: VOLUME_CATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97a53874-c4c5-418e-829d-4f6191d0e365
                stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
            transform: |-
              CASE "STG_MEASURES_CURRENT"."VOLUME_NTILE3"
              WHEN 1 THEN 'HIGH VOLUME'
              WHEN 2 THEN 'MEDIUM VOLUME'
              WHEN 3 THEN 'LOW VOLUME'
              ELSE 'UNKNOWN'
              END
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ab2bdee5-33f3-489f-ac4f-30b324b15d6a
          stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
        config: {}
        dataType: STRING
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: MA_CAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: PRICE_CATEGORY|| '- ' || VOLUME_CATEGORY || '- ' || DIM_PRODUCT.LEVEL3_DESC
        systemColumnType: None
        transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_PRODUCT: 99510b9e-1d3e-4709-93b8-2042202093b0
          STG_MEASURES_CURRENT: 6deaf504-e80c-4050-810f-1e356357d18c
          VW_PRODUCT_SECURITY: 9aa63d83-0291-4ab3-8f12-03918a991bbf
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATA
            nodeName: DIM_PRODUCT
          - locationName: STAGE
            nodeName: STG_MEASURES_CURRENT
          - locationName: STAGE
            nodeName: VW_PRODUCT_SECURITY
        join:
          joinCondition: |-
            FROM {{ ref('DATA', 'DIM_PRODUCT') }} "DIM_PRODUCT"
            JOIN {{ ref('STAGE', 'VW_PRODUCT_SECURITY') }} "VW_PRODUCT_SECURITY"
            ON "DIM_PRODUCT"."PRODKEY" = "VW_PRODUCT_SECURITY"."PRODKEY"
            LEFT JOIN {{ ref('STAGE', 'STG_MEASURES_CURRENT') }} "STG_MEASURES_CURRENT"
            ON "DIM_PRODUCT"."PRODKEY" = "STG_MEASURES_CURRENT"."PRODKEY"
            AND "STG_MEASURES_CURRENT"."ZONE_GEOGRAPHY" = 'UK'
        name: VWA_PRODUCT
        noLinkRefs: []
  name: VWA_PRODUCT
  overrideSQL: false
  schema: ""
  sqlType: "17"
  type: sql
  version: 1
type: Node
