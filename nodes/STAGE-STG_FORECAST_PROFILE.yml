fileVersion: 1
id: 592b6ec9-1980-4c8d-b3c8-598b66417984
name: STG_FORECAST_PROFILE
operation:
  config:
    insertStrategy: INSERT
    postSQL: null
    preSQL: null
    selectDistinct: false
    testsEnabled: false
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: true
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8f201b5-5180-4240-ac7c-c12a60991372
          stepCounter: 592b6ec9-1980-4c8d-b3c8-598b66417984
        config: {}
        dataType: VARCHAR(64)
        description: ""
        name: ZONE_GEOGRAPHY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5838a6a2-8d20-4400-8a01-468cd6b6b474
                stepCounter: 39a4cb47-b48d-448b-9847-6d2fbeb149d3
            transform: ""
          - columnReferences:
              - columnCounter: 6dfb2e6e-b7c5-46bd-94ca-9c8038d52d42
                stepCounter: f9b31c20-87b7-493d-b140-c1194c7e762e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c22968f-9260-4892-87a6-4010486d67f7
          stepCounter: 592b6ec9-1980-4c8d-b3c8-598b66417984
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: LEVEL3_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07bd46f5-d63b-4515-be9d-ce8e7430edf4
                stepCounter: 39a4cb47-b48d-448b-9847-6d2fbeb149d3
            transform: ""
          - columnReferences:
              - columnCounter: 6499ad62-4262-4d67-9b72-18ca808e487e
                stepCounter: f9b31c20-87b7-493d-b140-c1194c7e762e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07b0cdf4-77fd-4a25-bda5-c5689ffbfd1b
          stepCounter: 592b6ec9-1980-4c8d-b3c8-598b66417984
        config: {}
        dataType: VARCHAR(64)
        description: ""
        name: PERIOD_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6a9cc84-7e7a-41ba-9965-f222eabc6515
                stepCounter: 39a4cb47-b48d-448b-9847-6d2fbeb149d3
            transform: "'NO_HOLIDAY'"
          - columnReferences:
              - columnCounter: 4753070f-b7a3-4f1f-8539-33af43d2083d
                stepCounter: f9b31c20-87b7-493d-b140-c1194c7e762e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb708936-1a0b-4ced-af74-74072f2dc305
          stepCounter: 592b6ec9-1980-4c8d-b3c8-598b66417984
        config: {}
        dataType: CHAR(1)
        description: ""
        name: HOLIDAY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'N'"
          - columnReferences:
              - columnCounter: 4753070f-b7a3-4f1f-8539-33af43d2083d
                stepCounter: f9b31c20-87b7-493d-b140-c1194c7e762e
            transform: "'Y'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11143122-047f-4ef5-ba5c-1a12d4fddb58
          stepCounter: 592b6ec9-1980-4c8d-b3c8-598b66417984
        config: {}
        dataType: NUMBER
        description: ""
        name: DAY_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6a9cc84-7e7a-41ba-9965-f222eabc6515
                stepCounter: 39a4cb47-b48d-448b-9847-6d2fbeb149d3
            transform: ""
          - columnReferences:
              - columnCounter: 29298d76-a7ad-44fb-a235-ebbb9542fc7d
                stepCounter: f9b31c20-87b7-493d-b140-c1194c7e762e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 600594e8-8b5a-42c2-b9cd-f2b30b1334ae
          stepCounter: 592b6ec9-1980-4c8d-b3c8-598b66417984
        config: {}
        dataType: NUMBER(12,6)
        description: ""
        name: UNITS_RATIO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e34e2e4f-4ba7-4f40-90be-c7c9fc1c3874
                stepCounter: 39a4cb47-b48d-448b-9847-6d2fbeb149d3
            transform: ""
          - columnReferences:
              - columnCounter: 45e47093-9921-440e-ae1d-d7f822d6317d
                stepCounter: 781d9f43-b1c7-45c2-9fa5-abd0ad2d80d7
            transform: "\"STG_SALES_MA_HOL_PROFILE\".\"UNITS_RATIO\" * \"STG_MEASURES_HOLIDAY_RATIO\".\"HOLIDAY_RATIO\""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_SALES_MA_DAY_PROFILE: 39a4cb47-b48d-448b-9847-6d2fbeb149d3
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: STG_SALES_MA_DAY_PROFILE
        join:
          joinCondition: FROM {{ ref('STAGE', 'STG_SALES_MA_DAY_PROFILE') }} "STG_SALES_MA_DAY_PROFILE"
        name: WEEK_DAY_PROFILE
        noLinkRefs: []
      - aliases:
          STG_MEASURES_HOLIDAY_RATIO: 781d9f43-b1c7-45c2-9fa5-abd0ad2d80d7
          STG_SALES_MA_HOL_PROFILE: f9b31c20-87b7-493d-b140-c1194c7e762e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: STG_MEASURES_HOLIDAY_RATIO
          - locationName: STAGE
            nodeName: STG_SALES_MA_HOL_PROFILE
        join:
          joinCondition: |-
            FROM {{ ref('STAGE', 'STG_SALES_MA_HOL_PROFILE') }} "STG_SALES_MA_HOL_PROFILE"
            INNER JOIN {{ ref('STAGE', 'STG_MEASURES_HOLIDAY_RATIO') }} "STG_MEASURES_HOLIDAY_RATIO"
            ON "STG_SALES_MA_HOL_PROFILE"."ZONE_GEOGRAPHY" = "STG_MEASURES_HOLIDAY_RATIO"."ZONE_GEOGRAPHY"
            AND "STG_SALES_MA_HOL_PROFILE"."LEVEL3_DESC" = "STG_MEASURES_HOLIDAY_RATIO"."LEVEL3_DESC"
            AND "STG_SALES_MA_HOL_PROFILE"."HOLIDAY_NAME" = "STG_MEASURES_HOLIDAY_RATIO"."HOLIDAY_NAME"
        name: HOLIDAY_PROFILE
        noLinkRefs: []
  name: STG_FORECAST_PROFILE
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
