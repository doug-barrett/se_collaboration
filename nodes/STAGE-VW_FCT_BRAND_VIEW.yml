fileVersion: 1
id: 060566dc-400a-41ac-ac06-31b6a531a3f1
name: VW_FCT_BRAND_VIEW
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c8070a6-fc9d-4ed7-93df-f40d1778c92e
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: DATE
        description: ""
        hashDetails: null
        name: SCRAPE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 28cbce96-ec32-4de9-9272-98eb3540a112
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a0ea0557-27cf-4ead-bb67-6a832fe285e5
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(64)
        description: ""
        hashDetails: null
        name: ZONE_GEOGRAPHY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b37b322a-b195-42bf-a543-a213b38730d9
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80f50841-9e9b-4279-8906-98790550a5f2
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: NUMBER
        description: ""
        hashDetails: null
        name: ZONE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d71b861d-f096-4cee-b754-16499431a9aa
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71fc9680-cb1e-4d58-9deb-d9e664e02e79
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(64)
        description: ""
        hashDetails: null
        name: COMPETITOR_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8e0ef8c5-7590-44a7-99bd-98899103380b
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b1e114d6-5deb-4757-b430-33c898b7a5fb
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(10)
        description: ""
        hashDetails: null
        name: PRODKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f288b147-ad8f-4e1f-911f-fe644bee4906
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82ae2219-d63b-4712-b31d-12303eedc2f1
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: COMPETITOR_PRODKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8188ad3e-a049-4c21-9cf0-91674d6fba78
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6669904d-be25-4a63-81cc-6aee3182fb3c
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: NUMBER
        description: ""
        name: DIM_EVENTS_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ca75ac06-f7a4-4f8c-9300-4c60defaafa1
                stepCounter: dcecf750-3ca1-418e-a5b6-dca1e383dd74
            transform: NVL("DIM_EVENTS"."DIM_EVENTS_KEY",0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1f63ae15-1733-45b8-8a86-67ce14a9703b
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: NUMBER
        description: ""
        name: DIM_EVENTS_REGION_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f2580ea-7f12-439c-b7e9-9a88a2302fbf
                stepCounter: dcecf750-3ca1-418e-a5b6-dca1e383dd74
            transform: NVL("DIM_EVENTS"."DIM_EVENTS_REGION_KEY",0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99fc3d6b-529c-47fb-b431-418a2d7af100
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: NUMBER
        description: ""
        name: DIM_PRICE_COST_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b9c64486-0b93-4f82-9a4d-ab29529f6d88
                stepCounter: 98a79ee0-39e1-4d29-9b40-12a08dc9fd23
            transform: NVL("DIM_PRICE_COST_2"."DIM_PRICE_COST_KEY",0)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3bca0b96-6a9d-4301-a53e-3b20a578a454
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(64)
        description: ""
        hashDetails: null
        name: COMPETITOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7063086e-ee47-4778-966c-95ca86b1281e
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0edc45e-6135-4176-8153-ee5658d5c6bf
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(64)
        description: ""
        hashDetails: null
        name: CURRY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c4e7c0c-4c4f-48d5-9b76-294c8c4c1769
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b23c1ad-f6bc-4af3-855f-5968b9b60410
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(64)
        description: ""
        hashDetails: null
        name: COMPETITOR_CD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c9cc086-6022-41ba-a43a-d7864ab32cee
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42386b9b-da4d-4ffb-b206-1bd4a0b0c20f
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(500)
        description: ""
        hashDetails: null
        name: MATCH_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f08ad99-222d-43ee-9810-7037430a79ae
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: "'WISERS'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1429e207-b1a0-4ea3-9e49-f0992c02be66
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20bc0d9e-176f-432f-bf0f-c4fc58a14ef0
                stepCounter: 98a79ee0-39e1-4d29-9b40-12a08dc9fd23
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c6287d7-5a65-4067-901d-909bbd13fb3e
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: NUMBER(12,5)
        description: ""
        hashDetails: null
        name: COMPETITOR_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97edbac0-66ad-4deb-836b-85e914775138
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d4388bf-0e02-45fd-ad07-443aac95a922
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: NUMBER(12,5)
        description: ""
        hashDetails: null
        name: CPI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 97edbac0-66ad-4deb-836b-85e914775138
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: |-
              CASE WHEN NVL("DS_BRAND_VIEW"."COMPETITOR_PRICE", 0) = 0 THEN 0 
              ELSE 
                TO_NUMBER(("DIM_PRICE_COST_2"."PRICE" / "DS_BRAND_VIEW"."COMPETITOR_PRICE") * 100) 
              END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f2566d7f-4cc2-46cc-915b-7d0f7397f267
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(64)
        description: ""
        hashDetails: null
        name: CURRY_CHEAPEST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8c4e7c0c-4c4f-48d5-9b76-294c8c4c1769
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: CASE WHEN "DS_BRAND_VIEW"."COMPETITOR_PRICE" < "DIM_PRICE_COST_2"."PRICE" THEN 'N' ELSE 'Y' END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13fbc5b4-9efa-4e18-b3a6-6a8c11e69f99
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: NUMBER(12,5)
        description: ""
        hashDetails: null
        name: COMPETITOR_WAS_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7049f6a9-6763-498b-b648-4cb8e09b8c84
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 23d8e004-94bf-43df-bcb7-ca15e3347a95
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(255)
        description: ""
        hashDetails: null
        name: COMPETITOR_STOCK_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 080d82a9-51e0-4198-9f2e-3b37149773ed
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86f7e482-441b-4ca3-86ea-ee7c813bc8f0
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(1)
        description: ""
        hashDetails: null
        name: ONLINE_AVAILABILITY_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82fc358e-b2e3-4815-921e-8b8151c53f9e
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0354b28a-7aa6-4ccb-88a0-7ccf08c1598f
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(500)
        description: ""
        hashDetails: null
        name: BRAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8cea5a34-fd30-462a-a30b-46c05363a731
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af5c4aa3-3002-4723-a44a-3f4f4372e2e4
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(1200)
        description: ""
        hashDetails: null
        name: URL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f5582046-5bcb-4046-9465-ceda5db1a18e
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 221abc7d-befc-403f-8dec-ecd48e0c1cd5
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(500)
        description: ""
        hashDetails: null
        name: SVG_MSG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd1c04c8-da0b-42a7-9b3a-030c03223f91
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2259e42f-70f7-4fbf-bc6c-5787d72e99af
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(1)
        description: ""
        hashDetails: null
        name: CAS_IND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b11680c-d3c7-4253-8d69-da41ce7f4faa
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8164ed40-9330-4298-a743-0b12bb90b8fe
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: NUMBER(12,5)
        description: ""
        hashDetails: null
        name: LO_DLVY_PRC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39b02420-127d-4a1d-bb52-78ea95dabef7
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 759d26d5-6e21-4ac2-87f7-884ce0a02e6d
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: NUMBER(12,5)
        description: ""
        hashDetails: null
        name: QCK_DLVY_PRC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 59018990-5491-41b3-be3a-31ec5f1936e4
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d5baa2a1-217f-4d99-a671-c0009ca4857c
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: NUMBER(12,5)
        description: ""
        hashDetails: null
        name: SVG_VAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9772db49-1878-44d4-acc8-b8744e1c6e61
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ccb01e6-a5a3-44a0-abc2-2731acefa81c
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(500)
        description: ""
        hashDetails: null
        name: COMPETITOR_CATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a2450d3-f3f2-4c9e-b0c6-67ec5a728c9b
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8e0841ef-c369-49cf-bc27-d341587cbbf1
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(64)
        description: ""
        hashDetails: null
        name: COMPETITOR_MA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d4a9601-2017-4680-8b94-4af74dc30bb1
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a9943b6-606d-44b0-9df8-c9c8c26bbc0f
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(64)
        description: ""
        hashDetails: null
        name: COMPETITOR_PG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f337b6d8-9671-4734-baaa-7c80ec02be0d
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 056e5454-6f4c-440b-b4f2-18fab8375121
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(500)
        description: ""
        hashDetails: null
        name: PROD_SPFCTN_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: da002131-f9ee-4f68-a840-88db7a9226a5
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6fcd61d0-0ea2-472a-aba6-671a9e173243
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(500)
        description: ""
        hashDetails: null
        name: PROD_SPFCTN_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bfc10097-2deb-4149-aa40-3b53e93faa30
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30f08467-f669-4968-83b4-e18c44c65af5
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(500)
        description: ""
        hashDetails: null
        name: PROD_SPFCTN_3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d10d024c-3e55-41d9-a98a-82a9d39f812a
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47303dc0-6d41-413f-9b4c-d505a3c0d811
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(100)
        description: ""
        hashDetails: null
        name: COMPETITOR_BARCODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6a9b2be-82ec-455b-9041-1a7ff3266798
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b2d8c29-98f3-41f9-8c99-46f44fc340e4
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(100)
        description: ""
        hashDetails: null
        name: COMPETITOR_PART_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 354c8dfa-a6c0-4272-9d6c-e18e8e01af86
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4caef82e-23d4-4f29-a333-69a1e3f3fab2
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(500)
        description: ""
        hashDetails: null
        name: COMPETITOR_PRODUCT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6b3d50e8-aa64-421e-ae93-64a58e837659
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0be558e8-81ba-4b9e-a149-ea8901599b67
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(500)
        description: ""
        hashDetails: null
        name: PROMO_MECHANIC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5a5578a-19c3-439c-ab37-1837b06f6fdd
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d766e32-6e23-4845-b779-570099f701be
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: TIME(9)
        description: ""
        hashDetails: null
        name: PC_TM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 38eccdaf-4996-4a9e-bc78-26ffce9589a0
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f78311a-6ec1-4cd6-8726-22290e1bddb5
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: DATE
        description: ""
        hashDetails: null
        name: PC_DT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 40e68529-c4aa-4633-9c22-74bcc04cefae
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c8164cd-a34b-4b36-b15f-c0c5eac222e7
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: CURRENCY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d68f266f-48b4-4f1a-9b18-54f740563920
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16dfd4cd-9727-48c4-8ee5-8abcf62fb42c
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: CURRENCY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37d50f6c-bc81-489b-9d09-e48cb1e0b90e
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0fb8d4c3-e6f9-491c-bc12-09a1513575b5
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: TIMESTAMP
        description: ""
        hashDetails: null
        name: SYSTEM_CREATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2c0c4f4-e464-477e-8ab3-b46cdbabaced
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6ea5c911-dab3-4d0c-a4a1-e6f01db1fa71
          stepCounter: 060566dc-400a-41ac-ac06-31b6a531a3f1
        config: {}
        dataType: TIMESTAMP
        description: ""
        hashDetails: null
        name: SYSTEM_UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ea9b00f-e456-4100-94bc-3780e0640e47
                stepCounter: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_EVENTS: dcecf750-3ca1-418e-a5b6-dca1e383dd74
          DIM_PRICE_COST_2: 98a79ee0-39e1-4d29-9b40-12a08dc9fd23
          DS_BRAND_VIEW: d8a75b99-14b2-44e1-96d6-1f93b61b8d04
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATA
            nodeName: DIM_EVENTS
          - locationName: DATA
            nodeName: DIM_PRICE_COST_2
          - locationName: DATASTORE
            nodeName: DS_BRAND_VIEW
        join:
          joinCondition: |
            FROM {{ ref('DATASTORE', 'DS_BRAND_VIEW') }} "DS_BRAND_VIEW"
            LEFT JOIN {{ ref('DATA', 'DIM_EVENTS') }} "DIM_EVENTS"
            ON "DS_BRAND_VIEW".ZONE_CODE = "DIM_EVENTS".ZONE_CODE
            AND DS_BRAND_VIEW.PRODKEY = DIM_EVENTS.PRODKEY
            AND DS_BRAND_VIEW."SCRAPE_DATE" BETWEEN "DIM_EVENTS"."EFFECTIVE_DATE" AND "DIM_EVENTS"."END_DATE"
            LEFT JOIN {{ ref('DATA', 'DIM_PRICE_COST_2') }} "DIM_PRICE_COST_2"
            ON "DS_BRAND_VIEW"."ZONE_CODE" = "DIM_PRICE_COST_2"."ZONE_CODE"
            AND "DS_BRAND_VIEW"."PRODKEY" = "DIM_PRICE_COST_2"."PRODKEY"
            AND "DS_BRAND_VIEW"."SCRAPE_DATE" BETWEEN "DIM_PRICE_COST_2"."PC_DT" AND "DIM_PRICE_COST_2"."PC_DT_END"
            WHERE NOT ("DS_BRAND_VIEW"."PRODKEY" = "DS_BRAND_VIEW"."COMPETITOR_PRODKEY" AND "DS_BRAND_VIEW"."CURRY_FLAG" = 'Y')
            AND "DS_BRAND_VIEW".SCRAPE_DATE > (SELECT NVL(MAX("SCRAPE_DATE"),'2000-01-01') FROM {{ ref_no_link('DATA','FCT_BRAND_VIEW')}})
        name: VW_FCT_BRAND_VIEW
        noLinkRefs:
          - locationName: DATA
            nodeName: FCT_BRAND_VIEW
  name: VW_FCT_BRAND_VIEW
  overrideSQL: false
  schema: ""
  sqlType: "16"
  type: sql
  version: 1
type: Node
