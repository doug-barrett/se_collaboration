fileVersion: 1
id: e5c98e83-a4a7-4916-b86f-272c3a095f34
name: TMP_ASC_REPORTING_4
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TGT_HL
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 0ad55993-b605-46af-93e0-2e09971a99bb
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CONTACT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 667c31d9-f114-499f-b3fa-b8f46285f555
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: LOGIN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 05a99185-4bd4-4810-a6ed-d8fbcbae6fd1
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: FULL_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 301d7641-b7bc-4baa-924d-8c3b4113c85b
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: LINE_OF_BUSINESS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 044fc039-51ed-4372-b281-69b52aecab7d
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: TITLE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 5b53ab9d-457d-4de0-aca3-de7c938005a2
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OFFICE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 7f92218e-7c63-4c7b-bf52-d84d3bdbafdb
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: INDUSTRY_UMBRELLA_REPORTING
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 5c27ffe1-dc3a-47e6-9e73-2d4c5322ed1e
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: CF_STAFF_INDUSTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: f54aee42-1abe-44f1-9009-f2eb2787d670
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPPORTUNITY_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: f9744e46-31bb-4964-ba49-b1a23b1c7a86
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPP_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 63c030cf-f322-4514-9837-e28e40a32322
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPP_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 36a2f19f-a318-49c9-b378-7f1a43323fbf
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPP_LINE_OF_BUSINESS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 1f0eed5d-9312-4784-99bb-96e01046f092
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPP_CLIENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: cb02dc50-68f2-4b41-9446-830529a9c9ab
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPP_CLIENT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ba00305b-1bda-4dad-b0a3-cafcad4b2249
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPP_SUBJECT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 21d83786-2143-4fc6-a352-84050ea19b10
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPP_SUBJECT_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 10a02425-a6f3-48db-91de-b9cb07a91bc4
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPP_CF_JOB_TYPE2
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 72d48090-b135-4f7f-8c48-4481141b1c72
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPP_JOB_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 0995be95-2a48-4431-ab40-695db77ac667
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPP_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 7521619a-9d56-4552-ad27-62ae456382f7
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPP_ENGAGEMENT_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: da6e6f36-0ab3-477f-a9bd-f6e7569d12d6
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPP_STAGE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 099e0eaa-7b7a-403a-9b23-ac2f87b7db95
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: TIMESTAMP_TZ(9)
        defaultValue: ""
        description: ""
        name: OPP_CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: e6ff756f-6876-491f-b340-eb6deabad936
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: BOOLEAN
        defaultValue: ""
        description: ""
        name: OPP_NBC_APPROVED
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 9095a0bc-8390-4f36-984c-175dbee30416
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: OPP_NBC_DATE_SUBMITTED
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 3f28cc6f-e62c-45e1-afba-6216d87f60ae
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: OPP_NBC_DATE_APPROVED
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 04998742-a63a-462a-b6ff-b6ba8a1d4e66
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: OPP_PITCH_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 5564db9f-6b49-46a7-96fd-9101f4fb353a
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPP_CURRENCY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 3373ac5d-5e9f-44d0-846d-dfc795f8a64f
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OPP_MAX_FEE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 3ae5dbc1-4885-48f9-9218-f6aee3378bba
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OPP_MIN_FEE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: c83d3ff6-4019-43b3-8187-3b5da5ebcf0d
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: FLOAT
        defaultValue: ""
        description: ""
        name: OPP_TOTAL_FEE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 32520601-7628-46ea-a929-ba160ba0ce70
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: OPP_ESTIMATED_CLOSE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: c11c5738-a94a-4bde-92fc-6efcebe0795b
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPP_COVERAGE_OFFICER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: e54e5137-8810-49c4-8f60-612964cebcad
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPP_COVERAGE_OFFICER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: b544a031-006d-4565-8259-43408d3c7a73
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPP_COMPANY_TIER
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 42ed3095-f3c3-447b-8067-71c567837a46
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(19)
        defaultValue: ""
        description: ""
        name: OPP_FLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: fb1a4927-ebdc-4c74-a881-bebc0581beb1
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: OPP_CLIENT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 59ab16a6-aa7f-41f7-b1cf-730d7ab3b3ad
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(45)
        defaultValue: ""
        description: ""
        name: SF_URL
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 9c2c9943-515f-4446-8c81-2f7acc051ab1
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: PROCESS_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 07acdecf-792d-4b8c-8139-91b04bf49b62
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        name: PROCESS_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: bd639f72-b15a-4b39-95d9-b12c5f483996
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(16777216)
        defaultValue: ""
        description: ""
        name: DND_STATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: e1748018-b986-4156-895c-b0080d650156
          stepCounter: e5c98e83-a4a7-4916-b86f-272c3a095f34
        config: {}
        dataType: VARCHAR(1)
        defaultValue: ""
        description: ""
        name: FIG_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: ""
        transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: |-
            {{ stage('Override Create SQL') }}
            	CREATE OR REPLACE VIEW {{ ref('TGT_HL', 'TMP_ASC_REPORTING_4')}} AS (
            SELECT DISTINCT
                COVERAGE_DATASOURCE.CONTACT_ID
                ,COVERAGE_DATASOURCE.LOGIN_ID
                ,COVERAGE_DATASOURCE.FULL_NAME
                ,COVERAGE_DATASOURCE.LINE_OF_BUSINESS
                ,COVERAGE_DATASOURCE.TITLE
                ,COVERAGE_DATASOURCE.OFFICE
                ,COVERAGE_DATASOURCE.INDUSTRY_UMBRELLA_REPORTING
                ,COVERAGE_DATASOURCE.CF_STAFF_INDUSTRY
                ,OPPORTUNITY.Opportunity_NUMBER
                ,OPPORTUNITY.OPP_ID
                ,OPPORTUNITY.OPP_NAME
                ,OPPORTUNITY.OPP_LINE_OF_BUSINESS
                ,OPPORTUNITY.OPP_Client_ID
                ,OPPORTUNITY.OPP_Client_Name
                ,OPPORTUNITY.OPP_Subject_ID
                ,OPPORTUNITY.OPP_Subject_Name
                ,OPPORTUNITY.OPP_CF_Job_Type2
                ,OPPORTUNITY.OPP_JOB_TYPE
                ,OPPORTUNITY.OPP_STATUS
                ,OPPORTUNITY.OPP_ENGAGEMENT_NUMBER
                ,OPPORTUNITY.OPP_STAGE
                ,OPPORTUNITY.OPP_Create_Date
                ,COALESCE(OPPORTUNITY.OPP_NBC_Approved, NULL) OPP_NBC_Approved
                ,OPPORTUNITY.OPP_NBC_Date_Submitted
                ,OPPORTUNITY.OPP_NBC_Date_Approved
                ,OPPORTUNITY.OPP_Pitch_Date
                ,OPPORTUNITY.OPP_Currency
                ,OPPORTUNITY.OPP_Max_Fee
                ,OPPORTUNITY.OPP_Min_Fee
                ,OPPORTUNITY.OPP_Total_Fee
                ,OPPORTUNITY.OPP_Estimated_Close_Date
                ,OPPORTUNITY.OPP_Coverage_Officer_ID
                ,OPPORTUNITY.OPP_Coverage_Officer_Name
                ,OPPORTUNITY.OPP_Company_TIER
                ,OPPORTUNITY.OPP_Flag
                ,CASE 
                    WHEN OPP_Client_Name = OPP_Subject_Name
                        THEN OPP_Client_Name
                    ELSE CONCAT (
                            OPP_Client_Name
                            ,' ('
                            ,OPP_Subject_Name
                            ,' )'
                            )
                    END AS OPP_CLIENT
                    ,CASE   WHEN UPPER(current_account()) = UPPER('bb13604') THEN 'https://hl--dev.sandbox.lightning.force.com/' 
                            WHEN UPPER(current_account()) = UPPER('ef55528') THEN 'https://hl--test.sandbox.lightning.force.com/' 
                            WHEN UPPER(current_account()) = UPPER('gi01295') THEN 'https://hl.lightning.force.com/' 
                            ELSE 'https://hl.lightning.force.com/'
                    END AS SF_URL
                ,CURRENT_DATE AS PROCESS_START_DATE
                ,CURRENT_DATE AS PROCESS_END_DATE
                ,OPPORTUNITY.DND_STATUS
                ,CASE 
                    WHEN (
                            UPPER(COVERAGE_DATASOURCE.CF_STAFF_INDUSTRY) = 'FIG'
                            AND UPPER(COVERAGE_DATASOURCE.COMPANY_RECORDTYPE) IN (
                                UPPER('Capital Provider')
                                ,UPPER('Operating Company')
                                )
                            )
                        OR (
                            UPPER(COVERAGE_DATASOURCE.CF_STAFF_INDUSTRY) <> 'FIG'
                            AND UPPER(COVERAGE_DATASOURCE.COMPANY_RECORDTYPE) = UPPER('Operating Company')
                            )
                        THEN 'Y'
                    ELSE 'N'
                    END FIG_FLAG
                FROM (
                SELECT DISTINCT CONTACT_ID
                    ,LOGIN_ID
                    ,FULL_NAME
                    ,LINE_OF_BUSINESS
                    ,TITLE
                    ,OFFICE
                    ,INDUSTRY_UMBRELLA_REPORTING
                    ,CF_STAFF_INDUSTRY
                    ,COMPANY_RECORDTYPE
                FROM {{ ref('TGT_HL', 'TMP_COVERAGE_DATASOURCE')}}
                ) COVERAGE_DATASOURCE
                INNER JOIN {{ ref('TGT_HL', 'TMP_OPPORTUNITY')}} OPPORTUNITY ON COVERAGE_DATASOURCE.CONTACT_ID = OPPORTUNITY.OPP_Coverage_Officer_ID -- Join by ID
                AND UPPER(OPPORTUNITY.OPP_Flag) = UPPER('Not Staffed On Deal')
            	)
        dependencies: []
        join:
          joinCondition: ""
        name: TMP_ASC_REPORTING_4
        noLinkRefs: []
  name: TMP_ASC_REPORTING_4
  overrideSQL: true
  schema: ""
  sqlType: "154"
  type: sql
  version: 1
type: Node
