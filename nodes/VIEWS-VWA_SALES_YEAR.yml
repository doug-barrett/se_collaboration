fileVersion: 1
id: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
name: VWA_SALES_YEAR
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: VIEWS
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4542a0d2-7ee6-4b65-b5d3-0dee3c055e6d
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARCHAR(64)
        description: ""
        hashDetails: null
        name: ZONE_GEOGRAPHY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f8e2fa6-dc17-46ee-b538-a98a30c00c1c
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 788a63d1-315f-4b57-99c3-e032e066fc57
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARCHAR(50)
        description: This is the product key
        hashDetails: null
        name: PRODKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ad8725b-1fa4-4995-9ef8-c0dd4fe3f7db
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21fec4ce-c2c9-42fe-9fd0-a6426c3676c1
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARCHAR(10)
        description: ""
        hashDetails: null
        name: FINANCIAL_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 965439c0-11b1-41df-9ae7-cfaf8db8ae6c
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15f326ac-68b4-496c-aea5-c303f598f540
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: DATE
        description: ""
        hashDetails: null
        name: MIN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6462ad19-2e3e-40f0-9245-d0c795905f2b
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MIN("VWA_SALES_WEEK"."MIN_DATE")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f851db5-29b0-4cf2-8830-41361134031f
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: DATE
        description: ""
        hashDetails: null
        name: MAX_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8bf6b9b9-fd10-4327-9be0-2e9b4ee96939
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MAX("VWA_SALES_WEEK"."MAX_DATE")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6576af38-6627-4c4b-9e88-9755aa571319
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: BRAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bda11691-1f7d-41c3-bce3-86b39bf0fda7
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MAX("VWA_SALES_WEEK"."BRAND")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84009098-6430-408b-8738-b4b393838925
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL1_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cbc8d8cd-dac2-4c5d-8ea4-f6b29b429a48
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MAX("VWA_SALES_WEEK"."LEVEL1_DESC")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9e6e8ed-98e3-4e4d-a042-440333cd2730
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL2_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 222c33f4-6101-49b0-bfd5-7bfe380789c8
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MAX("VWA_SALES_WEEK"."LEVEL2_DESC")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb93907a-2360-4e5a-9682-527b0c5ce001
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL3_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f91b96d0-4bcf-48b7-ba0c-0d783546b21f
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MAX("VWA_SALES_WEEK"."LEVEL3_DESC")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1fb6043-937e-4462-a6c1-5c63abaa05c9
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL4_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff2c2baa-795a-4898-86e1-665bdbe63281
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MAX("VWA_SALES_WEEK"."LEVEL4_DESC")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f50de81-9fd0-4f01-badd-a403469bf4a8
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL5_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b07323aa-25cc-4db2-8228-6d4fe49949e3
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MAX("VWA_SALES_WEEK"."LEVEL5_DESC")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4d4b5fb-3fe9-4f6e-b56e-5d69e957866b
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: PRODUCT_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b358822-46ac-4a5d-90b7-e4453983c8d4
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MAX("VWA_SALES_WEEK"."PRODUCT_GROUP")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5707bd4-3919-4d8d-bb42-285debb9d3c6
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: PRODUCT_GROUP_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c714790-676d-4d6f-be99-7affe591fffd
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MAX("VWA_SALES_WEEK"."PRODUCT_GROUP_NAME")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17cf73c4-7727-4cc5-9b37-931161f92da1
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        hashDetails: null
        name: PRICE_MIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac9786d9-362d-4056-9b7a-2f5504e8b8c3
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MIN("VWA_SALES_WEEK"."SALES_PRICE")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8a81f87-144e-4b3e-b650-f463d71a81d1
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        hashDetails: null
        name: PRICE_MAX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac9786d9-362d-4056-9b7a-2f5504e8b8c3
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MAX("VWA_SALES_WEEK"."SALES_PRICE")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94d06155-4fa1-4461-becb-3b1508fd645d
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(9,2)
        description: ""
        name: UNITS_BASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fc5ffe4a-25ff-4a70-9916-c3e576281ed6
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."UNITS_BASE")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4ee35e8-40d6-4d96-bd2a-d5eada71e839
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(9,2)
        description: ""
        name: UNITS_SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a174c1fe-3f2c-4361-90c2-cf6fc618da81
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."UNITS_SALES")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c50ba053-886f-45bb-a4e2-b885274b89b1
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(9,2)
        description: ""
        name: UNITS_RETURNS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c658892-732e-4ae4-9620-c361792a555f
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."UNITS_RETURNS")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7956c5d-cc6e-4f6d-b4ac-459065d57ed1
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(9,2)
        description: ""
        name: UNITS_NET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4073ac03-4bc7-47f9-a979-ef664945496c
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."UNITS_NET")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d0d1e8f-9808-48ba-8af8-4bee0a426210
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: AVG_PRICE_ACTUAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9869532d-f474-46d2-b947-1cb40d9a665c
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."AVG_PRICE_ACTUAL")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3034c572-b446-4f58-843f-4f6da24cccb2
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: DECIMAL(15,2)
        description: ""
        name: SALES_ACTUAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2274493b-c56c-4605-baf9-bfd25dda3095
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."SALES_ACTUAL")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0616255c-d60d-4e86-9b25-8ae2f4fb8006
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: DECIMAL(16,2)
        description: ""
        name: SALES_SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 800fd3d7-06b7-4e1f-b004-96f733216c37
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."SALES_SALES")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08f35279-7447-403d-a759-049256a6418d
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: SALES_ACP_TOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65468998-bf57-42e9-9899-8b65c62c6226
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."ACP_TOTAL")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49a9f920-3c6c-4c48-90c7-29cba52e125f
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: UBC_TOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85b11ee6-e949-41e9-8809-7287cb4c8add
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."UBC_TOTAL")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96bf8037-77b4-45da-add1-c9c3c9c11c92
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: SOA_TOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e642f27a-b4ff-48af-94a1-c98b9dfc4563
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."SOA_TOTAL")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56db4296-f9cf-473d-9b54-a6266fd0e1cf
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: TA_TOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a0b19877-9fec-4a27-9e65-1f82095b8687
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."TA_TOTAL")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d01c552-333e-4767-80ea-8ecc7cb45b18
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: COST_TOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d35a9432-aacd-4628-8fa6-9d7a21a0ef15
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."COST_TOTAL")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97568597-be23-4f05-a457-ba1a7e8ef52f
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: MARGIN_TOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a8cc3a4-53ef-462c-aa8b-5bdad2341d85
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."MARGIN_TOTAL")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ed3a082-ba8f-4dcb-af9c-bc2bc06e8c00
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARCHAR(3)
        description: ""
        hashDetails: null
        name: CURRENCY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa60432a-0a31-4492-9ff8-53dbe338d3d5
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MAX("VWA_SALES_WEEK"."CURRENCY_CODE")
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VWA_SALES_WEEK: 7f402997-e110-44d8-9d36-4b44124e7a66
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: VIEWS
            nodeName: VWA_SALES_WEEK
        join:
          joinCondition: |-
            FROM {{ ref('VIEWS', 'VWA_SALES_WEEK') }} "VWA_SALES_WEEK"
            GROUP BY 1, 2, 3
        name: VWA_SALES_YEAR
        noLinkRefs: []
  name: VWA_SALES_YEAR
  overrideSQL: false
  schema: ""
  sqlType: "17"
  type: sql
  version: 1
type: Node
