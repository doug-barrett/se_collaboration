fileVersion: 1
id: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
name: VWA_SALES_YEAR
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: VIEWS
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4542a0d2-7ee6-4b65-b5d3-0dee3c055e6d
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARCHAR(64)
        description: ""
        hashDetails: null
        name: ZONE_GEOGRAPHY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f8e2fa6-dc17-46ee-b538-a98a30c00c1c
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 788a63d1-315f-4b57-99c3-e032e066fc57
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARCHAR(50)
        description: This is the product key
        hashDetails: null
        name: PRODKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ad8725b-1fa4-4995-9ef8-c0dd4fe3f7db
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21fec4ce-c2c9-42fe-9fd0-a6426c3676c1
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARCHAR(10)
        description: ""
        hashDetails: null
        name: FINANCIAL_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 965439c0-11b1-41df-9ae7-cfaf8db8ae6c
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 15f326ac-68b4-496c-aea5-c303f598f540
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: DATE
        description: ""
        hashDetails: null
        name: MIN_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6462ad19-2e3e-40f0-9245-d0c795905f2b
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MIN("VWA_SALES_WEEK"."MIN_DATE")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f851db5-29b0-4cf2-8830-41361134031f
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: DATE
        description: ""
        hashDetails: null
        name: MAX_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8bf6b9b9-fd10-4327-9be0-2e9b4ee96939
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MAX("VWA_SALES_WEEK"."MAX_DATE")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6576af38-6627-4c4b-9e88-9755aa571319
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: BRAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bda11691-1f7d-41c3-bce3-86b39bf0fda7
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MAX("VWA_SALES_WEEK"."BRAND")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 84009098-6430-408b-8738-b4b393838925
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL1_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cbc8d8cd-dac2-4c5d-8ea4-f6b29b429a48
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MAX("VWA_SALES_WEEK"."LEVEL1_DESC")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9e6e8ed-98e3-4e4d-a042-440333cd2730
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL2_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 222c33f4-6101-49b0-bfd5-7bfe380789c8
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MAX("VWA_SALES_WEEK"."LEVEL2_DESC")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb93907a-2360-4e5a-9682-527b0c5ce001
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL3_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f91b96d0-4bcf-48b7-ba0c-0d783546b21f
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MAX("VWA_SALES_WEEK"."LEVEL3_DESC")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e1fb6043-937e-4462-a6c1-5c63abaa05c9
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL4_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ff2c2baa-795a-4898-86e1-665bdbe63281
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MAX("VWA_SALES_WEEK"."LEVEL4_DESC")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f50de81-9fd0-4f01-badd-a403469bf4a8
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: LEVEL5_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b07323aa-25cc-4db2-8228-6d4fe49949e3
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MAX("VWA_SALES_WEEK"."LEVEL5_DESC")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4d4b5fb-3fe9-4f6e-b56e-5d69e957866b
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: PRODUCT_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b358822-46ac-4a5d-90b7-e4453983c8d4
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MAX("VWA_SALES_WEEK"."PRODUCT_GROUP")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b5707bd4-3919-4d8d-bb42-285debb9d3c6
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARCHAR(50)
        description: ""
        hashDetails: null
        name: PRODUCT_GROUP_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c714790-676d-4d6f-be99-7affe591fffd
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MAX("VWA_SALES_WEEK"."PRODUCT_GROUP_NAME")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34372388-c7ab-4f58-aa9f-0965aeaa972c
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARCHAR(150)
        description: ""
        name: PRODKEY_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2445ef95-d23a-4727-bff9-6c18b31f9d49
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MAX("VWA_SALES_WEEK"."PRODKEY_DESCRIPTION")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c6ac083-6b2f-4277-94f8-954afd5ccf6e
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: STRING
        description: ""
        name: PRICE_CATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 85b38936-77f6-455e-a8d4-37078e433122
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MAX("VWA_SALES_WEEK"."PRICE_CATEGORY")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70c8d11c-f295-4e7e-985c-cd44094033aa
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: STRING
        description: ""
        name: VOLUME_CATEGORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22250dba-ae84-43bb-8d6d-deaf9143955f
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MAX("VWA_SALES_WEEK"."VOLUME_CATEGORY")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20b8f2b0-37e3-4eef-8155-4fd43d2c4b59
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: STRING
        description: ""
        name: MA_CAT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b9ff8f2-660b-470e-9e92-f1adc61b5c85
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MAX("VWA_SALES_WEEK"."MA_CAT")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17cf73c4-7727-4cc5-9b37-931161f92da1
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        hashDetails: null
        name: PRICE_MIN
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65d80138-d0df-4595-9d26-5542155146ce
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MIN("VWA_SALES_WEEK"."PRICE")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8a81f87-144e-4b3e-b650-f463d71a81d1
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        hashDetails: null
        name: PRICE_MAX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 65d80138-d0df-4595-9d26-5542155146ce
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MAX("VWA_SALES_WEEK"."PRICE")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d0d1e8f-9808-48ba-8af8-4bee0a426210
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: AVG_PRICE_ACTUAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bbb007f2-0c72-4a88-9853-6f4440aab337
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: AVG("VWA_SALES_WEEK"."AVG_PRICE_ACTUAL")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ff40142d-04a7-416a-902e-f3ab6294e209
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARIANT
        description: ""
        name: PROMO_LIST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7b0677a-4bd1-458f-897a-4f2d1aa0c81b
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: ARRAY_DISTINCT(ARRAY_FLATTEN(ARRAY_UNIQUE_AGG("VWA_SALES_WEEK"."PROMO_LIST")))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: edda73a4-7e14-487d-b0a6-75d04e6ee31c
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER
        description: ""
        name: PROMO_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7b0677a-4bd1-458f-897a-4f2d1aa0c81b
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: ARRAY_SIZE(ARRAY_DISTINCT(ARRAY_FLATTEN(ARRAY_UNIQUE_AGG("VWA_SALES_WEEK"."PROMO_LIST"))))
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 94d06155-4fa1-4461-becb-3b1508fd645d
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(9,2)
        description: ""
        name: UNITS_BASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f9314385-b435-4c03-8b60-da3cc7e55761
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."UNITS_BASE")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b7956c5d-cc6e-4f6d-b4ac-459065d57ed1
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(9,2)
        description: ""
        name: UNITS_NET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76cf4dba-2e73-4a1a-a810-ec2896f02212
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."UNITS_NET")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a77f05d7-6a83-452e-bef3-885b453baf7d
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: UNITS_NET_BASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 56456a8d-79e8-4c3b-b36a-45132a032129
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."UNITS_NET_BASE")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cffc4e14-eed8-4cf7-a9d6-12d2998adbe4
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: UNITS_NET_PROMO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84f639b3-8f12-4815-986f-ef008644135b
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."UNITS_NET_PROMO")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 114853c2-87c7-48b3-a837-b12e20dd0238
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: UNITS_UPLIFT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51b2ba16-0802-491e-9138-df5eb4d3af18
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."UNITS_UPLIFT")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e20a6ae8-7bdb-4630-9b37-33b017b7d1ec
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: SALES_BASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0604f5e5-61a1-4149-bc6d-42021f0de7bc
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."SALES_BASE")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3034c572-b446-4f58-843f-4f6da24cccb2
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: DECIMAL(15,2)
        description: ""
        name: SALES_NET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9acfb195-7a53-4621-9d31-1b8850cab43a
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."SALES_NET")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2ae82b6c-6986-495b-9c19-4ed4dc6776ac
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: SALES_NET_BASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed1c1898-23ef-40fe-ae2d-baa31d1b4caa
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."SALES_NET_BASE")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2b4fc88-6a7c-4747-92e5-5688a46deef0
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: SALES_NET_PROMO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ac7818a-d732-49ec-99da-c3ebdb3bf4ca
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."SALES_NET_PROMO")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b36cda2a-ec52-4c06-a9f6-4c3c1552ed7e
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: SALES_UPLIFT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 889cc8c7-977b-48e0-8d37-71930ca60371
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."SALES_UPLIFT")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08f35279-7447-403d-a759-049256a6418d
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: ACP_TOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 904defa3-c575-4f86-aa72-30776797ed48
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."ACP_TOTAL")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49a9f920-3c6c-4c48-90c7-29cba52e125f
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: UBC_TOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e071436-d55d-4738-9a08-6604f9d14ac4
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."UBC_TOTAL")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96bf8037-77b4-45da-add1-c9c3c9c11c92
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: SOA_TOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5161230b-899b-46f1-9883-b3990d20cdd2
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."SOA_TOTAL")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 85aad8be-4430-46c8-a805-790a4a5c7d0a
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: RETAILER_SOA_TOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b868e22b-5e2d-4a4c-b729-ce60eb58bb77
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."RETAILER_SOA_TOTAL")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56db4296-f9cf-473d-9b54-a6266fd0e1cf
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: TA_TOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fdea0f90-6619-45bd-bade-02d6c0acc067
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."TA_TOTAL")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d01c552-333e-4767-80ea-8ecc7cb45b18
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: COST_TOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0828d869-a8ba-436a-a96a-17b09c433f9b
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."COST_TOTAL")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08fec728-641f-45d5-bf05-e3df7397bdff
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: MARGIN_BASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7002690-a77b-4b08-ba48-789efb9e190f
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."MARGIN_BASE")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97568597-be23-4f05-a457-ba1a7e8ef52f
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: MARGIN_NET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7dc11d06-b9dd-46ce-9f62-fbd63438c586
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."MARGIN_NET")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e56484c-eadc-4d76-a4ce-f680b70827a2
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: MARGIN_NET_BASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d70f3949-3765-4f1f-83b3-0cc3c68eea01
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."MARGIN_NET_BASE")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 64f06ac0-28e9-4bdf-941a-cfe9bcb02c19
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: MARGIN_NET_PROMO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4573d196-9447-4ecd-8278-5285c913b877
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."MARGIN_NET_PROMO")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0f57cc8-eb8c-4477-b0c8-2785f7bc0320
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: MARGIN_UPLIFT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20d0dbce-fb57-4796-b747-315fa254ca18
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: SUM("VWA_SALES_WEEK"."MARGIN_UPLIFT")
      - acceptedValues:
          strictMatch: false
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: a81f6770-07e8-4610-b48f-1cb1da2006dc
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(9,2)
        description: ""
        name: MARGIN_PERCENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 100e71fa-74a6-47df-9f68-9453cedfc984
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: AVG("VWA_SALES_WEEK"."MARGIN_PERCENT")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38c6fc3d-3a63-4406-852d-0e4fbc23e7c4
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: FINANCIAL_YEAR_PREVIOUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a14c9865-1757-4e9a-9587-c9e768995138
                stepCounter: e9f56218-8000-43fc-94f6-68916bbb21a9
            transform: MAX("STG_MEASURES_TODAY_LY"."FINANCIAL_YEAR_PREVIOUS")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e2e1a14-6cf1-49c5-9471-110e2a450dcf
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: DATE
        description: ""
        name: TODAY_LAST_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50c438e8-9f5d-4ad2-b9b0-408a3ed56c75
                stepCounter: e9f56218-8000-43fc-94f6-68916bbb21a9
            transform: MAX("STG_MEASURES_TODAY_LY"."TODAY_LAST_YEAR")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 065f88ae-5b12-4ce3-996d-fd04b16cbac1
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: LAST_YEAR_UNITS_BASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a83f6182-3390-41ab-99e1-68f294059fdd
                stepCounter: e9f56218-8000-43fc-94f6-68916bbb21a9
            transform: MAX("STG_MEASURES_TODAY_LY"."LAST_YEAR_UNITS_BASE")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7924dff7-3aea-4b98-b4bf-b2915078f1af
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: LAST_YEAR_UNITS_NET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4058f172-fbb4-4e4b-9780-df442782e66f
                stepCounter: e9f56218-8000-43fc-94f6-68916bbb21a9
            transform: MAX("STG_MEASURES_TODAY_LY"."LAST_YEAR_UNITS_NET")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e6ce4e2-76a5-46b9-81e8-e2f706b622c6
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: LAST_YEAR_UNITS_NET_BASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d04d58c9-fb2d-496f-9386-cb74c53b8245
                stepCounter: e9f56218-8000-43fc-94f6-68916bbb21a9
            transform: MAX("STG_MEASURES_TODAY_LY"."LAST_YEAR_UNITS_NET_BASE")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0399f029-2149-4fe8-8b18-84055008dbe8
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: LAST_YEAR_UNITS_NET_PROMO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f44f9348-af3d-43c8-842f-33d08f432058
                stepCounter: e9f56218-8000-43fc-94f6-68916bbb21a9
            transform: MAX("STG_MEASURES_TODAY_LY"."LAST_YEAR_UNITS_NET_PROMO")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66ba52f6-0d47-417c-b448-556c1d40e32b
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: LAST_YEAR_UNITS_UPLIFT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ef5a8bb-0440-4188-b82c-fb6380a6c278
                stepCounter: e9f56218-8000-43fc-94f6-68916bbb21a9
            transform: MAX("STG_MEASURES_TODAY_LY"."LAST_YEAR_UNITS_UPLIFT")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 868e219f-b3c9-4520-b29d-f961870e6104
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: LAST_YEAR_SALES_BASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e267a5fe-a7f1-4a5e-baf3-17d7ef90fac0
                stepCounter: e9f56218-8000-43fc-94f6-68916bbb21a9
            transform: MAX("STG_MEASURES_TODAY_LY"."LAST_YEAR_SALES_BASE")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a38b2970-ddf6-4fd8-b3a3-31b22e384559
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: LAST_YEAR_SALES_NET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef89894f-31d2-4407-af8c-856a398f2c50
                stepCounter: e9f56218-8000-43fc-94f6-68916bbb21a9
            transform: MAX("STG_MEASURES_TODAY_LY"."LAST_YEAR_SALES_NET")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a95234d-4d62-4fe2-a5a9-596ac628924f
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: LAST_YEAR_SALES_NET_BASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9de8d805-cdd9-4957-860f-9651fe601e19
                stepCounter: e9f56218-8000-43fc-94f6-68916bbb21a9
            transform: MAX("STG_MEASURES_TODAY_LY"."LAST_YEAR_SALES_NET_BASE")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36e69ce1-9ec7-47b6-a42a-50ac0261f594
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: LAST_YEAR_SALES_NET_PROMO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b7894f08-96a0-4b7f-a5a3-c9d8970928ae
                stepCounter: e9f56218-8000-43fc-94f6-68916bbb21a9
            transform: MAX("STG_MEASURES_TODAY_LY"."LAST_YEAR_SALES_NET_PROMO")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 30e95948-e3b9-453c-803c-8cde72c1dbae
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: LAST_YEAR_SALES_UPLIFT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33e1464c-f9f1-4774-821a-50e455bcbc0e
                stepCounter: e9f56218-8000-43fc-94f6-68916bbb21a9
            transform: MAX("STG_MEASURES_TODAY_LY"."LAST_YEAR_SALES_UPLIFT")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 227cac44-4bd5-4d12-9602-23a1b3c915de
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: LAST_YEAR_COST_TOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ece41d65-b90b-4aaa-a3c3-630cbdf2d3a6
                stepCounter: e9f56218-8000-43fc-94f6-68916bbb21a9
            transform: MAX("STG_MEASURES_TODAY_LY"."LAST_YEAR_COST_TOTAL")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e6a879b-e00b-4abb-b193-0aa99bf86826
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: LAST_YEAR_MARGIN_BASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f779ce75-75bf-4e1c-86df-25477f656c4b
                stepCounter: e9f56218-8000-43fc-94f6-68916bbb21a9
            transform: MAX("STG_MEASURES_TODAY_LY"."LAST_YEAR_MARGIN_BASE")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e2ec5763-6ff8-46f7-8df8-2559ba042717
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: LAST_YEAR_MARGIN_NET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 689d0bea-f708-4abb-8157-edf748a253e7
                stepCounter: e9f56218-8000-43fc-94f6-68916bbb21a9
            transform: MAX("STG_MEASURES_TODAY_LY"."LAST_YEAR_MARGIN_NET")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25627d81-a20a-48eb-adf7-ee5de4368220
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: LAST_YEAR_MARGIN_NET_BASE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2018ae8e-11ef-4800-8750-19b822b91d85
                stepCounter: e9f56218-8000-43fc-94f6-68916bbb21a9
            transform: MAX("STG_MEASURES_TODAY_LY"."LAST_YEAR_MARGIN_NET_BASE")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f8eae19d-4a78-4012-9fe4-1331712c1b28
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: LAST_YEAR_MARGIN_NET_PROMO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6d10f75-a08d-4674-881e-2ae6081bd0bd
                stepCounter: e9f56218-8000-43fc-94f6-68916bbb21a9
            transform: MAX("STG_MEASURES_TODAY_LY"."LAST_YEAR_MARGIN_NET_PROMO")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 355f3df4-ae1b-4566-bc7a-876d20556c82
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: LAST_YEAR_MARGIN_UPLIFT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ccae5c9-2622-4eba-a222-dd0f5e02750c
                stepCounter: e9f56218-8000-43fc-94f6-68916bbb21a9
            transform: MAX("STG_MEASURES_TODAY_LY"."LAST_YEAR_MARGIN_UPLIFT")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 925aec95-bd7d-4d74-a472-29263b0a9fb4
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: LAST_YEAR_SOA_TOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a26ed88-6e69-42c6-8f5b-b5ff8fc30e79
                stepCounter: e9f56218-8000-43fc-94f6-68916bbb21a9
            transform: MAX("STG_MEASURES_TODAY_LY"."LAST_YEAR_SOA_TOTAL")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1017742c-49cc-4b76-96d8-d94138c5c9df
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: LAST_YEAR_RETAILER_SOA_TOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 64db9342-065f-4466-8573-9b00577d72ae
                stepCounter: e9f56218-8000-43fc-94f6-68916bbb21a9
            transform: MAX("STG_MEASURES_TODAY_LY"."LAST_YEAR_RETAILER_SOA_TOTAL")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01ae2f4c-c853-4e1b-9960-d170ecc25bca
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: NUMBER
        description: ""
        name: LAST_YEAR_PROMO_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b643b5cd-c73e-492d-b5b4-1306ba2d9e09
                stepCounter: e9f56218-8000-43fc-94f6-68916bbb21a9
            transform: MAX("STG_MEASURES_TODAY_LY"."LAST_YEAR_PROMO_COUNT")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ed3a082-ba8f-4dcb-af9c-bc2bc06e8c00
          stepCounter: bec5d59f-15c2-42e4-a204-03ea8ab70b1d
        config: {}
        dataType: VARCHAR(3)
        description: ""
        hashDetails: null
        name: CURRENCY_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa60432a-0a31-4492-9ff8-53dbe338d3d5
                stepCounter: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
            transform: MAX("VWA_SALES_WEEK"."CURRENCY_CODE")
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_MEASURES_TODAY_LY: e9f56218-8000-43fc-94f6-68916bbb21a9
          VWA_SALES_WEEK: dd9b9c00-5f8a-4b18-9272-236e6bdacf28
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: STAGE
            nodeName: STG_MEASURES_TODAY_LY
          - locationName: VIEWS
            nodeName: VWA_SALES_WEEK
        join:
          joinCondition: |-
            FROM {{ ref('VIEWS', 'VWA_SALES_WEEK') }} "VWA_SALES_WEEK"
            LEFT JOIN {{ ref('STAGE', 'STG_MEASURES_TODAY_LY') }} "STG_MEASURES_TODAY_LY"
            ON "VWA_SALES_WEEK"."ZONE_GEOGRAPHY" = "STG_MEASURES_TODAY_LY"."ZONE_GEOGRAPHY"
            AND "VWA_SALES_WEEK"."PRODKEY" = "STG_MEASURES_TODAY_LY"."PRODKEY"
            GROUP BY 1, 2, 3
        name: VWA_SALES_YEAR
        noLinkRefs: []
  name: VWA_SALES_YEAR
  overrideSQL: false
  schema: ""
  sqlType: "17"
  type: sql
  version: 1
type: Node
