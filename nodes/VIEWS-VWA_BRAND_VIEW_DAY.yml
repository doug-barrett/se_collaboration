fileVersion: 1
id: c80ab2b1-95bb-4596-abb8-ea3287b00793
name: VWA_BRAND_VIEW_DAY
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: VIEWS
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7cca46c2-fcaa-44af-8297-3e18b21858fe
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: DATE
        description: ""
        hashDetails: null
        name: SCRAPE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1b4cfdc-3c71-447e-9020-8dbf4d44ec4d
                stepCounter: 80a6e55c-d942-4309-91f9-8e7e0ff216c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 355f0a66-d81e-4fdf-bb4c-998cdeed4b53
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: VARCHAR(64)
        description: ""
        hashDetails: null
        name: ZONE_GEOGRAPHY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4863dd9c-9a24-4970-96a6-309e2fa61c22
                stepCounter: 80a6e55c-d942-4309-91f9-8e7e0ff216c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77161401-a485-43d8-b189-10275a925163
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: VARCHAR(10)
        description: ""
        hashDetails: null
        name: PRODKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bfd20a9b-f217-440a-aaa1-6dfb0a94c86d
                stepCounter: 80a6e55c-d942-4309-91f9-8e7e0ff216c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c02dd966-343c-46cc-a55a-daf7ff21b9e3
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: VARCHAR(100)
        description: ""
        name: DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2d81a47d-111e-4220-ba8c-8001784f1dfd
                stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6cbb6649-cee2-4566-bf79-068c1a87cb52
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: BRAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44ec9c8f-f896-42cb-9436-1c15d0e43c48
                stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a14e0bc-1106-4790-a0ee-52a8b820e21c
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: LEVEL1_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9267fd6e-e1a5-46c9-b5d0-9ba356c370b9
                stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dfd2f9bb-3960-4186-a009-98ce5faaea8d
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: LEVEL2_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0067af8f-65e3-40b3-94f6-ba83ff100402
                stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3338bee3-bfa4-4a18-b4bb-3e58e286ea6e
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: LEVEL3_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d51521a9-8a90-4dce-ac03-335f02066694
                stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 323a73e9-3c42-4995-aa5b-4bcfe8609028
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: LEVEL4_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f7020e6-6fe3-441c-8476-cce6609cdc5d
                stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73fea63b-5d48-4ee2-a530-d8ece67a531e
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: LEVEL5_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d98d3125-e0ee-48d6-9390-7a135d41688e
                stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9d62b344-8131-4d16-b3a8-2d7554640ec7
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: PRODUCT_GROUP_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 25fb8aed-aa37-4c23-9015-28d05ccb99d0
                stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 90c6c8d3-ba32-40e8-8ae9-655202a1ddac
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: PRODUCT_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc6461e9-2b68-4c0d-bf9f-11f3e1b62ee1
                stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2fa831e9-e301-44a1-a199-fc3f7cb189cc
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: VARCHAR(64)
        description: ""
        name: EVENT_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7aa25db0-db5d-48e3-abd7-7f4096829c6a
                stepCounter: 80a6e55c-d942-4309-91f9-8e7e0ff216c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 252b8d41-5eb4-4d6e-aa53-797f795ad0bb
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: VARCHAR(64)
        description: ""
        name: WAS_NOW
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eba34a45-0c52-4478-95a8-2270425effe4
                stepCounter: 80a6e55c-d942-4309-91f9-8e7e0ff216c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebdc7cf0-f0ec-4e50-ba6a-c128b73ce267
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68b60afb-0469-4392-92d0-46e570adae56
                stepCounter: 80a6e55c-d942-4309-91f9-8e7e0ff216c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 323176e2-24df-44aa-a108-f9e0cf9998b6
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: PRIOR_CPI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 67e88399-95e0-4b55-867b-e75f6a88ce09
                stepCounter: fefb74e9-0edf-4b30-9f9c-b336c99bf5b5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5c26f35-fcb7-47b1-b5ea-961def412441
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: CPI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68b60afb-0469-4392-92d0-46e570adae56
                stepCounter: 80a6e55c-d942-4309-91f9-8e7e0ff216c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6149fae-2344-420b-836e-0b3d74551c66
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        hashDetails: null
        name: COMPETITOR_MIN_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4aab10f2-1d67-4ed4-989a-3fe52f3ec6a9
                stepCounter: 80a6e55c-d942-4309-91f9-8e7e0ff216c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98b4d047-a698-4ea0-a4be-61266011fa6f
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        hashDetails: null
        name: COMPETITOR_MAX_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb62f712-9d93-4e9a-b377-19fe3020eb73
                stepCounter: 80a6e55c-d942-4309-91f9-8e7e0ff216c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86aa8d38-49ba-493f-be0d-20a15fd812e2
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: STRING
        description: ""
        hashDetails: null
        name: COMPETITOR_SUMMARY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1759fcd6-6f97-4189-89ee-c2f11c46ad42
                stepCounter: 80a6e55c-d942-4309-91f9-8e7e0ff216c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b31cb628-82b1-4224-9abf-30c7adb654a1
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: STRING
        description: ""
        hashDetails: null
        name: COMPETITORS_CHEAPER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3658894-7e45-4adf-a370-b11b8f624ad8
                stepCounter: 80a6e55c-d942-4309-91f9-8e7e0ff216c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0536154c-97ba-4e9c-9b99-efd9e1d9b54e
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: STRING
        description: ""
        name: CPI_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bddb2194-85b0-43cd-9c15-8192be5dbdab
                stepCounter: fefb74e9-0edf-4b30-9f9c-b336c99bf5b5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3aca27b3-ae9a-4cbd-96f1-2d2c1d2a0303
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: STRING
        description: ""
        name: PRICE_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 14162742-a488-4300-9fc0-312abdf5309d
                stepCounter: fefb74e9-0edf-4b30-9f9c-b336c99bf5b5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d60d65c1-003f-4078-9f9c-ba3b5368735e
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: CHAR(1)
        description: ""
        name: CURRY_CHEAPEST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a0fb724-1d80-43ea-8310-f642483a34d7
                stepCounter: fefb74e9-0edf-4b30-9f9c-b336c99bf5b5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5d6958d-60c3-4779-88ba-dec08d81fea8
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: CHAR(1)
        description: ""
        name: CURRY_CHEAPEST1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ee56818-2a11-4294-a407-2c424191111a
                stepCounter: fefb74e9-0edf-4b30-9f9c-b336c99bf5b5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2bed4000-5c0f-496c-b36d-ffdbf585fa20
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: CHAR(1)
        description: ""
        name: CURRY_CHEAPEST2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0422e717-e0b7-4600-aa97-a8f74216e812
                stepCounter: fefb74e9-0edf-4b30-9f9c-b336c99bf5b5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5e5dbb9-d51d-496c-a198-118197a8f2cb
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: CHAR(1)
        description: ""
        name: CURRY_CHEAPEST3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5edc231a-165c-4b21-b4c4-de6c74dce73f
                stepCounter: fefb74e9-0edf-4b30-9f9c-b336c99bf5b5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11fc64ae-0b1e-4bf4-8737-b257a3c8c0b0
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: CHAR(1)
        description: ""
        name: CURRY_CHEAPEST4
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e1310af4-52de-4aa5-92ca-9415f43fe7c7
                stepCounter: fefb74e9-0edf-4b30-9f9c-b336c99bf5b5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0c475d6-cfe1-447e-9e89-b3dddc349a76
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: CHAR(1)
        description: ""
        name: CURRY_CHEAPEST5
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 318063b9-1a52-4658-af7f-d1faeb85f878
                stepCounter: fefb74e9-0edf-4b30-9f9c-b336c99bf5b5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3f00ed2-f735-4626-8c34-24492e5acd21
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: CHAR(1)
        description: ""
        name: CURRY_CHEAPEST6
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dac6b225-146e-4eda-9cf3-8ded83ccaa33
                stepCounter: fefb74e9-0edf-4b30-9f9c-b336c99bf5b5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8c0541c-b681-4f8b-8124-361ce87d9977
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: CHAR(1)
        description: ""
        name: CURRY_CHEAPEST7
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: daf07b97-74d6-4d07-8401-c3ebb72e5ef0
                stepCounter: fefb74e9-0edf-4b30-9f9c-b336c99bf5b5
            transform: ""
      - acceptedValues:
          strictMatch: false
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 3160a3fc-dbea-4b2a-9e7a-630a56a9cd1f
          stepCounter: c80ab2b1-95bb-4596-abb8-ea3287b00793
        config: {}
        dataType: VARCHAR(150)
        description: ""
        name: PRODKEY_DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e81eae71-3703-4de6-a1fc-40c8c8a121ad
                stepCounter: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          FCT_BRAND_VIEW_DAY: 80a6e55c-d942-4309-91f9-8e7e0ff216c8
          VWA_PRODUCT: 0813ddc0-613c-4ce4-bce8-0a10ec464af8
          VW_BRAND_VIEW_DAY_HISTORY: fefb74e9-0edf-4b30-9f9c-b336c99bf5b5
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATA
            nodeName: FCT_BRAND_VIEW_DAY
          - locationName: STAGE
            nodeName: VW_BRAND_VIEW_DAY_HISTORY
          - locationName: VIEWS
            nodeName: VWA_PRODUCT
        join:
          joinCondition: |-
            FROM {{ ref('DATA', 'FCT_BRAND_VIEW_DAY') }} "FCT_BRAND_VIEW_DAY"
            INNER JOIN {{ ref('VIEWS', 'VWA_PRODUCT') }} "VWA_PRODUCT"
            ON "FCT_BRAND_VIEW_DAY"."PRODKEY" = "VWA_PRODUCT"."PRODKEY"
            LEFT JOIN {{ ref('STAGE', 'VW_BRAND_VIEW_DAY_HISTORY') }} "VW_BRAND_VIEW_DAY_HISTORY"
            ON "FCT_BRAND_VIEW_DAY"."ZONE_GEOGRAPHY" = "VW_BRAND_VIEW_DAY_HISTORY"."ZONE_GEOGRAPHY"
            AND "FCT_BRAND_VIEW_DAY"."PRODKEY" = "VW_BRAND_VIEW_DAY_HISTORY"."PRODKEY"
            AND "FCT_BRAND_VIEW_DAY"."SCRAPE_DATE" = "VW_BRAND_VIEW_DAY_HISTORY"."SCRAPE_DATE"
        name: VWA_BRAND_VIEW_DAY
        noLinkRefs: []
  name: VWA_BRAND_VIEW_DAY
  overrideSQL: false
  schema: ""
  sqlType: "17"
  type: sql
  version: 1
type: Node
