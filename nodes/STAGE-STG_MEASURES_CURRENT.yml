fileVersion: 1
id: 6deaf504-e80c-4050-810f-1e356357d18c
name: STG_MEASURES_CURRENT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 34ae1ad3-ec61-43b0-8c91-33e6c9dbddda
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: DATA_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CURRENT_DATE
        systemColumnType: None
        transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e186cce5-bdea-4e7a-9e44-daedbef819e5
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: VARCHAR(64)
        description: ""
        hashDetails: null
        name: ZONE_GEOGRAPHY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 490d543b-73bd-4111-8f88-d6aeff6efb96
                stepCounter: 41d8ed72-6fb3-42ea-81a6-626898e8c162
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb99dfad-955b-49f2-8278-635070b9b45f
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: VARCHAR(50)
        description: This is the product key
        hashDetails: null
        name: PRODKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48edbb8c-c9d5-46e8-8518-597b4a2d6be0
                stepCounter: 41d8ed72-6fb3-42ea-81a6-626898e8c162
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49962a5f-2b34-4c9c-9f56-6189dc1b70c9
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: LEVEL1_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48a82910-6386-46e0-b072-3c89965cb3c1
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 412cdb4e-d422-4f8c-baa0-f58da19841df
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: LEVEL2_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 850983c0-90a9-4640-84e8-e8ae587b9e5a
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b28fa242-cbd5-4b0d-ad25-28e728ee54cd
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: LEVEL3_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76b80dd0-990c-439c-9b2a-f320fd772670
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 430e3662-4806-409a-bdd7-d1f73fdd41e3
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: LEVEL4_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81d483bb-5578-4211-bed7-6f59f0e33c08
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4a3be85e-570e-44f9-9289-516eb13141e6
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: LEVEL5_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66c9a231-f431-4a57-94fd-11de9bccdfda
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c158f9b5-1f93-40cc-8d64-3d3e80f709ad
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: CURRENT_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3348fb2a-e7fb-4b59-b7da-510338bd86c2
                stepCounter: 72a0e5a7-a669-4c2e-810c-418edf46939a
            transform: VW_PRICE_COST_REGION_CURRENT.PRICE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e994b06-fddc-40bb-bd36-85e73d80eaad
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: DATE
        description: ""
        name: BASE_START_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 017c9265-ae17-48aa-a4f8-3a2d8bd9ac43
                stepCounter: f754b968-8ad1-4d4e-9086-9c91f6ae625b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 075726a5-88b1-4dd5-8ae2-a10d0985984e
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: DATE
        description: ""
        name: BASE_END_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f227176-7c60-40b1-822f-2f58775ab5f6
                stepCounter: f754b968-8ad1-4d4e-9086-9c91f6ae625b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba045882-472a-4769-b634-2dbe834eb57e
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        hashDetails: null
        name: BASE_MODE_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7c5dea34-eebc-4d89-ba68-3461b9aee19e
                stepCounter: f754b968-8ad1-4d4e-9086-9c91f6ae625b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80a169d4-2b34-4b5b-b161-2a6ca1d67ab7
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: NUMBER(9,2)
        description: ""
        hashDetails: null
        name: BASE_UNITS_PER_DAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a544ff74-8a73-4e40-92d8-72057cdb0049
                stepCounter: f754b968-8ad1-4d4e-9086-9c91f6ae625b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b5f427d-9116-4e66-a951-f4b8f71a7044
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: NUMBER(9,2)
        description: ""
        hashDetails: null
        name: BASE_UNITS_PER_DAY_AVG_PG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a544ff74-8a73-4e40-92d8-72057cdb0049
                stepCounter: f754b968-8ad1-4d4e-9086-9c91f6ae625b
            transform: AVG("VW_MEASURES_BASE"."BASE_UNITS_PER_DAY") OVER (PARTITION BY VW_MEASURES_BASE."ZONE_GEOGRAPHY", DIM_PRODUCT.LEVEL4_DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29ad4d5a-ab48-49aa-a8ae-be041193a2ec
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: BASE_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3348fb2a-e7fb-4b59-b7da-510338bd86c2
                stepCounter: 72a0e5a7-a669-4c2e-810c-418edf46939a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3376521-4803-4a02-8e46-8939dd064503
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: BASE_COST_PER_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62d6d74e-9d9a-465f-9a24-747c553bcd4d
                stepCounter: 72a0e5a7-a669-4c2e-810c-418edf46939a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 657e6492-50f9-4103-a79e-ca9289064b86
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: BASE_MARGIN_PER_UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52ee017b-4c40-4810-850a-c5103c4ea7af
                stepCounter: 72a0e5a7-a669-4c2e-810c-418edf46939a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a327b01f-2e38-470c-a272-e9e8c428bd2a
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: DATE
        description: ""
        name: YEAR_FROM_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8f0cd12-4eb2-4856-bacf-acbce685bf5e
                stepCounter: 41d8ed72-6fb3-42ea-81a6-626898e8c162
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 835e7bb6-274b-46f3-bf51-45de444e2d1d
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: DATE
        description: ""
        name: YEAR_TO_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e832baac-0584-4cdf-9e64-9243337332ac
                stepCounter: 41d8ed72-6fb3-42ea-81a6-626898e8c162
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e59a2726-2f47-4449-8cb9-856491846d5a
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: DATE
        description: ""
        name: LAST_SOLD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5033f88-a97c-486a-b8fc-fa474e9d59dd
                stepCounter: 41d8ed72-6fb3-42ea-81a6-626898e8c162
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b04efa35-bb2b-4b08-be56-8456f9fa9cf6
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: YEAR_MAX_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a78922f9-6754-4647-97e4-6ed59dc290c0
                stepCounter: 41d8ed72-6fb3-42ea-81a6-626898e8c162
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f52655d-23c3-4b40-875b-f68ab718e06b
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: YEAR_MIN_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e42f5241-83ae-4c76-8c15-c8f3f6155d5b
                stepCounter: 41d8ed72-6fb3-42ea-81a6-626898e8c162
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0287ec1-4ec4-4bf5-82a3-4b99c754b78c
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: YEAR_MODE_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6610a292-f90e-4448-9c4c-19b37a6b2248
                stepCounter: 41d8ed72-6fb3-42ea-81a6-626898e8c162
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20df9c70-109d-44ce-be35-13681cf3cfa0
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: NUMBER(9,2)
        description: ""
        name: YEAR_MAX_UNITS_SALES_PER_DAY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f3859fe1-51f9-41f6-925a-49490a4fe02d
                stepCounter: 41d8ed72-6fb3-42ea-81a6-626898e8c162
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac508e91-02f4-4a02-b190-ce15b08fd348
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: NUMBER(9,2)
        description: ""
        name: YEAR_UNITS_SALES_TOTAL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ed2aea9-de1d-456d-a2fa-aab27abcc4b8
                stepCounter: 41d8ed72-6fb3-42ea-81a6-626898e8c162
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da21ae07-52b3-4942-9a61-482d9151cf3c
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: MAX_FINANCIAL_YYWW
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71fee208-f700-49c7-90e1-defcdd0229e7
                stepCounter: 7ab06a70-1649-455d-a7ff-cc16a3570ab6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17380676-2f9f-4f43-8f3c-31c86be747f7
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: NUMBER(9,2)
        description: ""
        name: MAX_UNITS_SALES
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0352b90f-55ed-4b02-aeb0-fffe3e3e687d
                stepCounter: 7ab06a70-1649-455d-a7ff-cc16a3570ab6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83e90c6b-7238-42a3-bdef-329f4d41fa34
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68b60afb-0469-4392-92d0-46e570adae56
                stepCounter: 80a6e55c-d942-4309-91f9-8e7e0ff216c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4ccce4f-5cd3-49a2-8f32-45b806b2b7bb
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        name: CPI
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a31fb7a9-8aa1-48aa-9c86-d86c1b99ae76
                stepCounter: 80a6e55c-d942-4309-91f9-8e7e0ff216c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5e9c497-d859-45fd-9616-20ab4b168736
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: CHAR(1)
        description: ""
        name: CURRY_CHEAPEST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1600eaa-8433-4554-a420-462f72c97a5f
                stepCounter: 80a6e55c-d942-4309-91f9-8e7e0ff216c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0137c1c7-77f5-4096-9504-1eb036ceb1b2
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: COMPETITOR_MIN_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4aab10f2-1d67-4ed4-989a-3fe52f3ec6a9
                stepCounter: 80a6e55c-d942-4309-91f9-8e7e0ff216c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0821b210-18cc-4b34-af24-d892a03d2645
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: COMPETITOR_MAX_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb62f712-9d93-4e9a-b377-19fe3020eb73
                stepCounter: 80a6e55c-d942-4309-91f9-8e7e0ff216c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af6d7d65-b7c3-4254-b459-8a11f8b3fd0e
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: STRING
        description: ""
        name: COMPETITOR_SUMMARY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1759fcd6-6f97-4189-89ee-c2f11c46ad42
                stepCounter: 80a6e55c-d942-4309-91f9-8e7e0ff216c8
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5f2a3bd4-2ef0-4157-8b04-eaaee0234d69
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: STRING
        description: ""
        name: COMPETITORS_CHEAPER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3658894-7e45-4adf-a370-b11b8f624ad8
                stepCounter: 80a6e55c-d942-4309-91f9-8e7e0ff216c8
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: d81e08fc-da9a-40c8-9db4-33afc2e502cc
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: PRICE_NTILE3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3348fb2a-e7fb-4b59-b7da-510338bd86c2
                stepCounter: 72a0e5a7-a669-4c2e-810c-418edf46939a
            transform: |-
              NTILE(3) OVER (PARTITION BY "VW_MEASURES_YEAR_SUMMARY"."ZONE_GEOGRAPHY", "DIM_PRODUCT".LEVEL3_DESC
              ORDER BY "VW_MEASURES_YEAR_SUMMARY"."YEAR_MODE_PRICE" DESC)
        systemColumnType: None
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 97a53874-c4c5-418e-829d-4f6191d0e365
          stepCounter: 6deaf504-e80c-4050-810f-1e356357d18c
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: VOLUME_NTILE3
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1ed2aea9-de1d-456d-a2fa-aab27abcc4b8
                stepCounter: 41d8ed72-6fb3-42ea-81a6-626898e8c162
            transform: |-
              NTILE(3) OVER (PARTITION BY "VW_MEASURES_YEAR_SUMMARY"."ZONE_GEOGRAPHY", "DIM_PRODUCT".LEVEL3_DESC
              ORDER BY VW_MEASURES_YEAR_SUMMARY."YEAR_UNITS_SALES_TOTAL" DESC)
        systemColumnType: None
        transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_PRODUCT: 99510b9e-1d3e-4709-93b8-2042202093b0
          FCT_BRAND_VIEW_DAY: 80a6e55c-d942-4309-91f9-8e7e0ff216c8
          VW_MEASURES_BASE: f754b968-8ad1-4d4e-9086-9c91f6ae625b
          VW_MEASURES_MAX_VOL: 7ab06a70-1649-455d-a7ff-cc16a3570ab6
          VW_MEASURES_YEAR_SUMMARY: 41d8ed72-6fb3-42ea-81a6-626898e8c162
          VW_PRICE_COST_REGION: 72a0e5a7-a669-4c2e-810c-418edf46939a
          VW_PRICE_COST_REGION_CURRENT: 72a0e5a7-a669-4c2e-810c-418edf46939a
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATA
            nodeName: DIM_PRODUCT
          - locationName: DATA
            nodeName: FCT_BRAND_VIEW_DAY
          - locationName: STAGE
            nodeName: VW_MEASURES_BASE
          - locationName: STAGE
            nodeName: VW_MEASURES_MAX_VOL
          - locationName: STAGE
            nodeName: VW_MEASURES_YEAR_SUMMARY
          - locationName: STAGE
            nodeName: VW_PRICE_COST_REGION
        join:
          joinCondition: |
            FROM {{ ref('STAGE', 'VW_MEASURES_YEAR_SUMMARY') }} "VW_MEASURES_YEAR_SUMMARY"
            JOIN {{ ref('DATA', 'DIM_PRODUCT') }} "DIM_PRODUCT"
            ON "VW_MEASURES_YEAR_SUMMARY"."PRODKEY" = "DIM_PRODUCT"."PRODKEY"
            LEFT JOIN {{ ref('STAGE', 'VW_PRICE_COST_REGION') }} VW_PRICE_COST_REGION_CURRENT
            ON "VW_MEASURES_YEAR_SUMMARY"."ZONE_GEOGRAPHY" = "VW_PRICE_COST_REGION_CURRENT"."ZONE_GEOGRAPHY"
            AND "VW_MEASURES_YEAR_SUMMARY"."PRODKEY" = "VW_PRICE_COST_REGION_CURRENT"."PRODKEY"
            AND CURRENT_DATE BETWEEN "VW_PRICE_COST_REGION_CURRENT"."PC_DT" AND "VW_PRICE_COST_REGION_CURRENT"."PC_DT_END"
            LEFT JOIN {{ ref('STAGE', 'VW_MEASURES_BASE') }} "VW_MEASURES_BASE"
            ON "VW_MEASURES_YEAR_SUMMARY"."ZONE_GEOGRAPHY" = "VW_MEASURES_BASE"."ZONE_GEOGRAPHY"
            AND "VW_MEASURES_YEAR_SUMMARY".PRODKEY = VW_MEASURES_BASE.PRODKEY
            LEFT JOIN {{ ref('STAGE', 'VW_PRICE_COST_REGION') }} VW_PRICE_COST_REGION
            ON "VW_MEASURES_BASE"."ZONE_GEOGRAPHY" = "VW_PRICE_COST_REGION"."ZONE_GEOGRAPHY"
            AND "VW_MEASURES_BASE"."PRODKEY" = "VW_PRICE_COST_REGION"."PRODKEY"
            AND "VW_MEASURES_BASE"."BASE_END_DATE" BETWEEN "VW_PRICE_COST_REGION"."PC_DT" AND "VW_PRICE_COST_REGION"."PC_DT_END"
            LEFT JOIN {{ ref('STAGE', 'VW_MEASURES_MAX_VOL') }} "VW_MEASURES_MAX_VOL"
            ON "VW_MEASURES_YEAR_SUMMARY"."ZONE_GEOGRAPHY" = "VW_MEASURES_MAX_VOL"."ZONE_GEOGRAPHY"
            AND "VW_MEASURES_YEAR_SUMMARY".PRODKEY = VW_MEASURES_MAX_VOL.PRODKEY
            LEFT JOIN  {{ ref('DATA', 'FCT_BRAND_VIEW_DAY') }} "FCT_BRAND_VIEW_DAY"
            ON "VW_MEASURES_YEAR_SUMMARY"."ZONE_GEOGRAPHY" = "FCT_BRAND_VIEW_DAY"."ZONE_GEOGRAPHY"
            AND "VW_MEASURES_YEAR_SUMMARY".PRODKEY = FCT_BRAND_VIEW_DAY.PRODKEY
            AND "SCRAPE_DATE" = (SELECT MAX(SCRAPE_DATE) FROM {{ ref('DATA', 'FCT_BRAND_VIEW_DAY')}} )
        name: STG_MEASURES_CURRENT
        noLinkRefs: []
  name: STG_MEASURES_CURRENT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
