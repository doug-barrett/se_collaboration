fileVersion: 1
id: 71972aa6-78e5-436a-9928-6200fc6571fd
name: VW_MEASURES_INVENTORY_WGT
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STAGE
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a26ac13-23e0-4bf1-86fa-ddd82178f25a
          stepCounter: 71972aa6-78e5-436a-9928-6200fc6571fd
        config: {}
        dataType: DATE
        description: ""
        name: TRANSACTION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3f37068-b315-4964-8356-8fd70124da71
                stepCounter: 6214df34-3cd9-45e2-9ade-14ee5bb1f3d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 004adf3d-2026-4edc-b3c6-48e2a38ce192
          stepCounter: 71972aa6-78e5-436a-9928-6200fc6571fd
        config: {}
        dataType: VARCHAR(64)
        description: ""
        name: ZONE_GEOGRAPHY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9f6300a-49b3-4920-9532-37a5f58f5f2a
                stepCounter: 6214df34-3cd9-45e2-9ade-14ee5bb1f3d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1ad3d3dd-cd6b-43ba-9d18-34f7daf8e8ce
          stepCounter: 71972aa6-78e5-436a-9928-6200fc6571fd
        config: {}
        dataType: VARCHAR(64)
        description: This is the product key
        name: PRODKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 06f52e52-6edb-43b5-90b7-3e514c70da51
                stepCounter: 6214df34-3cd9-45e2-9ade-14ee5bb1f3d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bdb80e1b-84e7-4734-b2ce-73906c4a35ac
          stepCounter: 71972aa6-78e5-436a-9928-6200fc6571fd
        config: {}
        dataType: NUMBER(13,2)
        description: ""
        name: INVENTORY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ced0417-28a7-47f2-8b1c-9c99fa4143f1
                stepCounter: 6214df34-3cd9-45e2-9ade-14ee5bb1f3d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c6cd40c-3800-4217-bf55-8980f526bb63
          stepCounter: 71972aa6-78e5-436a-9928-6200fc6571fd
        config: {}
        dataType: INTEGER
        description: ""
        name: STORES_WITH_INVENTORY_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9b216323-cc20-4b6c-8aa5-3eb04419442c
                stepCounter: 6214df34-3cd9-45e2-9ade-14ee5bb1f3d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1fe0512e-4c9a-4b63-8525-e615b3716470
          stepCounter: 71972aa6-78e5-436a-9928-6200fc6571fd
        config: {}
        dataType: INTEGER
        description: ""
        name: STORES_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d6004d1-e4ab-4fc0-955b-0a9b8969698d
                stepCounter: 6214df34-3cd9-45e2-9ade-14ee5bb1f3d5
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 51bf600e-bf0e-49a5-801d-b836d00d14ef
          stepCounter: 71972aa6-78e5-436a-9928-6200fc6571fd
        config: {}
        dataType: DECIMAL(12,6)
        description: ""
        name: INVENTORY_WGT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8cfed4b8-ef79-45f9-a40b-a7ad4d526263
                stepCounter: 6214df34-3cd9-45e2-9ade-14ee5bb1f3d5
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DS_INVENTORY_WGT: 6214df34-3cd9-45e2-9ade-14ee5bb1f3d5
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATASTORE
            nodeName: DS_INVENTORY_WGT
        join:
          joinCondition: |-
            FROM {{ ref('DATASTORE', 'DS_INVENTORY_WGT') }} "DS_INVENTORY_WGT"
            WHERE TRANSACTION_DATE = (SELECT NVL(MAX(TRANSACTION_DATE),'2000-01-01') FROM {{ ref_no_link('DATASTORE','DS_INVENTORY_WGT')}})
        name: VW_MEASURES_INVENTORY_WGT
        noLinkRefs:
          - locationName: DATASTORE
            nodeName: DS_INVENTORY_WGT
  name: VW_MEASURES_INVENTORY_WGT
  overrideSQL: false
  schema: ""
  sqlType: "16"
  type: sql
  version: 1
type: Node
