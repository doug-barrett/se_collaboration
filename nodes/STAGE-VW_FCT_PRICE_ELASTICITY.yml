fileVersion: 1
id: 6cfb9f73-799b-4396-88ff-1c4d3eaf9973
name: VW_FCT_PRICE_ELASTICITY
operation:
  config:
    insertStrategy: UNION
    selectDistinct: false
  database: ""
  deployEnabled: true
  description: Get the latest Price Elasticity for each Zone, Product, Holiday, Discount
  isMultisource: false
  locationName: STAGE
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70502005-ce55-4b51-b3e4-dca6b3da6ef1
          stepCounter: 6cfb9f73-799b-4396-88ff-1c4d3eaf9973
        config: {}
        dataType: VARCHAR(64)
        description: ""
        hashDetails: null
        name: ZONE_GEOGRAPHY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 26197ecc-62f7-4bbb-b4fb-168fa82c00c0
                stepCounter: 434dffce-b09e-4aab-8fcc-8be353e0e3f2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b48e9a1e-0627-4ebe-b339-bca36bc91140
          stepCounter: 6cfb9f73-799b-4396-88ff-1c4d3eaf9973
        config: {}
        dataType: VARCHAR(50)
        description: This is the product key
        hashDetails: null
        name: PRODKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ebd79cc-cf6e-47af-adaa-be26d518d877
                stepCounter: 434dffce-b09e-4aab-8fcc-8be353e0e3f2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1418ce07-8ec0-46db-b045-1b91f5318c72
          stepCounter: 6cfb9f73-799b-4396-88ff-1c4d3eaf9973
        config: {}
        dataType: VARCHAR(64)
        description: ""
        hashDetails: null
        name: HOLIDAY_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15d5f4d7-c9b4-43db-9717-681a707c9939
                stepCounter: 434dffce-b09e-4aab-8fcc-8be353e0e3f2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0df81ec-e50e-4ff9-b67d-052f3dec9ce7
          stepCounter: 6cfb9f73-799b-4396-88ff-1c4d3eaf9973
        config: {}
        dataType: DECIMAL(9,2)
        description: ""
        hashDetails: null
        name: DISCOUNT_BUCKET
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d0580218-a8a7-4383-b9f9-68bd1aa571f1
                stepCounter: 434dffce-b09e-4aab-8fcc-8be353e0e3f2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0298ca06-1688-4cd1-bb1d-d483869cfab8
          stepCounter: 6cfb9f73-799b-4396-88ff-1c4d3eaf9973
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: BRAND
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4ad576f-9893-4276-bd90-5230454ade05
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0b9bbcf-a456-4428-aefc-fd7dbaa1c6e7
          stepCounter: 6cfb9f73-799b-4396-88ff-1c4d3eaf9973
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: LEVEL1_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 48a82910-6386-46e0-b072-3c89965cb3c1
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d7afdf2-ae04-467e-86ae-2116bec635fa
          stepCounter: 6cfb9f73-799b-4396-88ff-1c4d3eaf9973
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: LEVEL2_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 850983c0-90a9-4640-84e8-e8ae587b9e5a
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62a1b482-52ab-4dcb-b32e-2648a69e5511
          stepCounter: 6cfb9f73-799b-4396-88ff-1c4d3eaf9973
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: LEVEL3_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76b80dd0-990c-439c-9b2a-f320fd772670
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 372ff530-ccd0-4886-a0b7-8d1cbc66bd23
          stepCounter: 6cfb9f73-799b-4396-88ff-1c4d3eaf9973
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: LEVEL4_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81d483bb-5578-4211-bed7-6f59f0e33c08
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70c18716-3bd0-4d7d-aebf-3853ed0cde1d
          stepCounter: 6cfb9f73-799b-4396-88ff-1c4d3eaf9973
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: LEVEL5_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66c9a231-f431-4a57-94fd-11de9bccdfda
                stepCounter: 99510b9e-1d3e-4709-93b8-2042202093b0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86ca719a-ad86-47cc-8950-4f0cdff25142
          stepCounter: 6cfb9f73-799b-4396-88ff-1c4d3eaf9973
        config: {}
        dataType: NUMBER(6,4)
        description: ""
        hashDetails: null
        name: PRICE_ELASTICITY_PROD_HOL_DISC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3380109d-0796-42fa-8721-e6df4b63cb22
                stepCounter: 434dffce-b09e-4aab-8fcc-8be353e0e3f2
            transform: AVG(PRICE_ELASTICITY) OVER (PARTITION BY ZONE_GEOGRAPHY, "FCT_PRICE_ELASTICITY_RAW"."PRODKEY", PRICE_DISCOUNT_BUCKET)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1fdce5a2-64c7-420d-9868-87ee0880dfd4
          stepCounter: 6cfb9f73-799b-4396-88ff-1c4d3eaf9973
        config: {}
        dataType: NUMBER(6,4)
        description: ""
        hashDetails: null
        name: RN_PROD_HOL_DISC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3380109d-0796-42fa-8721-e6df4b63cb22
                stepCounter: 434dffce-b09e-4aab-8fcc-8be353e0e3f2
            transform: |-
              ROW_NUMBER() OVER (PARTITION BY ZONE_GEOGRAPHY, "FCT_PRICE_ELASTICITY_RAW"."PRODKEY", PRICE_DISCOUNT_BUCKET 
              ORDER BY "FCT_PRICE_ELASTICITY_RAW"."PRODKEY")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b0f403d-a51a-439f-b5ee-fe6cffe1ddf1
          stepCounter: 6cfb9f73-799b-4396-88ff-1c4d3eaf9973
        config: {}
        dataType: NUMBER(6,4)
        description: ""
        hashDetails: null
        name: PRICE_ELASTICITY_MA_BRAND_HOL_DISC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3380109d-0796-42fa-8721-e6df4b63cb22
                stepCounter: 434dffce-b09e-4aab-8fcc-8be353e0e3f2
            transform: AVG("PRICE_ELASTICITY") OVER (PARTITION BY ZONE_GEOGRAPHY, LEVEL3_DESC, BRAND, HOLIDAY_NAME, PRICE_DISCOUNT_BUCKET)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8ad7c17-5b07-458b-9ed0-7dc577d097c8
          stepCounter: 6cfb9f73-799b-4396-88ff-1c4d3eaf9973
        config: {}
        dataType: NUMBER(6,4)
        description: ""
        hashDetails: null
        name: RN_MA_BRAND_HOL_DISC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3380109d-0796-42fa-8721-e6df4b63cb22
                stepCounter: 434dffce-b09e-4aab-8fcc-8be353e0e3f2
            transform: ROW_NUMBER() OVER (PARTITION BY ZONE_GEOGRAPHY, LEVEL3_DESC, BRAND, HOLIDAY_NAME, PRICE_DISCOUNT_BUCKET ORDER BY "FCT_PRICE_ELASTICITY_RAW"."PRODKEY")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 665e617e-1b6a-41be-ba63-52fbcd47d041
          stepCounter: 6cfb9f73-799b-4396-88ff-1c4d3eaf9973
        config: {}
        dataType: NUMBER(6,4)
        description: ""
        hashDetails: null
        name: PRICE_ELASTICITY_MA_BRAND_DISC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3380109d-0796-42fa-8721-e6df4b63cb22
                stepCounter: 434dffce-b09e-4aab-8fcc-8be353e0e3f2
            transform: AVG("PRICE_ELASTICITY") OVER (PARTITION BY ZONE_GEOGRAPHY, LEVEL3_DESC, BRAND, PRICE_DISCOUNT_BUCKET)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d977920-3f4f-4d13-ba47-44510609d18c
          stepCounter: 6cfb9f73-799b-4396-88ff-1c4d3eaf9973
        config: {}
        dataType: NUMBER(6,4)
        description: ""
        hashDetails: null
        name: RN_MA_BRAND_DISC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3380109d-0796-42fa-8721-e6df4b63cb22
                stepCounter: 434dffce-b09e-4aab-8fcc-8be353e0e3f2
            transform: ROW_NUMBER()  OVER (PARTITION BY ZONE_GEOGRAPHY, LEVEL3_DESC, BRAND, PRICE_DISCOUNT_BUCKET ORDER BY "FCT_PRICE_ELASTICITY_RAW"."PRODKEY")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: baf3d020-f378-4c80-8acb-f87aec38acbc
          stepCounter: 6cfb9f73-799b-4396-88ff-1c4d3eaf9973
        config: {}
        dataType: NUMBER(6,4)
        description: ""
        hashDetails: null
        name: PRICE_ELASTICITY_MA_DISC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3380109d-0796-42fa-8721-e6df4b63cb22
                stepCounter: 434dffce-b09e-4aab-8fcc-8be353e0e3f2
            transform: AVG("PRICE_ELASTICITY") OVER (PARTITION BY ZONE_GEOGRAPHY, LEVEL3_DESC, PRICE_DISCOUNT_BUCKET)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7bf08a2b-829f-4d88-a713-867b3595bac5
          stepCounter: 6cfb9f73-799b-4396-88ff-1c4d3eaf9973
        config: {}
        dataType: NUMBER(6,4)
        description: ""
        hashDetails: null
        name: RN_MA_DISC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3380109d-0796-42fa-8721-e6df4b63cb22
                stepCounter: 434dffce-b09e-4aab-8fcc-8be353e0e3f2
            transform: ROW_NUMBER()  OVER (PARTITION BY ZONE_GEOGRAPHY, LEVEL3_DESC, PRICE_DISCOUNT_BUCKET ORDER BY "FCT_PRICE_ELASTICITY_RAW"."PRODKEY")
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eafb1a64-b7db-475e-99d3-41b279762303
          stepCounter: 6cfb9f73-799b-4396-88ff-1c4d3eaf9973
        config: {}
        dataType: NUMBER(6,4)
        description: ""
        hashDetails: null
        name: PRICE_ELASTICITY_MA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3380109d-0796-42fa-8721-e6df4b63cb22
                stepCounter: 434dffce-b09e-4aab-8fcc-8be353e0e3f2
            transform: AVG("PRICE_ELASTICITY") OVER (PARTITION BY ZONE_GEOGRAPHY, LEVEL3_DESC)
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 648a825f-956b-41d6-ae0b-753ac5977119
          stepCounter: 6cfb9f73-799b-4396-88ff-1c4d3eaf9973
        config: {}
        dataType: NUMBER(6,4)
        description: ""
        hashDetails: null
        name: RN_MA
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3380109d-0796-42fa-8721-e6df4b63cb22
                stepCounter: 434dffce-b09e-4aab-8fcc-8be353e0e3f2
            transform: ROW_NUMBER()  OVER (PARTITION BY ZONE_GEOGRAPHY, LEVEL3_DESC ORDER BY "FCT_PRICE_ELASTICITY_RAW"."PRODKEY")
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_PRODUCT: 99510b9e-1d3e-4709-93b8-2042202093b0
          FCT_PRICE_ELASTICITY_RAW: 434dffce-b09e-4aab-8fcc-8be353e0e3f2
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DATA
            nodeName: DIM_PRODUCT
          - locationName: DATA
            nodeName: FCT_PRICE_ELASTICITY_RAW
        join:
          joinCondition: |-
            FROM {{ ref('DATA', 'FCT_PRICE_ELASTICITY_RAW') }} "FCT_PRICE_ELASTICITY_RAW"
            JOIN {{ ref('DATA', 'DIM_PRODUCT') }} "DIM_PRODUCT"
            ON "FCT_PRICE_ELASTICITY_RAW"."PRODKEY" = "DIM_PRODUCT"."PRODKEY"
            WHERE "PRICE_DROP_FLAG" = 'Y'
            QUALIFY 1 = ROW_NUMBER() OVER (PARTITION BY "ZONE_GEOGRAPHY", "FCT_PRICE_ELASTICITY_RAW"."PRODKEY", "PRICE_DISCOUNT_BUCKET" ORDER BY "START_DATE" DESC)
        name: VW_FCT_PRICE_ELASTICITY
        noLinkRefs: []
  name: VW_FCT_PRICE_ELASTICITY
  overrideSQL: false
  schema: ""
  sqlType: "16"
  type: sql
  version: 1
type: Node
